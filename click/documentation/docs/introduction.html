<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
 "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
 <meta name="Author" content="Malcolm Edgar"/>
 <meta name="description" lang="en" content="Click Java web application framework"/>
 <meta name="keywords" lang="en" content="Click Framework, Java, JEEE, web application framework, open source"/>
 <title>Click Framework</title>
 <link rel="stylesheet" type="text/css" href="../help.css"/>
 <link rel="stylesheet" type="text/css" href="table.css"/>
 <link rel="stylesheet" type="text/css" href="../help.css"/>
 <style type="text/css">
  li {
    margin-bottom: 0.75em;
  }
 </style>
</head>

<body>
<h1>Introduction</h1>
Click is a simple JEE web application framework for commercial Java developers.
<p>
Click is an open source project, licensed using the 
<a href="LICENSE.txt">Apache</a> license.
<p>
Click uses the event based programming model for processing Servlet requests and 
<a target='topic' href='velocity/velocity.html'>Velocity</a> for rendering 
the response.  
<p>
This framework uses a single servlet, called
<a target="topic" href="click-api/net/sf/click/ClickServlet.html">ClickServlet</a>, to
act as a request dispatcher. When a request arrives ClickServlet creates a 
<a target="topic" href="click-api/net/sf/click/Page.html">Page</a> object to 
processes the request and then uses the page's Velocity template to render the 
results.
<p>
Page provide a simple thread safe programming environment, with a new
page instance is created for each servlet request.
<p>
Possibly the best way to see how Click works is to dive right in and look at some 
examples:

<ul>
  <li><a href="#hello-world">Hello World</a> - the Hello World classic
  </li>
  <li><a href="#control-listener">Control Listener</a> - a ActionLink control listener example
  </li>
  <li><a href="#simple-table">Simple Table</a> - a simple Table control example
  </li> 
  <li><a href="#advanced-table">Advanced Table</a> - a more advanced Table example
  </li>
  <li><a href="#simple-form">Simple Form</a> - a simple Form example
  </li>
  <li><a href="#advanced-form">Advanced Form</a> - a more advanced Form example
  </li>
</ul>

<p>&nbsp;</p>

<a name="hello-world" class="heading"><h2>Hello World Example</h2></a>
A Hello World example in Click would look something like this. 
<p/>
First we would have a <tt>HelloWorld</tt> page class:

<pre class="codeJava">
<span class="kw">package</span> <span class="red">examples.page</span>;

<span class="kw">import</span> java.util.Date;
<span class="kw">import</span> net.sf.click.Page;

<span class="kw">public</span> HelloWorld <span class="kw">extends</span> Page {

    <span class="kw">public</span> Date <span class="st">time</span> = <span class="kw">new</span> Date();

} 
</pre>

Next we would have a page template <span class="blue">hello-world.htm</span>:

<pre class="codeHtml">
&lt;html&gt;
  &lt;body&gt;
  
    &lt;h2&gt;Hello World&lt;/h2&gt;
    
    Hello world from Click at <span class="st">$time</span>
    
  &lt;/body&gt;
&lt;/html&gt; 
</pre>

And finally we have a <tt>click.xml</tt> configuration file which tells our Click 
application to map <span class="blue">hello-world.htm</span>
requests to our <tt>HelloWorld</tt> page class.

<pre class="codeConfig">
&lt;click-app&gt;  
  &lt;pages package="<span class="red">examples.page</span>"/&gt; 
&lt;/click-app&gt; 
</pre>

<p/>

At runtime the ClickSerlvet maps a GET <span class="blue">hello-world.htm</span> 
request to our page class <tt>example.page.HelloWorld</tt> and creates a new instance. 
The HelloWorld page creates a new public <tt>Date</tt> object, which is automatically
added to the pages model using the fields name <span class="st">time</span>.
<p/>
The page model is then merged with the template which substitutes the 
<span class="st">$time</span> parameter with the <tt>Date</tt> object. 
Velocity then renders the merged template which looks something like 

<table class="htmlExample" cellspacing="12">
<tr>
 <td>
 <h2 style="margin-top: 0em;">Hello World</h2>
 Hello world from Click at Tue May 08 19:37:05 EST 2007
 </td>
</tr>
</table>

<p>&nbsp;</p>


<a name="control-listener" class="heading"><h2>Control Listener Example</h2></a>

Click includes a library <a target="topic" href="controls.html">Controls</a> which 
provide user interface functionality. 
<p/>
One of the commonly used controls is the 
<a target="topic" href="click-api/net/sf/click/control/ActionLink.html">ActionLink</a>,
which you can use to have a HTML link call a method on a Page object. For example:

<pre class="codeJava">
<span class="kw">public class</span> ControlListenerPage <span class="kw">extends</span> Page {

    <span class="kw">public</span> ActionLink myLink = <span class="kw">new</span> ActionLink(<span class="kw">this</span>, <span class="st">"onMyLinkClick"</span>);

    <span class="kw">public</span> String msg;

    <span class="cm">// --------------------------------------------------------- Event Handlers</span>

    <span class="cm">/**
     * Handle the myLink control click event.
     */</span>
    <span class="kw">public boolean</span> onMyLinkClick() {
        msg = <span class="st">"ControlListenerPage#"</span> + hashCode()
            + <span class="st">" object method &lt;tt&gt;onMyLinkClick()&lt;/tt&gt; invoked."</span>;

        <span class="kw">return true</span>;
    }
} </pre>

In the Page class we create an ActionLink called <span class="blue">myLink</span> 
and define the control's listener to be the page method <tt>onMyLinkClick()</tt>. 
When a user clicks on <span class="blue">myLink</span> control it will invoke the 
listener method <tt>onMyLinkClick()</tt>.
<p/>
In Click a control listener method can have any name but it must return a boolean value. 
The boolean return value specifies whether processing of page events should continue.
This control listener pattern provides a short hand way wiring up action listener methods
without having to define anonymous inner classes.

<p/>
Back to our example, in the page template we define a HTML link and have the 
<span class="blue">myLink</span> control render the link's href attribute:

<pre class="codeHtml">
&lt;html&gt;
  &lt;head&gt;
    &lt;link type="text/css" rel="stylesheet" href="style.css"&gt;&lt;/link&gt;
  &lt;/head&gt;
  &lt;body&gt;
  
  Click myLink control &lt;a href="<span class="blue">$myLink.href</span>"&gt;here&lt;/a&gt;.

  <span class="red">#if</span> (<span class="blue">$msg</span>)
    &lt;div id="msgDiv"&gt; <span class="blue">$msg</span> &lt;/div&gt;
  <span class="red">#end</span>

  &lt;/body&gt;
&lt;/html&gt;
</pre>

At runtime this page would be rendered as:

<table class="htmlExample" cellspacing="12">
<tr>
 <td>
 Click myLink control <a href="/click-examples/introduction/control-listener.htm?actionLink=myLink">here</a>.
 </td>
</tr>
</table>

When a user clicks on the link the <tt>onMyLinkClick()</tt> method is invoked. This
method then creates <span class="blue">msg</span> model value, which is rendered in the page as:

<table class="htmlExample" cellspacing="12">
<tr>
 <td>
 Click myLink control <a href="/click-examples/introduction/control-listener.htm?actionLink=myLink">here</a>.
 
 <div class="msgDiv"> ControlListenerPage#12767107 object method <tt>onMyLinkClick()</tt> invoked. </div>
 </td>
</tr>
</table>


<p>&nbsp;</p>


<a name="simple-table" class="heading"><h2>Simple Table Example</h2></a>

One of the most useful Click controls is the 
<a target="topic" href="click-api/net/sf/click/control/Table.html">Table</a>
control.
<p/>

An example usage of the Table control in a customers Page is provided below:

<pre class="codeJava">
<span class="kw">public class</span> SimpleTablePage <span class="kw">extends</span> Page {

    <span class="kw">public</span> Table <span class="st">table</span> = <span class="kw">new</span> Table();

    <span class="cm">// ------------------------------------------------------------ Constructor</span>
     
    <span class="kw">public</span> SimpleTablePage() {
        table.setClass(Table.CLASS_ITS);
        
        table.addColumn(<span class="kw">new</span> Column(<span class="st">"id"</span>));
        table.addColumn(<span class="kw">new</span> Column(<span class="st">"name"</span>));
        table.addColumn(<span class="kw">new</span> Column(<span class="st">"email"</span>));
        table.addColumn(<span class="kw">new</span> Column(<span class="st">"investments"</span>));
    }
    
    <span class="cm">// --------------------------------------------------------- Event Handlers</span>
     
    <span class="cm">/**
     * @see Page#onRender()
     */</span>
    <span class="kw">public void</span> onRender() {
    	List list = getCustomerService().getCustomersSortedByName(10);
    	table.setRowList(list);
    }
} </pre>

In this Page code example a Table control is declared, we set the table's HTML class,
and then define number of table <a target="topic" href="click-api/net/sf/click/control/Column.html">Column</a>
objects. In the column definitions we specify the name of the column in the constructor,
which is used for the table column header and also to specify the row object property 
to render.
<p/>
The last thing we need to do is populate the table with data. To do this we override the 
Page <tt>onRender()</tt> method and set the table row list before it is rendered.

<p/>

In our Page template we simply reference the <span class="blue">$table</span> object 
which is rendered when its <tt>toString()</tt> method is called. 

<pre class="codeHtml">
&lt;html&gt;
&lt;head&gt;
  <span class="blue">$imports</span>
&lt;/head&gt;
&lt;body&gt;
  
  <span class="blue">$table</span>
    
&lt;/body&gt;
&lt;/html&gt; 
</pre>

Note above we also specify the <span class="blue">$imports</span> reference so the table can include any
header imports such as style sheets in the page.
<p/>
At runtime the Table would be rendered in the page as:

<table class="htmlExample" cellspacing="12">
<tr>
 <td>
   <img src="../images/simple-table.png" border="0"/> 
  </td>
</tr>
</table>

<p>&nbsp;</p>



<a name="advanced-table" class="heading"><h2>Advanced Table Example</h2></a>

The Table control also provides support for:
<ul>
<li>automatic rendering</li>
<li>column formatting and custom rendering</li>
<li>automatic pagination</li>
<li>link control support</li>
</ul> 

A more advanced Table example is provided below:

<pre class="codeJava">
<span class="kw">public class</span> CustomerPage <span class="kw">extends</span> Page {

    <span class="kw">public</span> Table <span class="st">table</span> = <span class="kw">new</span> Table();
    <span class="kw">public</span> PageLink editLink = <span class="kw">new</span> PageLink(<span class="st">"Edit"</span>, EditCustomer.<span class="kw">class</span>);
    <span class="kw">public</span> ActionLink deleteLink = <span class="kw">new</span> ActionLink(<span class="st">"Delete"</span>, <span class="kw">this</span>, <span class="st">"onDeleteClick"</span>);

    <span class="cm">// ------------------------------------- Constructor</span>
     
    <span class="kw">public</span> CustomersPage() {
        table.setClass(Table.<span class="st">CLASS_ITS</span>);
        table.setPageSize(5);
        table.setShowBanner(<span class="kw">true</span>);
        table.setSortable(<span class="kw">true</span>);
    	
        table.addColumn(<span class="kw">new</span> Column(<span class="st">"id"</span>));

        table.addColumn(<span class="kw">new</span> Column(<span class="st">"name"</span>));
        
        Column column = <span class="kw">new</span> Column(<span class="st">"email"</span>);
        column.setAutolink(<span class="kw">true</span>);
        column.setTitleProperty(<span class="st">"name"</span>);
        table.addColumn(column);
        
        table.addColumn(<span class="kw">new</span> Column(<span class="st">"investments"</span>));
        
        editLink.setImageSrc(<span class="st">"/images/edit-16px.gif"</span>);
        editLink.setTitle(<span class="st">"Edit customer details"</span>);
        editLink.setParameter(<span class="st">"referrer"</span>, <span class="st">"/introduction/advanced-table.htm"</span>);
        
        deleteLink.setImageSrc(<span class="st">"/images/delete-16px.gif"</span>);
        deleteLink.setTitle(<span class="st">"Delete customer record"</span>);
        deleteLink.setAttribute(<span class="st">"onclick"</span>, <span class="st">"return window.confirm('Are you sure you want to delete this record?');"</span>);
    	
        column = <span class="kw">new</span> Column(<span class="st">"Action"</span>);
        column.setTextAlign(<span class="st">"center"</span>);
        AbstractLink[] links = <span class="kw">new</span> AbstractLink[] { editLink, deleteLink };
        column.setDecorator(<span class="kw">new</span> LinkDecorator(table, links, <span class="st">"id"</span>));
        column.setSortable(<span class="kw">false</span>);
        table.addColumn(column);
    }
    
    <span class="cm">// ---------------------------------- Event Handlers</span>
         
    <span class="cm">/**
     * Handle the delete row click event.
     */</span>    
    <span class="kw">public boolean</span> onDeleteClick() {
        Integer id = deleteLink.getValueInteger();
        getCustomerService().deleteCustomer(id);
        <span class="kw">return true</span>;
    }
    
    <span class="cm">/**
     * @see Page#onRender()
     */</span>
    <span class="kw">public void</span> onRender() {
    	List list = getCustomerService().getCustomersByName();
    	table.setRowList(list);
    }
} </pre>

In this Page code example a Table control is declared and a number of 
<a target="topic" href="click-api/net/sf/click/control/Column.html">Column</a>
objects are added. A deleteLink 
<a target="topic" href="click-api/net/sf/click/control/ActionLink.html">ActionLink</a>
control is used a decorator for the "Action" column. This control will invoke the
Page <tt>onDeleteClick()</tt> method when it is clicked. Finally we have the 
Page <tt>onRender()</tt> method which is used to populate the Table control with
rows before it is rendered.

<p/>

In our Page template we simply reference the <span class="blue">$table</span> object 
which is rendered when its <tt>toString()</tt> method is called.

<pre class="codeHtml">
&lt;html&gt;
&lt;head&gt;
  <span class="blue">$imports</span>
&lt;/head&gt;
&lt;body&gt;
  
  <span class="blue">$table</span>
    
&lt;/body&gt;
&lt;/html&gt; 
</pre>

At runtime the Table would be rendered in the page as:

<table class="htmlExample" cellspacing="12">
<tr>
 <td>
   <img src="../images/advanced-table.png" border="0"/> 
  </td>
</tr>
</table>

In this example if a user click on the Delete link the <tt>onDeleteClick()</tt>
method will be called on the Page deleting the customer record.

<p>&nbsp;</p>



<a name="simple-form" class="heading"><h2>Simple Form Example</h2>

Forms and Fiels are also some of the most commonly used controls in the Click Framework.

TODO: ...

<p>&nbsp;</p>



<a name="advanced-form" class="heading"><h2>Advanced Form Example</h2></a>

The login Page below provides a demonstration of using Form and Field controls.
<p/>
First we have a <tt>LoginPage</tt> class which setups up a login 
<a href="click-api/net/sf/click/control/Form.html">Form</a>
in the constructor.

<pre class="codeJava">
<span class="kw">public class</span> LoginPage <span class="kw">extends</span> Page {

    <span class="kw">public</span> Form <span class="st">form</span> = <span class="kw">new</span> Form();
    
    <span class="cm">// ------------------------------------- Constructor</span>
     
    <span class="kw">public</span> LoginPage() { 
        form.add(<span class="kw">new</span> TextField(<span class="st">"username"</span>, <span class="kw">true</span>));
        form.add(<span class="kw">new</span> PasswordField(<span class="st">"password"</span>, <span class="kw">true</span>));
        form.add(<span class="kw">new</span> Submit(<span class="st">"ok"</span>, <span class="st">"   OK   "</span>, <span class="kw">this</span>, <span class="st">"onOkClicked"</span>));
        form.add(<span class="kw">new</span> Submit(<span class="st">"cancel"</span>, <span class="kw">this</span>, <span class="st">"onCancelClicked"</span>));
    }
    
    <span class="cm">// ---------------------------------- Event Handlers</span>
     
    <span class="cm">/**
     * Handle the OK button click event.
     */</span>    
    <span class="kw">public boolean</span> onOkClicked() {
        <span class="kw">if</span> (form.isValid()) {
            User user = <span class="kw">new</span> User();
            form.copyTo(user);

            <span class="kw">if</span> (getUserService().isAuthenticatedUser(user)) {
                getContext().setSessionAttribute(<span class="st">"user"</span>, user);
                setRedirect(SecurePage.<span class="kw">class</span>);
                <span class="kw">return false</span>;

            } <span class="kw">else</span> {     
                form.setError(getMessage(<span class="st">"authentication-error"</span>));           
            }
        }
        <span class="kw">return true</span>;
    }
    
    <span class="cm">/**
     * Handle the Cancel button click event.
     */</span>    
    <span class="kw">public boolean</span> onCancelClicked() {
        setRedirect(HomePage.<span class="kw">class</span>);
        <span class="kw">return false</span>;
    }
} 
</pre>

Note in this example the page's public <span class="st">form</span> field is 
automatically added to its list of controls.
<p/>
Next we have the LoginPage template <span class="blue">login.htm</span>. The
Click application automatically associates the <tt>login.htm</tt> template with
the <tt>LoginPage</tt> class.

<pre class="codeHtml">
&lt;html&gt;
&lt;head&gt;
   <span class="blue">$imports</span>
&lt;/head&gt;
&lt;body&gt;
  
   &lt;h3&gt;Login&lt;/h3&gt;
    
   <span class="blue">$form</span>
    
&lt;/body&gt;
&lt;/html&gt; 
</pre>

When the Login page is first requested the <span class="blue">$form</span> object will 
automatically render itself as:

<table class="htmlExample" cellspacing="12">
<tr>
 <td>
  
 <h3 style="color: navy; margin-top: 0em; margin-bottom: 0.5em;">Login</h3>

<table class='form'>
<tr>
<td align='left'><label >Username</label><span class="red">*</span></td>
<td align='left'><input type='text' name='username' value='' size='20' maxlength='20'/></td>
</tr>
<tr>
<td align='left'><label >Password</label><span class="red">*</span></td>
<td align='left'><input type='password' name='password' value='' size='20' maxlength='20'/></td>
</tr>
</table>
<table class="buttons">
<tr align='left'>
  <td colspan='2'><input type='submit' name='ok' value='    OK    '/>&nbsp;<input type='submit' name='cancel' value='Cancel'/></td>
</tr>
</table>

 </td>
</tr>
</table>

Now the user enters their username, but forgets their password and then presses the OK
button. The ClickServlet creates a new Login page and processes the form control.
The form control processes its fields and determines that it is invalid. 
<p/>
Next the OK button <tt>onOkClicked()</tt> event handler is invoked, but as the form is 
invalid this method it does nothing.
<p/>
With all the event processing completed the form now renders the field validation errors.
<table class="htmlExample" cellspacing="12">
<tr>
 <td>
   
 <h3 style="color: navy; margin-top: 0em; margin-bottom: 0.5em;">Login</h3>
 
<table class='fields'>
<tr>
<td align='left'><label >Username</label><span class="red">*</span></td>
<td align='left'><input type='text' name='username' value='malcolm' size='20' maxlength='20'/></td>
</tr>
<tr>
<td align='left'><label >Password</label><span class="red">*</span></td>
<td align='left'><input type='password' name='password' value='' size='20' class='error' maxlength='20'/></td>
</tr>
<tr><td colspan='2'><a class='error' href='javascript:document.form.password.focus();'>You must enter a value for Password</a></td></tr>
</table>
<table class="buttons">
<tr align='left'><td colspan='2'><input type='submit' name='ok' value='    OK    '/>&nbsp;<input type='submit' name='cancel' value='Cancel'/></td></tr>
</table>

 </td>
</tr>
</table>

If the user enters a correct username and password the <tt>onOkClicked()</tt> 
event handler will add a User object to the HttpSession and redirect the request 
to the <tt>SecurePage</tt>. Note how this code returns false, to abort any further
processing in the page.
<p/>
If the user clicks on the Cancel button the request is redirected to the <tt>HomePage</tt>.

<h4>Form Layout</h4>

In this example we use the form control to automatically render the form and the fields
HTML. This is a great feature for quickly building screens, and the form control 
provides a number of layout options. See the Click <a href="examples.html">Examples</a> for an
interactive Form Properties demo.
<p/>
For fine grained page design you can specifically layout form and fields in 
your page template. See the 
<a target="topic" href="click-api/net/sf/click/control/Form.html#form-layout">Form</a>
Javadoc for more details.

</body>
</html>