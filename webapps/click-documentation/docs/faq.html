<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
 "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
 <meta name="Author" content="Malcolm Edgar"/>
 <link rel="stylesheet" type="text/css" href="../help.css"/>
 <style type="text/css">
   dt { margin-top:2em; }
   dd { margin:1em; margin-left:2em; }
 </style>
</head>
<body>
  
<h1>Frequently Asked Questions</h1>
<ul>
  <li><a href="#why-click">Why develop a new Web Application Framework?</a>
  </li> 
  <li><a href="#html-control">How can the GUI designer define the HTML if Click Controls generates everything?</a>
  </li> 
  <li><a href="#shared-template">How can I have many Pages using the same HTML template?</a>
  </li>
  <li><a href="#exclude-fields">Can you exclude some fields from a Form?</a>
  </li> 
  <li><a href="#localization">How do you internationalize Pages and Control labels?</a>
  </li>
  <li><a href="#actionlink-parameters">How do you create an ActionLink with several parameters?</a>
  </li>
  <li><a href="#spring-integration">How can you integrate Click into Spring?</a>
  </li>
  <li><a href="#jsp-support">Does Click support JSP?</a>
  </li>
  <li><a href="#logging">Why doesn't Click use Commons Logging or Log4J for logging?</a>
  </li>
  <li><a href="#why-velocity">Why not use FreeMarker instead of Velocity?</a>
  </li>  
</ul>
<p>&nbsp;</p>

<dl>
  
  <a name="why-click" class="heading"></a>
  <dt><b>Why develop a new Web Application Framework?</b></dt>
  <dd>
  Because the existing frameworks did not meet my needs. Struts doesn't really do much, 
  while Tapestry is too complicated. 
  <p/>
  For a more comprehensive answer please see <a href="why-click.html">Why Click</a>.
  </dd>
  
  <a name="html-control" class="heading"></a>
  <dt><b>How can the GUI designer define the HTML if Click Controls generates everything?</b></dt>
  <dd>
  In Click there is nothing preventing you from laying out HTML forms by hand. 
  It just provides the option of doing it automatically for you.
  <p/>
  There are a number of approaches you can use for generating for HTML,
  each with pros &amp; cons:
  <p/>
  <ol>
  <li>
  <u>Use Click forms and controls to do all the HTML rendering for you.</u> 
  <p/>
  This a 80/20 approach where you can quickly get stuff developed, but it may
  not meet all your UI style requirements. 
  <p/>
  Please note the Forms control provides many 
  <a href="click-api/net/sf/click/control/Form.html#auto-layout">auto layout</a> 
  options, see the <a href="examples.html">click-examples</a> 'Form Properties' 
  for a demonstration. 
  <p/>
  The Form control also renders the class attributes 'form', 'fields', 'errors' and 'buttons'
  in the form's HTML elements enabling fine grained CSS control. 
  <p/>
  As an example you could configure a form to display the labels on top, and want to
  increase the vertical spacing between fields. To do this simply define the CSS
  style in front of your form:
  <pre class="codeHtml">
 &lt;style type="<span class="st">text/css</span>"&gt;
    td.<span class="kw">fields</span> { padding-top: 0.75em; }
 &lt;/style&gt; 
 
 <span class="red">$</span><span class="blue">form</span> </pre>
  Fields are also rendered with an 'id' attribute enabling manipulation of individual fields.
  <p/>
  </li><li>
  <u>Subclass Click Form/Controls to customise HTML rendering.</u> 
  <p/>
  This is a good approach for ensuring a common LAF across your web application, 
  but you will have to get your hands dirty and write some code.
  </li><li>
  <u>Use Velocity macros for a generic HTML layout.</u>
  <p/>
  This is easy to do and gives you good reuse across your web application.
  <p/>
  Please see the Form 
  <a href="click-api/net/sf/click/control/Form.html#velocity-macros">velocity macros</a> 
  example, and also see the <a href="examples.html">click-examples</a> 'Velocity Macro' 
  demonstration. 
  </li><li>
  <u>Layout your HTML forms by hand.</u> 
  <p/>
  This gives you the ultimate control in presentation, but provides no reuse 
  across your web application. 
  <p/>
  Please see the Form
  <a href="click-api/net/sf/click/control/Form.html#manual-layout">manual layout</a>
  example.
  </li>
  </ol>
  </dd>
  
  <a name="shared-template" class="heading"></a>
  <dt><b>How can I have many Pages using the same HTML template?</b></dt>
  <dd>
   To do this use the Page templating technique detailed in the 
   <a href="pages.html#page-templating">Page Templating</a> topic. 
   <p/>
   Page templating is highly recommended for your web applications, as it provides
   numerous benefits including:
   <ul>
      <li>greatly reduces the amount of HTML you need to maintain</li>
      <li>ensures you have a common look and feel across you application</li>
      <li>makes your application more robust, as there is less code to test</li>
   </ul>
   For a live demonstation of page templating deploy and run the
   <a href="examples.html">click-examples</a> application.
  </dd>
    
  <a name="exclude-fields" class="heading"></a>
  <dt><b>Can you exclude some fields from a Form?</b></dt>
  <dd>
   To exclude some fields from being displayed in a shared Form class use the
   <a href="click-api/net/sf/click/control/Form.html#removeFields(java.util.List)">Form.removeFields()</a>
   method. 
   <p/>
   You can even do this in your page template. Just make sure you call you call 
   it before $form renders itself. For example:
<pre class="codeHtml">
  <span class="red">$</span><span class="blue">form</span>.<span class="blue">removeFields</span>(["field11", "field15", "field22"])

  <span class="red">$</span><span class="blue">form</span>
</pre>
  </dd>
  
  <a name="localization" class="heading"></a>
  <dt><b>How do you internationalize Pages and Control labels?</b></dt>
  <dd>
   Click provides good string localization support for internationalization requirements.
   <p/>
   The Page class supports page specific string localisation bundles using the 
   method 
   <a href="click-api/net/sf/click/Page.html#getMessage(java.lang.String)">getMessage(String)</a>.
   For example a Login class with three locale string property files on the classpath:
<pre class="codeConfig">
/com/mycorp/pages/Login.properties
/com/mycorp/pages/Login_en.properties
/com/mycorp/pages/Login_fr.properties </pre>
  
   The Field control classes share a common string properties file:
<pre class="codeConfig">
/click-control.properties </pre>  

   The field class provides a number of 
   <a href="click-api/net/sf/click/control/Field.html#getMessage(java.lang.String)">getMessage(String)</a>
   methods which support localized strings and message formatting.
   Please also see the Control topic <a href="controls.html#message-properties">Message Properties</a>.
  </dd>
  
  <a name="actionlink-parameters" class="heading"></a>
  <dt><b>How do you create an ActionLink with several parameters?</b></dt>
  <dd>
   If you need to have an ActionLink with several parameters create a composite
   parameter and pass this to the ActionLink. For example:
   
<pre class="codeHtml">
   <span class="red">#set</span> (<span class="red">$</span><span class="blue">id</span> = <span class="red">$</span><span class="blue">customer.id</span> + "-" + <span class="red">$</span><span class="blue">account.id</span>)
   &lt;a href="<span class="red">$</span><span class="blue">deleteLink.getHref(</span><span class="red">$</span><span class="blue">id</span>)" 
      onclick="return window.confirm('Please confirm to delete this account.');"&gt;
     &lt;img src="images/delete.gif" title="Delete" border="0" align="middle"&gt;
   &lt;/a&gt;
</pre>
   
   In your ActionLink onClick handler method parse out the two parameter values. 
   For example:
   
<pre class="codeJava">
<span class="kw">public boolean</span> onDeleteClick() {
    String value = deleteLink.getValue();
    <span class="kw">int</span> index = value.indexOf(<span class="st">"-"</span>); 
    Long customerId = Long.valueOf(value.substring(0, index)); 
    Long accountId = Long.valueOf(value.substring(index + 1)); 
    
    <span class="cm">// Delete customer account</span>
    ..
    
    <span class="kw">return true</span>;
} </pre>
  </dd>

  <a name="spring-integration" class="heading"></a>
  <dt><b>How can you integrate Click into Spring?</b></dt>
  <dd>
   The ClickServlet can be subclassed to support applications using Inversion
   of Control (IoC) frameworks such as <a href="http://www.springframework.org/">Spring</a> 
   and <a href="http://jakarta.apache.org/hivemind/">HiveMind</a>.
   <p/>
   To integrate Spring with Click use the Click Extras
   <a href="extras-api/net/sf/click/extras/spring/SpringClickServlet.html">SpringClickServlet</a>
   instead of the normal <tt>ClickServlet</tt>. Alternatively you can write your own 
   Spring integration servlet based on this pattern.
   <p/>
   The <tt>SpringClickServlet</tt> servlet subclasses the <tt>ClickServlet</tt> and override the
   <a href="click-api/net/sf/click/ClickServlet.html#newPageInstance(java.lang.String, java.lang.Class)">newPageInstance()</a>
   method to use Spring to create Page objects and set their dependencies. For example:
   
<pre class="codeJava">
<span class="kw">import</span> org.springframework.beans.factory.BeanFactory;
<span class="kw">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;

<span class="kw">public class</span> SpringClickServlet <span class="kw">extends</span> ClickServlet {

    <span class="cm">/** The path to the Spring XML appliation context definition file. */</span>
    <span class="kw">public static final</span> String SPRING_PATH = <span class="st">"spring-path"</span>;
    
    <span class="cm">/** Spring bean factory. */</span>
    <span class="kw">protected</span> BeanFactory beanFactory;

    <span class="cm">/**
     * @see ClickServlet#init()
     */</span>
    <span class="kw">public void</span> init() <span class="kw">throws</span>ServletException {
        <span class="kw">super</span>.init();

        String springPath = getInitParameter(SPRING_PATH);
        <span class="kw">if</span> (springPath == <span class="kw">null</span>) {
            String msg = SPRING_PATH + <span class="st">" servlet init parameter not defined"</span>;
            <span class="kw">throw new</span> UnavailableException(msg);
        }
        beanFactory = <span class="kw">new</span> ClassPathXmlApplicationContext(springPath);
    }

    <span class="cm">/**
     * @see ClickServlet#newPageInstance(String, Class)
     */</span>
    <span class="kw">protected</span> Page newPageInstance(String path, Class pageClass) <span class="kw">throws</span> Exception {
        String beanName = path.substring(0, path.indexOf(<span class="st">"."</span>));
        
        <span class="kw">if</span> (beanFactory.containsBean(beanName)) {
            <span class="kw">return</span> (Page) beanFactory.getBean(beanName);
            
        } <span class="kw">else</span> {
            <span class="kw">return</span> pageClass.newIntance();
        }
    }
} </pre>

   In this example the Spring bean name is derived from the Page path, 
   so the request of <span class="st">"/security/login.htm"</span> would map to a bean name of
   <span class="st">"/security/login"</span>. If a corresponding Spring Page bean could not be found a 
   new Page instance is created from the pageClass.
   <p/>
   The <a href="click-api/net/sf/click/Page.html#onDestroy()">Page.onDestroy()</a>
   method can then be used to free any allocated resources to a Page object. 

   <h4>Spring Web MVC Framework</h4>

   The Spring Web MVC Framework however, is not compatible with Click. The Spring framework
   uses a low level command pattern design like Struts and WebWork.
   Spring uses a <tt>DispatcherServlet</tt> to route requests to <tt>Controller</tt> 
   objects and then passes the <tt>ModelAndView</tt> results to the rendering layer.

<pre class="codeJava">
public interface Controller {
   public ModelAndView handleRequest(HttpServletRequest request, 
                                     HttpServletResponse response) throws Exception;
} </pre>

  In Spring MVC the integration plugin points are the Controllers.
  <p/>
  Click uses higher level design constructs focusing on Pages and Controls. Click uses its
  own <tt>ClickServlet</tt> for dispatching requests to <tt>Pages</tt> and <tt>Control</tt>s, 
  which are Click's plugin points.
  </dd> 

  <a name="jsp-support" class="heading"></a>
  <dt><b>Does Click support JSP?</b></dt>
  <dd>
   Click does provide basic support for JSP pages. 
   However JSP pages are not fully integated into Click like Velocity templates. This 
   will change in the near future and JSP pages will become first class citizens.
   <p/>
   To forward to a JSP page for rendering simply set the Page forward to the target JSP. 
   For example:

<pre class="codeJava">
<span class="kw">public class</span> CustomersTable <span class="kw">extends</span> Page {
    <span class="kw">public void</span> onGet() {
        List customers = CustomerDAO.getCustomers();
        getContext().setRequestAttribute(<span class="st">"customers"</span>, customers);
        
        setForward(<span class="st">"customers-table.jsp"</span>);
    }
} </pre>

   Note you have to set request attributes to pass data to the JSP. In future releases the
   Page model data will be added automatically to the request as named request attribute
   values.
   <p/>
   To have this <tt>CustomersTable</tt> page automatically handle <tt>GET customer-table.htm</tt> 
   requests you will need to create an empty <tt>customer-table.htm</tt> file and
   use either configure page automapping or add a page definition in <tt>click.xml</tt>. 
   For example:

<pre class="codeConfig">
&lt;page path="<span class="blue">customers-table.htm</span>" class="<span class="red">com.mycorp.pages.CustomersTable</span>"/&gt; </pre>

  </dd>
    
  
  <a name="logging" class="heading"></a>
  <dt><b>Why doesn't Click use Commons Logging or Log4J for logging?</b></dt>
  <dd>
   Click does not use Log4J with Velocity because of an appender closing
   memory leak  associated with garbage collecting VelocityEngines. This issue is being
   addressed with latest Velocity 1.5 development stream. 
   <p/>
   There are also Log4J jar locking issues on Tomcat 5.5.9 which can prevent the 
   automatic reloading of web applications.
   <p/>
   Commons Logging is not used because of class loader issues which occur
   on the IBM WebSphere application server.
  </dd>
    
  <a name="why-velocity" class="heading"></a>
  <dt><b>Why not use FreeMarker instead of Velocity?</b></dt>
  <dd>
   FreeMarker was evaluated against Velocity for template rendering,
   and has some features Velocity doesn't. However Velocity was
   chosen over FreeMaker because it doesn't use an XML based 
   syntax, so its easier to read, and because Velocity is easier
   to learn.
   <p/>
   One of FreeMarker's strong points compared to Velocity is error reporting.
   This issue is addressed in Click by using a custom Velocity 1.5 build 
   to provided enhanced error reporting.
   <p/>
   Click will render the source code with the error. For example:
   <ul>
      <li><a href="error-parsing.html">Page Parsing Error</a></li>
      <li><a href="error-npe.html">Null Pointer Error</a></li>
   </ul>
  </dd>
  
</dl>


</body>
</html>

