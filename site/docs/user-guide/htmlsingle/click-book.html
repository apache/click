<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Apache Click</title><link rel="stylesheet" href="css/stylesheet.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.0"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="en" class="book" title="Apache Click"><div class="titlepage"><div><div><h1 class="title"><a name="d0e2"></a>Apache Click</h1></div><div><div class="authorgroup"><h3 class="corpauthor">Apache Click User Guide</h3></div></div><div><div class="mediaobject"><img src="images/click-logo.png"></div></div><div><p class="releaseinfo">V 2.3.0</p></div><div><p class="copyright">Copyright &copy; 2001-2010 The Apache Software Foundation</p></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#chapter-introduction">1. Introduction to Apache Click</a></span></dt><dd><dl><dt><span class="sect1"><a href="#hello-world">1.1. Hello World Example</a></span></dt><dt><span class="sect1"><a href="#control-listener-type-1">1.2. Control Listener Type 1 Example</a></span></dt><dt><span class="sect1"><a href="#control-listener-type-2">1.3. Control Listener Type 2 Example</a></span></dt><dt><span class="sect1"><a href="#simple-table">1.4. Simple Table Example</a></span></dt><dt><span class="sect1"><a href="#advanced-table">1.5. Advanced Table Example</a></span></dt><dt><span class="sect1"><a href="#simple-form">1.6. Simple Form Example</a></span></dt><dt><span class="sect1"><a href="#advanced-form">1.7. Advanced Form Example</a></span></dt><dd><dl><dt><span class="sect2"><a href="#form-layout">1.7.1. Form Layout</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chapter-pages">2. Pages</a></span></dt><dd><dl><dt><span class="sect1"><a href="#classes">2.1. Classes</a></span></dt><dt><span class="sect1"><a href="#execution">2.2. Execution</a></span></dt><dt><span class="sect1"><a href="#request-param-auto-binding">2.3. Request Parameter Auto Binding</a></span></dt><dd><dl><dt><span class="sect2"><a href="#customizing-auto-binding">2.3.1. Customizing Auto Binding</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-security">2.4. Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#applications-authentication">2.4.1. Application Authentication</a></span></dt><dt><span class="sect2"><a href="#container-authentication">2.4.2. Container Authentication</a></span></dt><dt><span class="sect2"><a href="#container-access-control">2.4.3. Container Access Control</a></span></dt><dt><span class="sect2"><a href="#logging-out">2.4.4. Logging Out</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-navigation">2.5. Page Navigation</a></span></dt><dd><dl><dt><span class="sect2"><a href="#forward">2.5.1. Forward</a></span></dt><dd><dl><dt><span class="sect3"><a href="#forward-parameter-passing">2.5.1.1. Forward Parameter Passing</a></span></dt><dt><span class="sect3"><a href="#page-forwarding">2.5.1.2. Page Forwarding</a></span></dt></dl></dd><dt><span class="sect2"><a href="#template-path">2.5.2. Template Path</a></span></dt><dt><span class="sect2"><a href="#redirect">2.5.3. Redirect</a></span></dt><dd><dl><dt><span class="sect3"><a href="#redirect-parameter-passing">2.5.3.1. Redirect Parameter Passing</a></span></dt><dt><span class="sect3"><a href="#post-redirect">2.5.3.2. Post Redirect</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#page-templating">2.6. Page Templating</a></span></dt><dt><span class="sect1"><a href="#page-actions">2.7. Page Actions</a></span></dt><dd><dl><dt><span class="sect2"><a href="#page-action-execution">2.7.1. Page Action Execution</a></span></dt><dt><span class="sect2"><a href="#page-action-result">2.7.2. ActionResult</a></span></dt><dt><span class="sect2"><a href="#page-action-example">2.7.3. Page Action Example</a></span></dt><dt><span class="sect2"><a href="#page-action-accessing-request-parameters">2.7.4. Accessing Request Parameters</a></span></dt><dt><span class="sect2"><a href="#page-action-set-response-headers">2.7.5. Set response headers and status code</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-direct-rendering">2.8. Direct Rendering</a></span></dt><dt><span class="sect1"><a href="#stateful-pages">2.9. Stateful Pages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#page-creation">2.9.1. Page Creation</a></span></dt><dt><span class="sect2"><a href="#page-execution">2.9.2. Page Execution</a></span></dt><dt><span class="sect2"><a href="#page-destruction">2.9.3. Page Destruction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-error-handling">2.10. Error Handling</a></span></dt><dt><span class="sect1"><a href="#page-not-found">2.11. Page Not Found</a></span></dt><dt><span class="sect1"><a href="#page-message-properties">2.12. Page Message Properties</a></span></dt><dt><span class="sect1"><a href="#page-head-elements">2.13. Page HEAD Elements</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chapter-controls">3. Controls</a></span></dt><dd><dl><dt><span class="sect1"><a href="#control-interface">3.1. Control Interface</a></span></dt><dt><span class="sect1"><a href="#control-listener">3.2. Control Listener</a></span></dt><dt><span class="sect1"><a href="#control-class">3.3. Control Classes</a></span></dt><dt><span class="sect1"><a href="#control-message-properties">3.4. Message Properties</a></span></dt><dd><dl><dt><span class="sect2"><a href="#message-resolution">3.4.1. Message Resolution</a></span></dt><dt><span class="sect2"><a href="#control-properties">3.4.2. Control Properties</a></span></dt><dt><span class="sect2"><a href="#accessing-messages">3.4.3. Accessing Messages</a></span></dt></dl></dd><dt><span class="sect1"><a href="#control-head-elements">3.5. Control HEAD Elements</a></span></dt><dt><span class="sect1"><a href="#container">3.6. Container</a></span></dt><dd><dl><dt><span class="sect2"><a href="#abstractcontainer">3.6.1. AbstractContainer</a></span></dt><dt><span class="sect2"><a href="#abstractcontainerfield">3.6.2. AbstractContainerField</a></span></dt></dl></dd><dt><span class="sect1"><a href="#layout">3.7. Layouts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#template-layout">3.7.1. Template layout</a></span></dt><dt><span class="sect2"><a href="#programmatic-layout">3.7.2. Programmatic layout</a></span></dt></dl></dd><dt><span class="sect1"><a href="#behavior">3.8. Behavior</a></span></dt><dd><dl><dt><span class="sect2"><a href="#behavior-execution">3.8.1. Behavior Execution</a></span></dt><dt><span class="sect2"><a href="#behavior-example">3.8.2. Behavior Example</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chapter-ajax">4. Ajax</a></span></dt><dd><dl><dt><span class="sect1"><a href="#ajax-overview">4.1. Ajax Overview</a></span></dt><dt><span class="sect1"><a href="#ajax-behavior">4.2. AjaxBehavior</a></span></dt><dt><span class="sect1"><a href="#ajax-behavior-execution">4.3. AjaxBehavior Execution</a></span></dt><dt><span class="sect1"><a href="#first-ajax-example">4.4. First Ajax Example</a></span></dt><dd><dl><dt><span class="sect2"><a href="#ajax-trace-log">4.4.1. Ajax Trace Log</a></span></dt><dt><span class="sect2"><a href="#ajax-trace-log-no-target-control">4.4.2. Ajax Trace Log - No Ajax Target Control Found</a></span></dt><dt><span class="sect2"><a href="#ajax-trace-log-no-target-ajax-behavior">4.4.3. Ajax Trace Log - No Target AjaxBehavior Found</a></span></dt></dl></dd><dt><span class="sect1"><a href="#ajax-page-action">4.5. Ajax Page Action</a></span></dt><dt><span class="sect1"><a href="#ajax-response-types">4.6. Ajax Response Types</a></span></dt><dt><span class="sect1"><a href="#ajax-error-handling">4.7. Ajax Error Handling</a></span></dt></dl></dd><dt><span class="chapter"><a href="#chapter-configuration">5. Configuration</a></span></dt><dd><dl><dt><span class="sect1"><a href="#servlet-configuration">5.1. Servlet Configuration</a></span></dt><dd><dl><dt><span class="sect2"><a href="#servlet-mapping">5.1.1. Servlet Mapping</a></span></dt><dt><span class="sect2"><a href="#load-on-startup">5.1.2. Load On Startup</a></span></dt><dt><span class="sect2"><a href="#type-converter-class">5.1.3. Type Converter Class</a></span></dt><dt><span class="sect2"><a href="#config-service-class">5.1.4. Config Service Class</a></span></dt></dl></dd><dt><span class="sect1"><a href="#application-configuration">5.2. Application Configuration</a></span></dt><dd><dl><dt><span class="sect2"><a href="#click-app">5.2.1. Click App</a></span></dt><dt><span class="sect2"><a href="#application-pages">5.2.2. Pages</a></span></dt><dd><dl><dt><span class="sect3"><a href="#application-multiple-packages">5.2.2.1. Multiple Pages Packages</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-page">5.2.3. Page</a></span></dt><dd><dl><dt><span class="sect3"><a href="#application-automapping">5.2.3.1. Page Automapping</a></span></dt><dt><span class="sect3"><a href="#application-excludes">5.2.3.2. Automapping Excludes</a></span></dt><dt><span class="sect3"><a href="#application-autobinding">5.2.3.3. Page Autobinding</a></span></dt><dt><span class="sect3"><a href="#application-autobinding-annotation">5.2.3.4. Page Autobinding - Using Annotations</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-headers">5.2.4. Headers</a></span></dt><dd><dl><dt><span class="sect3"><a href="#browser-caching">5.2.4.1. Browser Caching</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-format">5.2.5. Format</a></span></dt><dt><span class="sect2"><a href="#application-mode">5.2.6. Mode</a></span></dt><dd><dl><dt><span class="sect3"><a href="#page-auto-loading">5.2.6.1. Page Auto Loading</a></span></dt><dt><span class="sect3"><a href="#click-logging">5.2.6.2. Click and Velocity Logging</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-controls">5.2.7. Controls</a></span></dt></dl></dd><dt><span class="sect1"><a href="#auto-deployed-files">5.3. Auto Deployed Files</a></span></dt><dd><dl><dt><span class="sect2"><a href="#deploying-restricted-env">5.3.1. Deploying resources in a restricted environment</a></span></dt><dt><span class="sect2"><a href="#deploying-custom-resources">5.3.2. Deploying Custom Resources</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#chapter-best-practices">6. Best Practices</a></span></dt><dd><dl><dt><span class="sect1"><a href="#security">6.1. Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#declarative-security">6.1.1. Declarative Security</a></span></dt><dt><span class="sect2"><a href="#alternatve-security-solutions">6.1.2. Alternative Security solutions</a></span></dt><dt><span class="sect2"><a href="#resources">6.1.3. Resources</a></span></dt></dl></dd><dt><span class="sect1"><a href="#packages-classes">6.2. Packages and Classes</a></span></dt><dd><dl><dt><span class="sect2"><a href="#page-classes">6.2.1. Page Classes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#automapping">6.3. Page Auto Mapping</a></span></dt><dt><span class="sect1"><a href="#navigation">6.4. Navigation</a></span></dt><dt><span class="sect1"><a href="#templating">6.5. Templating</a></span></dt><dt><span class="sect1"><a href="#menus">6.6. Menus</a></span></dt><dt><span class="sect1"><a href="#logging">6.7. Logging</a></span></dt><dt><span class="sect1"><a href="#error-handling">6.8. Error Handling</a></span></dt><dt><span class="sect1"><a href="#performance">6.9. Performance</a></span></dt></dl></dd></dl></div><div class="chapter" title="Chapter&nbsp;1.&nbsp;Introduction to Apache Click"><div class="titlepage"><div><div><h2 class="title"><a name="chapter-introduction"></a>Chapter&nbsp;1.&nbsp;Introduction to Apache Click</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="#hello-world">1.1. Hello World Example</a></span></dt><dt><span class="sect1"><a href="#control-listener-type-1">1.2. Control Listener Type 1 Example</a></span></dt><dt><span class="sect1"><a href="#control-listener-type-2">1.3. Control Listener Type 2 Example</a></span></dt><dt><span class="sect1"><a href="#simple-table">1.4. Simple Table Example</a></span></dt><dt><span class="sect1"><a href="#advanced-table">1.5. Advanced Table Example</a></span></dt><dt><span class="sect1"><a href="#simple-form">1.6. Simple Form Example</a></span></dt><dt><span class="sect1"><a href="#advanced-form">1.7. Advanced Form Example</a></span></dt><dd><dl><dt><span class="sect2"><a href="#form-layout">1.7.1. Form Layout</a></span></dt></dl></dd></dl></div><p>Apache Click is a simple JEE web application framework for commercial
  Java developers.
  </p><p>Apache Click is an open source project, licensed under the
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../LICENSE.txt" target="_blank"><em class="citetitle">Apache license</em>
  </a>.
  </p><p>Click uses an event based programming model for processing Servlet
  requests and <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../velocity/velocity.html" target="_blank">Velocity</a> for
  rendering the response. (Note other template engines such as
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/jsp/" target="_blank">JSP</a> and
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://freemarker.sourceforge.net/" target="_blank">Freemarker</a> are also
  supported)
  </p><p>This framework uses a single servlet, called
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ClickServlet.html" target="_blank">ClickServlet</a>,
  to act as a request dispatcher. When a request arrives ClickServlet creates
  a <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html" target="_blank">Page</a>
  object to process the request and then uses the page's Velocity template to
  render the results.
  </p><p>Pages provide a simple thread safe programming environment, with a new
  page instance created for each servlet request.
  </p><p>Possibly the best way to see how Click works is to dive right in and
  look at some examples. (The examples are also available online at
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/" target="_blank">http://click.avoka.com/click-examples/</a>
  under the menu "Intro Examples".)
  </p><div class="sect1" title="1.1.&nbsp;Hello World Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="hello-world"></a>1.1.&nbsp;Hello World Example</h2></div></div></div><p>A Hello World example in Click would look something like this.
    </p><p>First we create a <code class="classname">HelloWorld</code> page class:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> <span class="symbol">examples.page</span>;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">import</span> java.util.Date;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">import</span> org.apache.click.Page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> HelloWorld <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Date time = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Date(); <a class="co" name="co-hello-world-date" href="#ca-hello-world-date"><img src="images/callouts/1.gif" alt="1" border="0"></a>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> HelloWorld() {
        addModel(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"time"</span>, time); <a class="co" name="co-hello-world-addmodel" href="#ca-hello-world-addmodel"><img src="images/callouts/2.gif" alt="2" border="0"></a>
    }

}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-hello-world-date"></a><a href="#co-hello-world-date"><img src="images/callouts/1.gif" alt="1" border="0"></a> </td><td valign="top" align="left"><p>Assign a new Date instance to the <code class="literal">time</code> variable.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-hello-world-addmodel"></a><a href="#co-hello-world-addmodel"><img src="images/callouts/2.gif" alt="2" border="0"></a> </td><td valign="top" align="left"><p>Add the <code class="literal">time</code> variable to the Page model under
        the name <code class="varname">"time"</code>. Click ensures all objects added
        to the Page model is automatically available in the Page template.
        </p></td></tr></table></div><p>Next we have a page template <code class="varname">hello-world.htm</code>,
    <a class="indexterm" name="d0e101"></a>
    where we can access the Page's <code class="literal">time</code> variable using the
    reference <code class="varname">$time</code>:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;h2&gt;</span>Hello World<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/h2&gt;</span>

    Hello world from Click at <code class="varname">$time</code>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>Click is smart enough to figure out that the <code class="classname">HelloWorld</code>
    page class maps to the template <code class="varname">hello-world.htm</code>. We only
    have to inform Click of the <span class="package">package</span> of the HelloWorld
    class, in this case <span class="symbol">examples.page</span>. We do that through the
    <a class="link" href="#application-configuration" title="5.2.&nbsp;Application Configuration">click.xml</a> configuration
    file which allows Click to map <code class="varname">hello-world.htm</code> requests
    to the <code class="classname">examples.page.HelloWorld</code> page class.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="symbol">examples.page</span>"/&gt;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>At runtime the following sequence of events occur. The ClickSerlvet
    maps a GET <code class="varname">hello-world.htm</code> request to our page class
    <code class="classname">example.page.HelloWorld</code> and creates a new instance.
    The HelloWorld page creates a new private <span class="emphasis"><em>Date</em></span> object,
    which is added to the page's model under the name <code class="varname">time</code>.
    </p><p>The page model is then merged with the template which substitutes
    the <code class="varname">$time</code> reference with the <span class="emphasis"><em>Date</em></span>
    object. Velocity then renders the merged template as:
    </p><div class="figure"><a name="hello-world-screenshot"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/introduction/hello-world-screenshot.png" alt="Hello World Screenshot"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.1.&nbsp;Hello World Screenshot</i></p></div><br class="figure-break"></div><div class="sect1" title="1.2.&nbsp;Control Listener Type 1 Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-listener-type-1"></a>1.2.&nbsp;Control Listener Type 1 Example</h2></div></div></div><p>Click includes a library of <a class="link" href="#chapter-controls" title="Chapter&nbsp;3.&nbsp;Controls">Controls</a>
    which provide user interface functionality.
    </p><p>One of the commonly used controls is the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/ActionLink.html" target="_blank">ActionLink</a>,
    which you can use to have an HTML link call a method on a Page object.
    For example:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ControlListenerType1Page <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/* Set the listener to this object's "onLinkClick" method. */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> ActionLink myLink = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"myLink"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onLinkClick"</span>)

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> String msg;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Constructor ------------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ControlListenerType1Page() {
        addControl(myLink); <a class="co" name="co-addcontrol" href="#ca-addcontrol"><img src="images/callouts/1.gif" alt="1" border="0"></a>
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Event Handlers ---------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Handle the ActionLink control click event.
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onLinkClick() {
        String msg = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"ControlListenerPage#"</span> + hashCode()
            + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">" object method &lt;tt&gt;onLinkClick()&lt;/tt&gt; invoked."</span>;
        addModel(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"msg"</span>, msg);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }

}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-addcontrol"></a><a href="#co-addcontrol"><img src="images/callouts/1.gif" alt="1" border="0"></a> </td><td valign="top" align="left"><p>Add the link to the page. The link will be made available to the
        page template under the variable <code class="varname">myLink</code>, which
        is the name of the control.
        </p></td></tr></table></div><p>In the Page class we create an ActionLink called
    <code class="varname">myLink</code> and define the control's listener to be the page
    method <code class="methodname">onLinkClick()</code>. When a user clicks on
    <code class="varname">myLink</code> control it will invoke the listener method
    <code class="methodname">onLinkClick()</code>.
    </p><p>In Click a control listener method can have any name but it must
    return a boolean value. The boolean return value specifies whether
    processing of page events should continue. This control listener pattern
    provides a short hand way for wiring up action listener methods without
    having to define anonymous inner classes.
    </p><p>The advantage of this style of control listener binding is that you
    have to write fewer lines of code. The disadvantage of this type of control
    listener binding is that no compile time safety is provided, and you miss
    out on the compiler refactoring capabilities provided with modern IDEs.
    </p><p>Back to our example, in the page template we define an HTML link and
    have the <code class="varname">myLink</code> control render the link's href attribute:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"style.css"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/link&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>
  
  Click myLink control <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;a</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><code class="varname">$myLink.href</code>"&gt;here<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/a&gt;</span>.

  <span class="command"><strong>#if</strong></span> (<code class="varname">$msg</code>)
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"msgDiv"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span> <code class="varname">$msg</code> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span>
  <span class="command"><strong>#end</strong></span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>At runtime this page would be rendered as:</p><div class="literallayout"><p>Click&nbsp;myLink&nbsp;control&nbsp;<code class="varname">here</code>.</p></div><p>When a user clicks on the link the <code class="methodname">onLinkClick()</code>
    method is invoked. This method then creates the <code class="varname">msg</code> model
    value, which is rendered in the page as:
    </p><div class="literallayout"><p>Click&nbsp;myLink&nbsp;control&nbsp;<code class="varname">here</code>.<br>
<br>
<code class="computeroutput">ControlListenerPage#12767107&nbsp;object&nbsp;method&nbsp;onLinkClick()&nbsp;invoked.</code></p></div></div><div class="sect1" title="1.3.&nbsp;Control Listener Type 2 Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-listener-type-2"></a>1.3.&nbsp;Control Listener Type 2 Example</h2></div></div></div><p>The second type of control listener binding uses the 
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/ActionListener.html" target="_blank">ActionListener</a>
    interface to provide compile time safety. This compile time binding also 
    supports code refactoring using modern IDE tools.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ControlListenerType2Page <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> ActionLink myLink = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"myLink"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Constructor ------------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Create a new Page instance.
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ControlListenerType2Page() {
        addControl(myLink);

        myLink.setActionListener(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionListener() {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onAction(Control control) {
                 String msg = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"ControlListenerPage#"</span> + hashCode()
                 + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">" object method &lt;tt&gt;onAction()&lt;/tt&gt; invoked."</span>;
                 addModel(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"msg"</span>, msg);

             <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
            }
        });
    }

}</pre><p>In the Page class we create an ActionLink called
    <code class="varname">myLink</code>. In the Page constructor we set the control's
    action listener to an anonymous inner class which implements the method
    <code class="methodname">onAction()</code>. When a user clicks on the
    <code class="varname">myLink</code> control it will invoke the action listener method
    <code class="methodname">onAction()</code>.
    </p><p>As with our previous example, in the page template we define a HTML link and
    have the <code class="varname">myLink</code> control render the link's href attribute:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"style.css"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/link&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>
  
  Click myLink control <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;a</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><code class="varname">$myLink.href</code>"&gt;here<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/a&gt;</span>.

  <span class="command"><strong>#if</strong></span> (<code class="varname">$msg</code>)
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"msgDiv"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span> <code class="varname">$msg</code> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span>
  <span class="command"><strong>#end</strong></span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>At runtime this page would be rendered as:</p><div class="literallayout"><p>Click&nbsp;myLink&nbsp;control&nbsp;<code class="varname">here</code>.</p></div><p>When a user clicks on the link the <code class="methodname">onAction()</code>
    method is invoked. This method then creates the <code class="varname">msg</code> model
    value, which is rendered in the page as:
    </p><div class="literallayout"><p>Click&nbsp;myLink&nbsp;control&nbsp;<code class="varname">here</code>.<br>
<br>
<code class="computeroutput">ControlListenerPage#12767107&nbsp;object&nbsp;method&nbsp;onAction()&nbsp;invoked.</code></p></div></div><div class="sect1" title="1.4.&nbsp;Simple Table Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="simple-table"></a>1.4.&nbsp;Simple Table Example</h2></div></div></div><p>One of the most useful Click controls is the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Table.html" target="_blank">Table</a>
    control.
    </p><p>An example usage of the Table control in a customers Page is provided
    below:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> SimpleTablePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pun">@Bindable</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Table table = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Table();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Constructor ------------------------------------------------------------</span>
     
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> SimpleTablePage() {
        table.setClass(Table.CLASS_ITS);
        
        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"id"</span>));
        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"name"</span>));
        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"email"</span>));
        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"investments"</span>));
    }
    
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Event Handlers ---------------------------------------------------------</span>
     
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onRender()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pun">@Override</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onRender() {
        List list = getCustomerService().getCustomersSortedByName(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="lit">10</span>);
        table.setRowList(list); 
    }
}</pre><p>In this Page code example a Table control is declared, we set the
    table's HTML class, and then define a number of table
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Column.html" target="_blank">Column</a>
    objects. In the column definitions we specify the name of the column in the
    constructor, which is used for the table column header and also to specify
    the row object property to render.
    </p><p>The last thing we need to do is populate the table with data. To do
    this we override the Page onRender() method and set the table row list
    before it is rendered.
    </p><p>In our Page template we simply reference the <code class="varname">$table</code>
    object which is rendered when its <code class="methodname">toString()</code> method
    is called.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <code class="varname">$headElements</code>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <code class="varname">$table</code>

    <code class="varname">$jsElements</code>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>Note from the example above that we specify the <code class="varname">$headElements</code>
    reference so that the table can include any HEAD elements, which includes Css
    imports and styles, in the header. Also note we specify the
    <code class="varname">$jsElements</code> reference which include any JavaScript imports
    and scripts at the bottom. At runtime Click automatically makes the variables
    <code class="varname">$headElements</code> and <code class="varname">$jsElements</code> available
    to the template.
    </p><p>At runtime the Table would be rendered in the page as:</p><div class="figure"><a name="simple-table-image"></a><div class="figure-contents"><div class="mediaobject"><img src="images/introduction/simple-table.png" alt="Simple Table"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.2.&nbsp;Simple Table</i></p></div><br class="figure-break"></div><div class="sect1" title="1.5.&nbsp;Advanced Table Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="advanced-table"></a>1.5.&nbsp;Advanced Table Example</h2></div></div></div><p>The Table control also provides support for:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>automatic rendering</p></li><li class="listitem"><p>column formatting and custom rendering</p></li><li class="listitem"><p>automatic pagination</p></li><li class="listitem"><p>link control support</p></li></ul></div><p>A more advanced Table example is provided below:</p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Table table = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Table(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"table"</span>);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> PageLink editLink = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> PageLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Edit"</span>, EditCustomer.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> ActionLink deleteLink = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Delete"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onDeleteClick"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Constructor ------------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> CustomersPage() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add controls</span>
        addControl(table);
        addControl(editLink);
        addControl(deleteLink);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Setup table</span>
        table.setClass(Table.CLASS_ITS);
        table.setPageSize(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="lit">10</span>);
        table.setShowBanner(true);
        table.setSortable(true);

        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"id"</span>));

        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"name"</span>));
        
        Column column = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"email"</span>);
        column.setAutolink(true);
        column.setTitleProperty(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"name"</span>);
        table.addColumn(column);
        
        table.addColumn(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"investments"</span>));
        
        editLink.setImageSrc(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/images/table-edit.png"</span>);
        editLink.setTitle(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Edit customer details"</span>);
        editLink.setParameter(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"referrer"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/introduction/advanced-table.htm"</span>);
        
        deleteLink.setImageSrc(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/images/table-delete.png"</span>);
        deleteLink.setTitle(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Delete customer record"</span>);
        deleteLink.setAttribute(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onclick"</span>,
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"return window.confirm('Are you sure you want to delete this record?');"</span>);

        column = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Column(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Action"</span>);
        column.setTextAlign(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"center"</span>);
        AbstractLink[] links = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> AbstractLink[] { editLink, deleteLink };
        column.setDecorator(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> LinkDecorator(table, links, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"id"</span>));
        column.setSortable(false);
        table.addColumn(column);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Table rowList will be populated through a DataProvider which loads</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// data on demand.</span>
        table.setDataProvider(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DataProvider() {

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> List getData() {
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> getCustomerService().getCustomers();
            }
        });

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Below we setup the table to preserve it's state (sorting and paging)</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// while editing customers</span>

        table.getControlLink().setActionListener(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionListener() {

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onAction(Control source) {
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Save Table sort and paging state between requests.</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// NOTE: we set the listener on the table's Link control which is invoked</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// when the Link is clicked, such as when paging or sorting.</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// This ensures the table state is only saved when the state changes, and</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// cuts down on unnecessary session replication in a cluster environment.</span>
                table.saveState(getContext()); <a class="co" name="co-save-table-state" href="#ca-save-table-state"><img src="images/callouts/1.gif" alt="1" border="0"></a>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
            }
        });

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Restore the table sort and paging state from the session between requests</span>
        table.restoreState(getContext()); <a class="co" name="co-restore-table-state" href="#ca-restore-table-state"><img src="images/callouts/2.gif" alt="2" border="0"></a>
    }
    
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Event Handlers ---------------------------------------------------------</span>
         
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Handle the delete row click event.
     */</span>    
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onDeleteClick() {
        Integer id = deleteLink.getValueInteger();
        getCustomerService().deleteCustomer(id);
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-save-table-state"></a><a href="#co-save-table-state"><img src="images/callouts/1.gif" alt="1" border="0"></a> </td><td valign="top" align="left"><p>Table is a <a class="external" href="../../click-api/org/apache/click/Stateful.html" target="_blank">Stateful</a>
        control and provides methods for saving and restoring it's state.
        Here we save the Table state in the
        <a class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpSession.html" target="_blank">HttpSession</a>
        which ensures sort and paging state is preserved while editing customers.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-restore-table-state"></a><a href="#co-restore-table-state"><img src="images/callouts/2.gif" alt="2" border="0"></a> </td><td valign="top" align="left"><p>Restore the Table state that was previously saved in the
        <code class="classname">HttpSession</code>.
        </p></td></tr></table></div><p>In this Page code example a Table control is declared and a number of
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Column.html" target="_blank">Column</a>
    objects are added. We set the Table's
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/dataprovider/DataProvider.html" target="_blank">DataProvider</a>
    instance which provides data on demand to the table. Data retrieved from the
    dataProvider will be used to populate the Table rowList before it is rendered.
    An editLink <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/PageLink.html" target="_blank">PageLink</a>
    control is used as decorator for the "Action" column. This control navigates
    to the <code class="classname">EditCustomer</code> page. A deleteLink
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/ActionLink.html" target="_blank">ActionLink</a>
    control is also used as a decorator for the "Action" column. This control will
    invoke the Page <code class="methodname">onDeleteClick()</code> method when it is
    clicked.
    </p><p>In our Page template we simply reference the <code class="varname">$table</code>
    object which is rendered when its <code class="methodname">toString()</code> method
    is called.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <code class="varname">$headElements</code>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <code class="varname">$table</code>

    <code class="varname">$jsElements</code>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>At runtime the Table would be rendered in the page as:</p><div class="figure"><a name="advanced-table-image"></a><div class="figure-contents"><div class="mediaobject"><img src="images/introduction/advanced-table.png" alt="Advanced Table"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.3.&nbsp;Advanced Table</i></p></div><br class="figure-break"><p>In this example, clicking on the Edit link will navigate the user to
    the <code class="classname">EditCustomer</code> page where the selected customer
    can be edited. When the user click on the Delete link, the
    <code class="methodname">onDeleteClick()</code> method will be called on the Page
    deleting the customer record.
    </p></div><div class="sect1" title="1.6.&nbsp;Simple Form Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="simple-form"></a>1.6.&nbsp;Simple Form Example</h2></div></div></div><p>The <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html" target="_blank">Form</a>
    and <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Field.html" target="_blank">Field</a>
    controls are also some of the most commonly used controls in the Click Framework.
    </p><p>The SimpleForm page below provides a demonstration of using these
    controls.
    </p><p>In our example code we have the page's constructor adding a
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/TextField.html" target="_blank">TextField</a>
    field and a <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Submit.html" target="_blank">Submit</a>
    button to the form. A page method is also set as a control listener on the
    form. Also note in this example the page's public <code class="varname">form</code>
    field is automatically added to its list of controls.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> SimpleForm <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form form = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"form"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Constructor ------------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> SimpleForm() {
        addControl(form);

        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"name"</span>, true));
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Submit(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"OK"</span>));

        form.setListener(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onSubmit"</span>);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Event Handlers ---------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Handle the form submit event.
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onSubmit() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (form.isValid()) {
            msg = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Your name is "</span> + form.getFieldValue(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"name"</span>);
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }
}</pre><p>Next we have the SimpleForm template <code class="varname">simple-form.htm</code>.
    The Click application automatically associates the
    <code class="varname">simple-form.htm</code> template with the
    <code class="classname">SimpleForm</code> class.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <code class="varname">$headElements</code>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <code class="varname">$form</code>

    <span class="command"><strong>#if</strong></span> (<code class="varname">$msg</code>)
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"msgDiv"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span> <code class="varname">$msg</code> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span>
    <span class="command"><strong>#end</strong></span>

    <code class="varname">$jsElements</code>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>When the SimpleForm page is first requested the <code class="varname">$form</code>
    object will automatically render itself as:
    </p><div class="figure"><a name="simple-form-image"></a><div class="figure-contents"><div class="mediaobject"><img src="images/introduction/simple-form.png" alt="Simple Form"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.4.&nbsp;Simple Form</i></p></div><br class="figure-break"><p>Say the user does not enter their name and presses the OK button to
    submit the form. The <code class="classname">ClickServlet</code> creates a new
    SimpleForm page and processes the form control.
    </p><p>The form control processes its fields and determines that it is
    invalid. The form then invokes the listener method
    <code class="methodname">onSubmit()</code>. As the form is not valid this method
    simply returns true and the form renders the field validation errors.
    </p><div class="figure"><a name="simple-form-error-image"></a><div class="figure-contents"><div class="mediaobject"><img src="images/introduction/simple-form-error.png" alt="Form after an invalid request"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.5.&nbsp;Form after an invalid request</i></p></div><br class="figure-break"><p>Note the form will automatically maintain the entered state during the
    post and validate cycle.
    </p><p>Now if the user enters their name and clicks the OK button, the form
    will be valid and the <code class="methodname">onSubmit()</code> add a
    <code class="varname">msg</code> to the Pages model. This will be rendered as:
    </p><div class="figure"><a name="simple-form-success-image"></a><div class="figure-contents"><div class="mediaobject"><img src="images/introduction/simple-form-success.png" alt="Form after a valid request"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.6.&nbsp;Form after a valid request</i></p></div><br class="figure-break"></div><div class="sect1" title="1.7.&nbsp;Advanced Form Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="advanced-form"></a>1.7.&nbsp;Advanced Form Example</h2></div></div></div><p>The <code class="classname">AdvancedForm</code> page below provides a more
    advanced demonstration of using Form, Field and FieldSet controls.
    </p><p>First we have an <code class="classname">AdvancedForm</code> class which
    setups up a <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html" target="_blank">Form</a>
    in its constructor. The form's investment
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Select.html" target="_blank">Select</a>
    list is populated in the page's <code class="methodname">onInit()</code> method. At
    this point any page dependencies such as the CustomerService should be
    available.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> AdvancedForm <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form form = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"form"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Select investmentSelect = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Select(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"investment"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Constructor ------------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> AdvancedForm() {
        addControl(form);

        FieldSet fieldSet = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> FieldSet(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Customer"</span>);
        form.add(fieldSet);

        TextField nameField = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"name"</span>, true);
        nameField.setMinLength(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="lit">5</span>);
        nameField.setFocus(true);
        fieldSet.add(nameField);

        fieldSet.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> EmailField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"email"</span>, true));

        fieldSet.add(investmentSelect);

        fieldSet.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DateField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"dateJoined"</span>, true));
        fieldSet.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Checkbox(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"active"</span>));

        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Submit(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"ok"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">" OK "</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onOkClicked"</span>));
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Submit(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"cancel"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onCancelClicked"</span>));
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Event Handlers ---------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onInit()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pun">@Override</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>.onInit();

        investmentSelect.setDefaultOption(Option.EMPTY_OPTION);
        investmentSelect.setDataProvider(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DataProvider() {

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> List&lt;Option&gt; getData() {
                List&lt;Option&gt; options = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ArrayList&lt;Option&gt;();
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">for</span> (String category : customerService.getInvestmentCategories()) {
                    options.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Option(category));
                }
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> options;
            }
        });
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Handle the OK button click event.
     *
     * @return true
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onOkClicked() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (form.isValid()) {
            Customer customer = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Customer();
            form.copyTo(customer);

            getCustomerService().saveCustomer(customer);

            form.clearValues();

            String msg = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"A new customer record has been created."</span>;
            addModel(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"msg"</span>, msg);
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Handle the Cancel button click event.
     *
     * @return false
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onCancelClicked() {
        setRedirect(HomePage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
    }
}</pre><p>Next we have the AdvancedForm template
    <code class="filename">advanced-form.htm</code>. The Click application automatically
    associates the <code class="filename">advanced-form.htm</code> template with the
    <code class="classname">AdvancedForm</code> class.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <code class="varname">$headElements</code>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <span class="command"><strong>#if</strong></span> (<code class="varname">$msg</code>)
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"msgDiv"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span> <code class="varname">$msg</code> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span>
    <span class="command"><strong>#end</strong></span>

    <code class="varname">$form</code>

    <code class="varname">$headElements</code>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>When the AdvancedForm page is first requested the
    <code class="varname">$form</code> object will automatically render itself as:
    </p><div class="figure"><a name="advanced-form-image"></a><div class="figure-contents"><div class="mediaobject"><img src="images/introduction/advanced-form.png" alt="Advanced Form"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;1.7.&nbsp;Advanced Form</i></p></div><br class="figure-break"><p>In this example when the OK button is clicked the
    <code class="methodname">onOkClicked()</code> method is invoked. If the form is
    valid a new customer object is created and the forms field values are copied
    to the new object using the Form
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html#copyTo(java.lang.Object)" target="_blank">copyTo()</a>
    method. The customer object is then saved, the form's field values are
    cleared and an info message is presented to the user.
    </p><p>If the user clicks on the Cancel button the request is redirected to
    the applications HomePage.
    </p><div class="sect2" title="1.7.1.&nbsp;Form Layout"><div class="titlepage"><div><div><h3 class="title"><a name="form-layout"></a>1.7.1.&nbsp;Form Layout</h3></div></div></div><p>In the example above the Form control automatically renders the form
      and the fields HTML markup. This is a great feature for quickly building
      screens, and the form control provides a number of layout options. See the
      Click Examples for an interactive
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/form/form-properties.htm" target="_blank">Form Properties demo</a>.
      </p><p>For fine grained page design you can specifically layout form and
      fields in your page template. See the
      <a class="link" href="#template-layout" title="3.7.1.&nbsp;Template layout">Template Layout</a> section and
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html#form-layout" target="_blank">Form</a>
      Javadoc for more details.
      </p><p>An alternative to page template design is using a programmatic
      approach. See <a class="link" href="#programmatic-layout" title="3.7.2.&nbsp;Programmatic layout">Programmatic Layout</a>
      for more details.
      </p></div></div></div><div class="chapter" title="Chapter&nbsp;2.&nbsp;Pages"><div class="titlepage"><div><div><h2 class="title"><a name="chapter-pages"></a>Chapter&nbsp;2.&nbsp;Pages</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="#classes">2.1. Classes</a></span></dt><dt><span class="sect1"><a href="#execution">2.2. Execution</a></span></dt><dt><span class="sect1"><a href="#request-param-auto-binding">2.3. Request Parameter Auto Binding</a></span></dt><dd><dl><dt><span class="sect2"><a href="#customizing-auto-binding">2.3.1. Customizing Auto Binding</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-security">2.4. Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#applications-authentication">2.4.1. Application Authentication</a></span></dt><dt><span class="sect2"><a href="#container-authentication">2.4.2. Container Authentication</a></span></dt><dt><span class="sect2"><a href="#container-access-control">2.4.3. Container Access Control</a></span></dt><dt><span class="sect2"><a href="#logging-out">2.4.4. Logging Out</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-navigation">2.5. Page Navigation</a></span></dt><dd><dl><dt><span class="sect2"><a href="#forward">2.5.1. Forward</a></span></dt><dd><dl><dt><span class="sect3"><a href="#forward-parameter-passing">2.5.1.1. Forward Parameter Passing</a></span></dt><dt><span class="sect3"><a href="#page-forwarding">2.5.1.2. Page Forwarding</a></span></dt></dl></dd><dt><span class="sect2"><a href="#template-path">2.5.2. Template Path</a></span></dt><dt><span class="sect2"><a href="#redirect">2.5.3. Redirect</a></span></dt><dd><dl><dt><span class="sect3"><a href="#redirect-parameter-passing">2.5.3.1. Redirect Parameter Passing</a></span></dt><dt><span class="sect3"><a href="#post-redirect">2.5.3.2. Post Redirect</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#page-templating">2.6. Page Templating</a></span></dt><dt><span class="sect1"><a href="#page-actions">2.7. Page Actions</a></span></dt><dd><dl><dt><span class="sect2"><a href="#page-action-execution">2.7.1. Page Action Execution</a></span></dt><dt><span class="sect2"><a href="#page-action-result">2.7.2. ActionResult</a></span></dt><dt><span class="sect2"><a href="#page-action-example">2.7.3. Page Action Example</a></span></dt><dt><span class="sect2"><a href="#page-action-accessing-request-parameters">2.7.4. Accessing Request Parameters</a></span></dt><dt><span class="sect2"><a href="#page-action-set-response-headers">2.7.5. Set response headers and status code</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-direct-rendering">2.8. Direct Rendering</a></span></dt><dt><span class="sect1"><a href="#stateful-pages">2.9. Stateful Pages</a></span></dt><dd><dl><dt><span class="sect2"><a href="#page-creation">2.9.1. Page Creation</a></span></dt><dt><span class="sect2"><a href="#page-execution">2.9.2. Page Execution</a></span></dt><dt><span class="sect2"><a href="#page-destruction">2.9.3. Page Destruction</a></span></dt></dl></dd><dt><span class="sect1"><a href="#page-error-handling">2.10. Error Handling</a></span></dt><dt><span class="sect1"><a href="#page-not-found">2.11. Page Not Found</a></span></dt><dt><span class="sect1"><a href="#page-message-properties">2.12. Page Message Properties</a></span></dt><dt><span class="sect1"><a href="#page-head-elements">2.13. Page HEAD Elements</a></span></dt></dl></div><p>Pages are the heart of web applications. In Apache Click, Pages encapsulate
  the processing of HTML requests and the rendering of HTML responses.
  This chapter discusses Apache Click pages in detail.
  </p><p>In Click, a logical page is composed of a Java class and a Velocity
  template, with these components being defined in page elements of the
  <a class="link" href="#application-configuration" title="5.2.&nbsp;Application Configuration">click.xml</a>
  file:
  </p><div class="literallayout"><p>&lt;page&nbsp;path="<code class="varname">search.htm</code>"&nbsp;classname="<span class="token">com.mycorp.page.Search</span>"/&gt;</p></div><p>The path attribute specifies the location of the page Velocity template,
  and the classname attribute specifies the page Java class name. If you use
  the Freemarker template engine instead of Velocity, the setup is the same.
  </p><p>The template path should have an <code class="varname">.htm</code> extension which
  is specified in <a class="link" href="#servlet-configuration" title="5.1.&nbsp;Servlet Configuration">web.xml</a> to route
  *.htm requests to the <code class="classname">ClickServlet</code>.
  </p><p>Please note if you want Click to process templates with a different
  extension e.g. <code class="varname">.xml</code>, you need to implement the method
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/ConfigService.html#isTemplate(java.lang.String)" target="_blank">isTemplate(String path)</a>
  and specify the extra extensions. The simplest way is to subclass
  <code class="classname">XmlConfigService</code> and override the default implementation
  as described <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/XmlConfigService.html#isTemplate(java.lang.String)" target="_blank">here</a>.
  Also remember to map the new extensions in <code class="filename">web.xml</code>.
  </p><p>If you use JSP pages for rendering, the <code class="varname">.jsp</code> extension
  must be used. For example:
  </p><div class="literallayout"><p>&lt;page&nbsp;path="<code class="varname">search.jsp</code>"&nbsp;classname="<span class="token">com.mycorp.page.Search</span>"/&gt;</p></div><p>Please note, Click does not handle JSP requests directly, instead it forwards
  JSP requests to the servlet container. Do not map the ClickServlet to handle
  <code class="filename">*.jsp</code> requests in <code class="filename">web.xml</code>. Instead
  <code class="varname">.jsp</code> templates are accessed with a <code class="varname">.htm</code>
  extension. At runtime Click will convert the page path from
  <code class="varname">.jsp</code> to <code class="varname">.htm</code> and back.
  </p><div class="sect1" title="2.1.&nbsp;Classes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="classes"></a>2.1.&nbsp;Classes</h2></div></div></div><p> All custom Click pages must subclass the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html" target="_blank">Page</a> base class.
    The Page class and its associated companion classes, Context and Control,
    are depicted in the figure below.
    </p><div class="figure"><a name="page-class-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/pages/click-class-diagram.png" alt="Page Class Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;2.1.&nbsp;Page Class Diagram
      </i></p></div><br class="figure-break"><p>The Page class provides a
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#model" target="_blank">model</a>
    attribute which is used to hold all the objects that are rendered in the
    page Velocity template. The model may also contain
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html" target="_blank">Control</a>
    objects, which provide user interface controls on the Page.
    </p><p>Pages also provides access to the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Context.html" target="_blank">Context</a>
    object which references all the javax.servlet objects associated with the
    request. When programming in Click you use the Context object to access
    HttpServletRequest attributes, parameters and the HttpSession object.
    </p></div><div class="sect1" title="2.2.&nbsp;Execution"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="execution"></a>2.2.&nbsp;Execution</h2></div></div></div><p>The Page class provide a number of empty handler methods which
    subclasses can override to provide functionality:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onSecurityCheck()" target="_blank">onSecurityCheck()</a>
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onInit()" target="_blank">onInit()</a>
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onGet()" target="_blank">onGet()</a>
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onPost()" target="_blank">onPost()</a>
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onRender()" target="_blank">onRender()</a>
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onDestroy()" target="_blank">onDestroy()</a>
        </p></li></ul></div><p>The ClickServlet relies on instantiating Pages using a public no
    arguments constructor, so when you create Page subclasses you must ensure
    you don't add an incompatible constructor. The GET request execution sequence
    for Pages is summarized below in the Figure 2.
    </p><div class="figure"><a name="get-sequence-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/pages/get-sequence-diagram.png" alt="GET Request Sequence Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;2.2.&nbsp;GET Request Sequence Diagram
      </i></p></div><br class="figure-break"><p>Stepping through this GET request sequence, a new Page instance is
    created and the attributes for the Page are set (format, headers,
    path). Next, request parameter values are bound to any matching public
    Page variables.
    </p><p>Then the <code class="methodname">onSecurityCheck()</code> handler is executed.
    This method can be used to ensure the user is authorized to access the page,
    and if necessary abort any further processing.
    </p><p>The next method invoked is <code class="methodname">onInit()</code>, this is
    where you place any post constructor initialization code.
    <code class="methodname">onInit()</code> is the ideal place to create controls such
    as Forms, Fields and Tables. As illustrated by the diagram, after a Page's
    <code class="methodname">onInit()</code> is called, each Control, available at that
    stage, will have their <code class="methodname">onInit()</code> method called.
    </p><p>
    The next step is the processing of the Page's
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#controls" target="_blank">controls</a>.
    The ClickServlet gets the list of Controls from the page and then iterates
    through the list calling <code class="methodname">onProcess()</code>. If any of the
    Control's <code class="methodname">onProcess()</code> methods return false,
    processing of subsequent controls and the Page's <code class="methodname">onGet()</code>
    method is aborted.
    </p><p>If everything is executing normally the Page's
    <code class="methodname">onGet()</code> method is now called.
    </p><p>The next step is rendering the page template to generate the displayed
    HTML. The ClickServlet gets the model (<code class="classname">Map</code>) from the
    Page then adds the following objects to the model:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>any public Page variable using the variable name</p></li><li class="listitem"><p>context &nbsp;-&nbsp; the Servlet context path, e.g. /mycorp</p></li><li class="listitem"><p>format &nbsp;-&nbsp; the
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/Format.html" target="_blank">Format</a>
        object for formatting the display of objects.
        </p></li><li class="listitem"><p>headElements &nbsp;-&nbsp; the HEAD <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/Element.html" target="_blank">elements</a>,
        excluding JavaScript, to include in the page header. Please see
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/PageImports.html" target="_blank">PageImports</a>
        for more details.
        </p></li><li class="listitem"><p>jsElements &nbsp;-&nbsp; the JavaScript imports and script blocks to
        include in the pages footer. Please see
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/PageImports.html" target="_blank">PageImports</a>
        for more details.
        </p></li><li class="listitem"><p>messages &nbsp;-&nbsp; the
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/MessagesMap.html" target="_blank">MessagesMap</a>
        adaptor for the Page
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getMessage(java.lang.String)" target="_blank">getMessage()</a>
        method
        </p></li><li class="listitem"><p>path &nbsp;-&nbsp; the
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#path" target="_blank">path</a> of
        the page template to render
        </p></li><li class="listitem"><p>request &nbsp;-&nbsp; the pages
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletRequest.html" target="_blank">HttpServletRequest</a>
        object
        </p></li><li class="listitem"><p>response &nbsp;-&nbsp; the pages
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletResponse.html" target="_blank">HttpServletResponse</a>
        object
        </p></li><li class="listitem"><p>session &nbsp;-&nbsp; the
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/SessionMap.html" target="_blank">SessionMap</a>
        adaptor for the users
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpSession.html" target="_blank">HttpSession</a>
        </p></li></ul></div><p>It then merges the template with the page model and writes out results
    to the HttpServletResponse. When the model is being merged with the template,
    any Controls in the model may be rendered using their
    <code class="methodname">toString()</code> method.
    </p><p>The final step in this sequence is invoking each control's
    <code class="methodname">onDestroy()</code> method and lastly invoke the Page's
    <code class="methodname">onDestroy()</code> method. This method can be used to
    clean up resource associated with the Control or Page before it is garbage
    collected. The <code class="methodname">onDestroy()</code> method is guaranteed to
    be called even if an exception occurs in the previous steps.
    </p><p>The execution sequence for POST requests is almost identical, except
    the <code class="methodname">onPost()</code> method is invoked instead on
    <code class="methodname">onGet()</code>. See the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../../images/post-sequence-diagram.png" target="_blank">POST Request Sequence Diagram</a>.
    </p><p>Another view on the execution flow of Pages is illustrated in the
    Activity diagram below.
    </p><div class="figure"><a name="activity-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/pages/activity-diagram-small.png" alt="Page Execution Activity Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;2.3.&nbsp;Page Execution Activity Diagram
      </i></p></div><br class="figure-break"></div><div class="sect1" title="2.3.&nbsp;Request Parameter Auto Binding"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="request-param-auto-binding"></a>2.3.&nbsp;Request Parameter Auto Binding</h2></div></div></div><p>Click will automatically bind any request parameter values to public
    Page variable with the same name. You can also use the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/Bindable.html" target="_blank">Bindable</a>
    annotation to bind private and protected Page variables. When binding these
    values Click will also attempt to convert them to the correct type.
    </p><p>The best way to understand this is to walk through an example. Our
    application receives a GET request:
    </p><div class="literallayout"><p>http://localhost:8080/mycorp/customer-details.htm?<code class="varname">customerId</code>=<span class="symbol">7203</span></p></div><p>This request is automatically handled by our
    <code class="classname">CustomerDetails</code> page:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> com.mycorp.page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerDetails <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pun">@Bindable</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Integer <code class="varname">customerId</code>;
}</pre><p>After the CustomerDetails page has been created the
    "<code class="varname">customerId</code>" request parameter value "<span class="symbol">7023</span>"
    will be converted into an Integer and assigned to the public page variable
    <code class="varname">customerId</code>.
    </p><p>Another feature of Click is that any public Page variables are
    automatically added to the page's model before it is rendered. This will
    make these values available in the page template for display. In our example
    the public <code class="varname">customerId</code> variable will be added to the Page
    model and will be available for rendering in the page template.
    </p><p>Our customer-details.htm page template contains:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

  Customer ID: <span class="symbol">$</span><code class="varname">customerId</code>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>After processing the request our page would be rendered as:
    </p><div class="literallayout"><p>Customer&nbsp;ID:&nbsp;7203</p></div><div class="sect2" title="2.3.1.&nbsp;Customizing Auto Binding"><div class="titlepage"><div><div><h3 class="title"><a name="customizing-auto-binding"></a>2.3.1.&nbsp;Customizing Auto Binding</h3></div></div></div><p>Auto binding supports the conversion of request string parameters
      into the Java classes: Integer, Double, Boolean, Byte, Character, Short,
      Long, Float, BigInteger, BigDecimal, String and the various Date classes.
      </p><p>By default type conversion is performed by the
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/RequestTypeConverter.html" target="_blank">RequestTypeConverter</a>
      class which is used by the ClickServlet method
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ClickServlet.html#getTypeConverter()" target="_blank">getTypeConverter()</a>.
      </p><p>If you need to add support for additional types, you would write your
      own type converter class and specify it as a ClickServlet init parameter.
      </p><p>For example if you wanted to automatically load a
      <code class="classname">Customer</code> object from the database when a customer
      id request parameter is specified, you could write your own type converter:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomTypeConverter <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> RequestTypeConverter {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> CustomerService customerService = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> CustomerService();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see RequestTypeConverter#convertValue(Object, Class)
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Object convertValue(Object value, Class toType) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (toType == Customer.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> customerService.getCustomerForId(value);

        } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">else</span> {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>.convertValue(value, toType);
        }
    }
}</pre><p>This type converter would handle the following request:
      </p><div class="literallayout"><p>http://localhost:8080/mycorp/customer-details.htm?<code class="varname">customer</code>=<span class="symbol">7203</span></p></div><p>This request will load the <code class="varname">customer</code> object from
      the database using "<span class="symbol">7203</span>" as the customer id value. The
      ClickServlet would then assign this <code class="varname">customer</code> object to
      the matching page variable:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> com.mycorp.page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerDetails <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pun">@Bindable</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Customer <code class="varname">customer</code>;

}</pre><p>To make your custom type converter available you will need to
      add an init parameter to ClickServlet in <code class="filename">web.xml</code>. For example:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-app&gt;</span>
  ...
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-class&gt;</span>org.apache.click.ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-class&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;init-param&gt;</span>
       <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;param-name&gt;</span>type-converter-class<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/param-name&gt;</span>
       <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;param-value&gt;</span>com.mycorp.util.CustomTypeConverter<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/param-value&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/init-param&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;load-on-startup&gt;</span>0<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/load-on-startup&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-mapping&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span>*.htm<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-mapping&gt;</span>
  ...
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-app&gt;</span></pre></div></div><div class="sect1" title="2.4.&nbsp;Security"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-security"></a>2.4.&nbsp;Security</h2></div></div></div><p>Pages provide an
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onSecurityCheck()" target="_blank">onSecurityCheck</a>
    event handler which application pages can override to implement a
    programmatic security model.
    </p><p>Please note you generally don't need to use this capability, and where
    possible you should use the declarative JEE security model. See the Best
    Practices <a class="link" href="#security" title="6.1.&nbsp;Security">Security</a> topic for more details.
    </p><div class="sect2" title="2.4.1.&nbsp;Application Authentication"><div class="titlepage"><div><div><h3 class="title"><a name="applications-authentication"></a>2.4.1.&nbsp;Application Authentication</h3></div></div></div><p>Applications can use the <code class="methodname">onSecurityCheck()</code>
      method to implement their own security model. The example class below
      provides a base Secure page class which other pages can extend to ensure
      the user is logged in. In this example the login page creates a session
      when a user successfully authenticates. This Secure page then checks to
      make sure the user has a session, otherwise the request is redirected to
      the login page.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Secure <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onSecurityCheck()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onSecurityCheck() {

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (getContext().hasSession()) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;

        } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">else</span> {
            setRedirect(LoginPage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
        }
    }
}</pre></div><div class="sect2" title="2.4.2.&nbsp;Container Authentication"><div class="titlepage"><div><div><h3 class="title"><a name="container-authentication"></a>2.4.2.&nbsp;Container Authentication</h3></div></div></div><p>Alternatively you can also use the security services provided by
      the JEE Servlet Container. For instance to ensure users have been
      authenticated by the Serlvet Container you could use a Secure page of:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Secure <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onSecurityCheck()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onSecurityCheck() {

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (getContext().getRequest().<a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletRequest.html#getRemoteUser()" target="_blank"><code class="varname">getRemoteUser</code></a>() != null) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;

        } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">else</span> {
            setRedirect(LoginPage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
        }
    }
}</pre></div><div class="sect2" title="2.4.3.&nbsp;Container Access Control"><div class="titlepage"><div><div><h3 class="title"><a name="container-access-control"></a>2.4.3.&nbsp;Container Access Control</h3></div></div></div><p>The Servlet Container also provides facilities to enforce role
      based access control (authorization). The example below is a base page
      to ensure only users in the "admin" role can access the page, otherwise
      users are redirected to the login page. Application Admin pages would
      extend this secure page to provide their functionality.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> AdminPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onSecurityCheck()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onSecurityCheck() {

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (getContext().getRequest().<a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletRequest.html#isUserInRole(java.lang.String)" target="_blank"><code class="varname">isUserInRole</code></a>(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"admin"</span>)) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;

        } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">else</span> {
            setRedirect(LoginPage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
        }
    }
}</pre></div><div class="sect2" title="2.4.4.&nbsp;Logging Out"><div class="titlepage"><div><div><h3 class="title"><a name="logging-out"></a>2.4.4.&nbsp;Logging Out</h3></div></div></div><p>To logout using the application or container based security models
      you would simply invalidate the session.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Logout <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onInit()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        getContext().getSession().<a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpSession.html#invalidate()" target="_blank"><code class="varname">invalidate</code></a>();
    }
}</pre></div></div><div class="sect1" title="2.5.&nbsp;Page Navigation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-navigation"></a>2.5.&nbsp;Page Navigation</h2></div></div></div><p> Navigation between pages is achieved by using forwards, redirects
    and by setting the page template path.
    </p><div class="sect2" title="2.5.1.&nbsp;Forward"><div class="titlepage"><div><div><h3 class="title"><a name="forward"></a>2.5.1.&nbsp;Forward</h3></div></div></div><p> To forward to another page using the servlet
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/RequestDispatcher.html" target="_blank">RequestDispatcher</a>,
      set the Page's forward property. For example to forward to a page with a
      path <code class="varname">index.htm</code>:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
 * @see Page#onPost()
 */</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onPost() {
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Process form post</span>
    ..

    setForward(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"index.htm"</span>);
}</pre><p>This will invoke a new Page class instance mapped to the path
      <code class="varname">index.htm</code>.
      </p><p><span class="bold"><strong>Please note</strong></span> when a request is
      forwarded to another Page, the controls on the second page will not be
      processed. This prevents confusion and bugs, like a form on the second page
      trying to process a POST request from the first page.
      </p><div class="sect3" title="2.5.1.1.&nbsp;Forward Parameter Passing"><div class="titlepage"><div><div><h4 class="title"><a name="forward-parameter-passing"></a>2.5.1.1.&nbsp;Forward Parameter Passing</h4></div></div></div><p>When you forward to another page the request parameters are
        maintained. This is a handy way of passing through state information
        with the request. For example you could add a customer object as a
        request parameter which is displayed in the template of the forwarded
        page.
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onViewClick() {
    Long id = viewLink.getValueLong();
    Customer customer = CustomerDAO.findByPK(id);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Set the customer object as a request parameter</span>
    getContext().setRequestAttribute(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"customer"</span>, customer);
    setForward(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"view-customer.htm"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><p>The snippet above forwards to the page template
        <code class="varname">view-customer.htm</code>:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;title&gt;</span>Customer Details<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/title&gt;</span>
 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;h1&gt;</span>Customer Details<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/h1&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pre&gt;</span>
     Full Name: <code class="varname">$customer.fullName</code>
     Email:     <code class="varname">$customer.email</code>
     Telephone: <code class="varname">$customer.telephone</code>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pre&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>Request attributes are automatically added to the Velocity Context
    object so are available in the page template.
        </p></div><div class="sect3" title="2.5.1.2.&nbsp;Page Forwarding"><div class="titlepage"><div><div><h4 class="title"><a name="page-forwarding"></a>2.5.1.2.&nbsp;Page Forwarding</h4></div></div></div><p>Page forwarding is another way of passing information between
        pages. In this case you create the page to be forwarded to using the
        Context <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Context.html#createPage(java.lang.String)" target="_blank">createPage(String)</a>
        method and then set properties directly on the Page. Finally set this
        page as the page to forward the request to. For example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onEditClick() {
    Long id = viewLink.getValueLong();
    Customer customer = CustomerDAO.findByPK(id);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a new EditPage instance based on the specified path</span>
    EditPage editPage = (EditPage) getContext().createPage(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/edit-customer.htm"</span>);
    editPage.setCustomer(customer);
    setForward(editPage);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><p>When creating a page with the <code class="methodname">createPage()</code>
        method, ensure you prefix the page path with the <code class="varname">"/"</code>
        character.
        </p><p>You can also specify the target page using its class as long as
        the Page has a unique path. Using this technique the above code becomes:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onEditClick() {
    Long id = viewLink.getValueLong();
    Customer customer = CustomerDAO.findByPK(id);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a new EditPage instance based on its class</span>
    EditPage editPage = (EditPage) getContext().createPage(EditPage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
    editPage.setCustomer(customer);
    setForward(editPage);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><p>This Page forwarding technique is best practice as it provides you
        with compile time safety and alleviates you from having to specify page
        paths in your code. Please always use the Context
        <code class="methodname">createPage()</code> methods to allow Click to inject
        Page dependencies.
        </p><p>Although uncommon it is possible to map more than one path to the
        same class. In these cases invoking Context
        <code class="methodname">createPage(Class)</code> will throw an exception, because
        Click will not be able to determine which path to use for the Page.
        </p></div></div><div class="sect2" title="2.5.2.&nbsp;Template Path"><div class="titlepage"><div><div><h3 class="title"><a name="template-path"></a>2.5.2.&nbsp;Template Path</h3></div></div></div><p>An alternative method of forwarding to a new page is to simply set
      the current Page's path to the new page template to render. With this
      approach the page template being rendered must have everything it needs
      without having its associated Page object created. Our modified example
      would be:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onViewClick() {
    Long id = viewLink.getValueLong();
    Customer customer = CustomerDAO.findByPK(id);

    addModel(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"customer"</span>, customer);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Set the Page's path to a new value</span>
    setPath(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"view-customer.htm"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><p>Note how the <code class="varname">customer</code> object is passed through to
      the template in the Page model. This approach of using the Page model is
      not available when you forward to another Page, as the first Page object is
      "<a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#onDestroy()" target="_blank">destroyed</a>"
      before the second Page object is created and any model values would be lost.
      </p></div><div class="sect2" title="2.5.3.&nbsp;Redirect"><div class="titlepage"><div><div><h3 class="title"><a name="redirect"></a>2.5.3.&nbsp;Redirect</h3></div></div></div><p>Redirects are another very useful way to navigate between pages.
      See HttpServletResponse.
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletResponse.html#sendRedirect(java.lang.String)" target="_blank">sendRedirect</a>
      (location) for details.
      </p><p>The great thing about redirects are that they provide a clean URL in
      the users browser which matches the page that they are viewing. This is
      important for when users want to bookmark a page. The downside of
      redirects are that they involve a communications round trip with the users
      browser which requests the new page. Not only does this take time, it also
      means that all the page and request information is lost.
      </p><p>An example of a redirect to a <code class="varname">logout.htm</code> page is
      provided below:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onLogoutClick() {
    setRedirect(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/logout.htm"</span>);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><p>If the redirect location begins with a <span class="symbol">"/"</span> character
      the redirect location will be prefixed with the web applications context
      path. For example if an application is deployed to the context
      <code class="varname">"mycorp"</code> calling
      <code class="methodname">setRedirect(<code class="varname">"/customer/details.htm"</code>)</code>
      will redirect the request to: <code class="varname">"/mycorp/customer/details.htm"</code>.
      </p><p>You can also obtain the redirect path via the target Page's class.
      For example:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onLogoutClick() {
    String path = getContext().getPagePath(Logout.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
    setRedirect(path);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><p>Note when using this redirect method, the target Page class must have
      a unique path.
      </p><p>A short hand way of redirecting is to simply specify the target Page
      class in the redirect method. For example:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onLogoutClick() {
    setRedirect(Logout.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre><div class="sect3" title="2.5.3.1.&nbsp;Redirect Parameter Passing"><div class="titlepage"><div><div><h4 class="title"><a name="redirect-parameter-passing"></a>2.5.3.1.&nbsp;Redirect Parameter Passing</h4></div></div></div><p>You can pass information between redirected pages using URL
        request parameters. The ClickServlet will encode the URL for you using
        HttpServletResponse.<a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletResponse.html#encodeRedirectURL(java.lang.String)" target="_blank">encodeRedirectURL</a>
        (url).
        </p><p>In the example below a user will click on an OK button to confirm
        a payment. The <code class="methodname">onOkClick()</code> button handler
        processes the payment, gets the payment transaction id, and then
        redirects to the <code class="varname">trans-complete.htm</code> page with the
        transaction id encoded in the URL.
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Payment <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {
    ..

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onOkClick() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (form.isValid()) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Process payment</span>
            ..

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Get transaction id</span>
            Long transId = OrderDAO.purchase(order);

            setRedirect(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"trans-complete.htm?transId="</span> + transId);

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }
}</pre><p>The Page class for the trans-complete.htm page can then get the
        transaction id through the request parameter <code class="varname">"transId"</code>:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> TransComplete <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#onInit()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        String transId = getContext().getRequest().getParameter(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"transId"</span>);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (transId != null) {

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Get order details</span>
            Order order = OrderDAO.findOrderByPK(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Long(transId));
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (order != null) {
                addModel(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"order"</span>, order);
            }
        }
    }
}</pre></div><div class="sect3" title="2.5.3.2.&nbsp;Post Redirect"><div class="titlepage"><div><div><h4 class="title"><a name="post-redirect"></a>2.5.3.2.&nbsp;Post Redirect</h4></div></div></div><p>The parameter passing example above is also an example of a Post
        Redirect. The Post Redirect technique is a very useful method of
        preventing users from submitting a form twice by hitting the refresh
        button.
        </p></div></div></div><div class="sect1" title="2.6.&nbsp;Page Templating"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-templating"></a>2.6.&nbsp;Page Templating</h2></div></div></div><p>Click supports page templating (a.k.a. <span class="emphasis"><em>Tiles</em></span> in
    Struts) enabling you to create a standardized look and feel for your web
    application and greatly reducing the amount of HTML you need to maintain.
    </p><p>To implement templating define a border template base Page which
    content Pages should extend. The template base Page class overrides the Page
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getTemplate()" target="_blank">getTemplate()</a>
    method, returning the path of the border template to render. For example:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> com.mycorp.page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> BorderedPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#getTemplate()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTemplate() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/border.htm"</span>;
    }
}</pre><p>The BorderedPage template <code class="varname">border.htm</code>:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;title&gt;</span><code class="varname">$title</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/title&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"style.css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">title</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Style"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;h2</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">class</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"title"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span><code class="varname">$title</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/h2&gt;</span>

    <span class="command"><strong>#parse</strong></span>(<code class="varname">$path</code>)

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span>
    </pre><p>Other pages insert their content into this template using the Velocity
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../velocity/vtl-reference-guide.html#parse" target="_blank">#parse</a>
    directive, passing it their contents pages
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#path" target="_blank">path</a>. The
    <code class="varname">$path</code> value is automatically added to the VelocityContext
    by the ClickServlet.
    </p><p>An example bordered Home page is provided below:
    </p><div class="literallayout"><p>&lt;page&nbsp;path="<code class="varname">home.htm</code>"&nbsp;classname="<span class="token">com.mycorp.page.Home</span>"/&gt;</p></div><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> com.mycorp.page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Home <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> BorderedPage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String title = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Home"</span>;

}</pre><p>The Home page's content <code class="varname">home.htm</code>:
    </p><div class="literallayout"><p>&lt;b&gt;Welcome&lt;/b&gt;&nbsp;to&nbsp;Home&nbsp;page&nbsp;your&nbsp;starting&nbsp;point&nbsp;for&nbsp;the&nbsp;application.</p></div><p>When a request is made for the Home page (home.htm) Velocity will
    merge the <code class="varname">border.htm</code> page and <code class="varname">home.htm</code>
    page together returning:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;title&gt;</span>Home<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/title&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"style.css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">title</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Style"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;h2</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">class</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"title"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Home<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/h2&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;b&gt;</span>Welcome<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/b&gt;</span> to Home page your application starting point.

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>Which may be rendered as:
    </p><div class="figure"><a name="home-page-screenshot"></a><div class="figure-contents"><div class="mediaobject"><img src="images/pages/home-page-screenshot.png" alt="Home Page"></div></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;2.4.&nbsp;Home Page</i></p></div><br class="figure-break"><p>Note how the Home page class defines a <code class="varname">title</code> model
    value which is referenced in the <code class="varname">border.htm</code> template as
    <code class="varname">$title</code>. Each bordered page can define their own title
    which is rendered in this template.
    </p><p>Templating with JSP pages is also supported using the same pattern.
    Please see the Click Examples application for a demonstration.
    </p></div><div class="sect1" title="2.7.&nbsp;Page Actions"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-actions"></a>2.7.&nbsp;Page Actions</h2></div></div></div><p>Page Action is a feature to directly invoke a <code class="literal">Page method</code>
    from the browser. The Page Action method returns an
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html" target="_blank">ActionResult</a>
    object that is rendered directly to the browser. In other words the Page template will
    not be rendered.
    </p><p>To invoke a Page Action, specify the parameter <code class="varname">"pageAction"</code>
    and the name of the page method, for example: <span class="symbol">"onRenderImage"</span>.
    </p><p>Let's take a quick look at how a Page Action can be leveraged to retrieve
    an image. In this example we'll create an HTML <code class="literal">&lt;img&gt;</code>
    element which <code class="literal">src</code> attribute specifies the Page Action
    that will return the image data.
    </p><p>First we create our template:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;img</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">src</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"$context/mycorp/image.htm?</span><code class="varname">pageAction</code>=<span class="symbol">onRenderImage</span>"/&gt;
</pre><p>Next we create our ImagePage with a Page Action method called
    <span class="symbol">onRenderImage</span> that returns an <span class="token">ActionResult</span>
    instance:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ImagePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span class="token">ActionResult</span> <span class="symbol">onRenderImage()</span> {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">byte</span>[] imageData = getImageAsBytes();
        String contentType = ClickUtils.getMimeType(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"png"</span>);
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> <span class="token">ActionResult</span>(imageData, contentType);
    }
} </pre><p>A Page Action is a normal Page method with the following signature:
    a <span class="symbol">public no-arg</span> method returning an <span class="token">ActionResult</span>
    instance:
    </p><pre class="programlisting">
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// The Page Action method is public, doesn't accept any arguments and returns an ActionResult</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span class="token">ActionResult</span> <span class="symbol">onRenderImage()</span> {
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">byte</span>[] imageData = getImageAsBytes();
    String contentType = ClickUtils.getMimeType(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"png"</span>);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> <span class="token">ActionResult</span>(imageData, contentType);
} </pre><p>The <span class="token">ActionResult</span> contains the data that is rendered to
    the client browser. In the example above, the result will the Image byte array
    with a Content-Type of: <code class="literal">"images/png"</code>.
    </p><div class="sect2" title="2.7.1.&nbsp;Page Action Execution"><div class="titlepage"><div><div><h3 class="title"><a name="page-action-execution"></a>2.7.1.&nbsp;Page Action Execution</h3></div></div></div><p>Page Actions are page methods that handle the processing of a user
        request and render a result to the browser. The execution sequence for a
        Page Action being processed and rendered is illustrated in the figure below.
        </p><div class="figure"><a name="page-action-sequence-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/pages/page-action-sequence-diagram.png" alt="Page Action Request Sequence Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;2.5.&nbsp;Page Action Request Sequence Diagram
          </i></p></div><br class="figure-break"><p>Stepping through this Page Action request sequence, a new Page instance
        is created and the attributes for the Page are set (format, headers). Next,
        request parameter values are bound to matching Page fields.
        </p><p>Then the <code class="methodname">onSecurityCheck()</code> handler is executed.
        This method can be used to ensure the user is authorized to access the Page Action,
        and if necessary abort any further processing. If
        <code class="methodname">onSecurityCheck()</code> return false, no response is
        sent back to the client. Note, if you want to send a specific response to
        the client you have to do that from the
        <code class="methodname">onSecurityCheck()</code> event, since other Page events
        are not executed. Please see
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/ajax/ajax-secure.htm" target="_blank">this</a>
        example for some strategies on implementing
        <code class="methodname">onSecurityCheck</code>  to handle ajax requests.
            </p><p>Next the target <code class="methodname">page method</code> is invoked
        which returns an <code class="classname">ActionResult</code> that is rendered to
        the client.</p><p>If the page method returns <code class="literal">null</code> no response is
        rendered to the browser.
        </p></div><div class="sect2" title="2.7.2.&nbsp;ActionResult"><div class="titlepage"><div><div><h3 class="title"><a name="page-action-result"></a>2.7.2.&nbsp;ActionResult</h3></div></div></div><p>An ActionResult represents the content returned by a Page Action
        which is then rendered to the client browser. ActionResults normally
        contains HTML or image data that is rendered to the browser. When a Page
        Action is invoked the Page template rendering is bypassed and only the
        ActionResult content is rendered to the browser. This allows a Page Action
        to return a "partial" response, as opposed to a "full" response, because
        the Page template (which can be viewed as a "full" response) is bypassed
        when invoking a Page Action.
        </p></div><div class="sect2" title="2.7.3.&nbsp;Page Action Example"><div class="titlepage"><div><div><h3 class="title"><a name="page-action-example"></a>2.7.3.&nbsp;Page Action Example</h3></div></div></div><p>Let's step through a Page Action example. First we create an ImagePage
        class with the method "getImageData" which is the Page Action we want to invoke:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ImagePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionResult getImageData() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">byte</span>[] imageData = loadImageData();
        String contentType = ClickUtils.getContentType(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"png"</span>);
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionResult(imageData, contentType);
    }
} </pre><p>Next we have the page template image.htm:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;img</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">src</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"/mycorp/image.htm?</span><code class="varname">pageAction</code>=<span class="symbol">getImageData</span>"/&gt;

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span> </pre><p>The browser renders the <code class="literal">&lt;img&gt;</code> element and
      requests the image src url. Click invokes the page method <span class="symbol">getImageData</span>
      and renders the result to the browser.
      </p><p>Looking at the output log we see the following trace:
      </p><div class="literallayout"><p>[Click]&nbsp;[info&nbsp;]&nbsp;handleRequest:&nbsp;&nbsp;/image.htm&nbsp;-&nbsp;84&nbsp;ms<br>
[Click]&nbsp;[debug]&nbsp;GET&nbsp;http://localhost:8080/mycorp/image.htm<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;Ajax&nbsp;request:&nbsp;false<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;param:&nbsp;pageAction=getImageData<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;ImagePage.&lt;&lt;init&gt;&gt;<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;ImagePage.onSecurityCheck()&nbsp;:&nbsp;true<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;ImagePage.getImageData()&nbsp;:&nbsp;ActionResult<br>
[Click]&nbsp;[info&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;renderActionResult&nbsp;(image/png)&nbsp;-&nbsp;0&nbsp;ms<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;ImagePage.onDestroy()<br>
[Click]&nbsp;[info&nbsp;]&nbsp;handleRequest:&nbsp;&nbsp;/image.htm&nbsp;-&nbsp;98&nbsp;ms</p></div></div><div class="sect2" title="2.7.4.&nbsp;Accessing Request Parameters"><div class="titlepage"><div><div><h3 class="title"><a name="page-action-accessing-request-parameters"></a>2.7.4.&nbsp;Accessing Request Parameters</h3></div></div></div><p>Request parameters can be accessed through the <code class="classname">Context</code>
        as shown below:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ImagePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionResult getImageData() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Retrieve a request parameter through the Context</span>
        Context context = getContext();
        String imageName = context.getRequestParameter(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"imageName"</span>);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">byte</span>[] imageData = loadImageData(imageName);
        String contentType = ClickUtils.getContentType(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"png"</span>);
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionResult(imageData, contentType);
    }
} </pre></div><div class="sect2" title="2.7.5.&nbsp;Set response headers and status code"><div class="titlepage"><div><div><h3 class="title"><a name="page-action-set-response-headers"></a>2.7.5.&nbsp;Set response headers and status code</h3></div></div></div><p>When handling a Page Action you might need to set the HTTP response
      headers or status code. You do this through the Servlet API's,
      <code class="classname">HttpServetlResponse</code> which can be accessed
      through the <code class="classname">Context</code>.
      </p><p>For example:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> examples.page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">import</span> java.util.Date;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">import</span> org.apache.click.Page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ImagePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionResult getImageData() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Headers and Status code are set on the HttpServletResponse</span>
        HttpServletResponse response = getContext().getResponse();

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// The headers can be set as follows:</span>
        response.setHeader(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Content-Disposition"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"attachment; filename=\"report.xls\""</span>);

        ...

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// The response status can be set as follows:</span>
        response.setStatus(HttpServletResponse.SC_NOT_MODIFIED);

        ...
    }
} </pre></div></div><div class="sect1" title="2.8.&nbsp;Direct Rendering"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-direct-rendering"></a>2.8.&nbsp;Direct Rendering</h2></div></div></div><p>Pages support a direct rendering mode where you can render directly
    to the servlet response and bypass the page template rendering. This is
    useful for scenarios where you want to render non HTML content to the
    response, such as a PDF or Excel document. To do this:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> get the servlet response object</p></li><li class="listitem"><p> set the content type on the response</p></li><li class="listitem"><p> get the response output stream</p></li><li class="listitem"><p> write to the output stream</p></li><li class="listitem"><p> close the output stream</p></li><li class="listitem"><p> set the page path to null to inform the ClickServlet that
        rendering has been completed</p></li></ul></div><p>A direct rendering example is provided below.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
 * Render the Java source file as "text/plain".
 *
 * @see Page#onGet()
 */</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onGet() {
    String filename = ..

    HttpServletResponse response = getContext().getResponse();

    response.setContentType(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"text/plain"</span>);
    response.setHeader(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Pragma"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"no-cache"</span>);

    ServletContext context = getContext().getServletContext();

    InputStream inputStream = null;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">try</span> {
        inputStream = context.getResourceAsStream(filename);

        PrintWriter writer = response.getWriter();

        BufferedReader reader = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> BufferedReader(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> InputStreamReader(inputStream));

        String line = reader.readLine();

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">while</span> (line != null) {
            writer.println(line);
            line = reader.readLine();
        }

        setPath(null);

    } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">catch</span> (IOException ioe) {
        ioe.printStackTrace();

    } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">finally</span> {
        ClickUtils.close(inputStream);
    }
}</pre></div><div class="sect1" title="2.9.&nbsp;Stateful Pages"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="stateful-pages"></a>2.9.&nbsp;Stateful Pages</h2></div></div></div><p><span class="symbol">PLEASE NOTE:</span> stateful pages have been deprecated in
    Click 2.3.0 and will be removed in a future release. Do not use stateful pages
    in your applications. Instead use stateful controls or HttpSession to store
    state between requests.
    </p><p>Click supports stateful pages where the state of the page is saved
    between the users requests. Stateful pages are useful in a number of
    scenarios including:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Search page and edit page interactions. In this scenario you
        navigage from a stateful search page which may have filter criteria
        applied to an object edit page. Once object update has been completed
        on the edit page, the user is redirected to the search page and the
        stateful filter criteria still applies.
        </p></li><li class="listitem"><p>Complex pages with multiple forms and or tables which need to
        maintain their state between interactions.
        </p></li></ul></div><p>To make a page stateful you simply need to set the page
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#stateful" target="_blank">stateful</a>
    property to true, have the page implement the <code class="classname">Serializable</code>
    interface and set the <code class="literal">serialVersionUID</code> indicator.
    For example:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> com.mycorp.page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">import</span> java.io.Serializable;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">import</span> org.apache.click.Page;

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> SearchPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">implements</span> Serializable {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">static</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">final</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">long</span> serialVersionUID = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="lit">1L</span>;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> SearchPage() {
        setStateful(true);
        ..
    }
}</pre><p>Stateful page instances are stored in the user's
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpSession.html" target="_blank">HttpSession</a>
    using the pages class name as the key. In the example above the page would
    be stored in the users session using the class name:
    <code class="classname">com.mycorp.page.SearchPage</code>
    </p><div class="sect2" title="2.9.1.&nbsp;Page Creation"><div class="titlepage"><div><div><h3 class="title"><a name="page-creation"></a>2.9.1.&nbsp;Page Creation</h3></div></div></div><p>With stateful pages they are only created once, after which they
      are retrieved from the session. However page event handlers are invoked
      for each request, including the <code class="methodname">onInit()</code> method.
      </p><p>When you are creating stateful pages you typically place all your
      control creation code in the Pages constructor so it is invoked only once.
      It is important not to place control creation code in the
      <code class="methodname">onInit()</code> method which will be invoked with each
      request.
      </p><p>If you have dynamic control creation code you would typically place
      this in the <code class="methodname">onInit()</code> method, but you will need to
      take care that controls and or models are not already present in the page.
      </p></div><div class="sect2" title="2.9.2.&nbsp;Page Execution"><div class="titlepage"><div><div><h3 class="title"><a name="page-execution"></a>2.9.2.&nbsp;Page Execution</h3></div></div></div><p>The default Click page execution model is thread safe as a new
      Page instance is created for each request and thread. With stateful
      pages a user will have a single page instance which is reused in multiple
      requests and threads. To ensure page execution is thread safe, users page
      instances are synchronized so only one request thread can execute a page
      instance at any one time.
      </p></div><div class="sect2" title="2.9.3.&nbsp;Page Destruction"><div class="titlepage"><div><div><h3 class="title"><a name="page-destruction"></a>2.9.3.&nbsp;Page Destruction</h3></div></div></div><p>After normal page instances have been executed, they are
      de-referenced and garbage collected by the JVM. However with stateful
      pages they are stored in the users <code class="classname">HttpSession</code> so
      care needs to be take not to store too many objects in stateful page
      instances which may cause memory and performance issues.
      </p><p>When pages have completed their execution, all the Page's controls
      <code class="methodname">onDestroy()</code> methods are invoked, and then the
      Page's <code class="methodname">onDestroy()</code> method is invoked. This is
      your opportunity to de-reference any large sets or graphs. For example the
      Table control by default de-references its rowList in its
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Table.html#onDestroy()" target="_blank">onDestory()</a>
      method.
      </p></div></div><div class="sect1" title="2.10.&nbsp;Error Handling"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-error-handling"></a>2.10.&nbsp;Error Handling</h2></div></div></div><p>If an Exception occurs processing a Page object or rendering a
    template the error is delegated to the registered handler. The default
    Click error handler is the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/ErrorPage.html" target="_blank">ErrorPage</a>,
    which is automatically configured as:
    </p><div class="literallayout"><p>&lt;page&nbsp;path="<code class="varname">click/error.htm</code>"&nbsp;classname="<span class="symbol">org.apache.click.util.ErrorPage</span>"/&gt;</p></div><p>To register an alternative error handler you must subclass ErrorPage
    and define your page using the path <code class="varname">"click/error.htm"</code>.
    For example:
    </p><div class="literallayout"><p>&lt;page&nbsp;path="<code class="varname">click/error.htm</code>"&nbsp;classname="<span class="symbol">com.mycorp.page.ErrorPage</span>"/&gt;</p></div><p>When the ClickServlet starts up it checks to see whether the
    <code class="varname">error.htm</code> template exists in the <code class="varname">click</code>
    web sub directory. If it cannot find the page the ClickServlet will
    automatically deploy one. You can tailor the <code class="varname">click/error.htm</code>
    template to suite you own tastes, and the ClickServlet will
    not overwrite it.
    </p><p>The default error template will display extensive debug information
    when the application is in <code class="literal">development</code> or
    <code class="literal">debug</code> mode. Example error page displays include:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../error-npe.html" target="_blank">NullPointerException</a> - in a page
          method
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../error-parsing.html" target="_blank">ParseErrorException</a> - in a
          page template
        </p></li></ul></div><p>When the application is in <code class="literal">production</code> mode only
    a simple error message is displayed. See
    <a class="link" href="#application-mode" title="5.2.6.&nbsp;Mode">Configuration</a> for details on how to
    set the application mode.
    </p><p>Please also see the <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../examples.html" target="_blank">Examples</a> web
    app Exception Demo for demonstrations of Clicks error handling.
    </p></div><div class="sect1" title="2.11.&nbsp;Page Not Found"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-not-found"></a>2.11.&nbsp;Page Not Found</h2></div></div></div><p>If the ClickServlet cannot find a requested page in the
    <code class="literal">click.xml</code> config file it will use the registered
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../not-found.html" target="_blank">not-found.htm</a> page.
    </p><p>The Click <code class="literal">not found page</code> is automatically configured
    as:
    </p><div class="literallayout"><p>&lt;page&nbsp;path="<code class="varname">click/not-found.htm</code>"&nbsp;classname="<span class="symbol">org.apache.click.Page</span>"/&gt;</p></div><p>You can override the default configuration and specify your own class,
    but you cannot change the path.
    </p><p>When the ClickServlet starts up it checks to see whether the
    <code class="varname">not-found.htm</code> template exists in the <code class="varname">click</code>
    web sub directory. If it cannot find the page the ClickServlet will
    automatically deploy one.
    </p><p>You can tailor the <code class="varname">click/not-found.htm</code> template to
    suite you own needs. This page template has access to the usual Click objects.
    </p></div><div class="sect1" title="2.12.&nbsp;Page Message Properties"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-message-properties"></a>2.12.&nbsp;Page Message Properties</h2></div></div></div><p>The Page class provides a
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#messages" target="_blank">messages</a>
    property which is a
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/MessagesMap.html" target="_blank">MessagesMap</a>
    of localized messages for the page. These messages are made available in the
    VelocityContext when the page is rendered under the key
    <code class="literal">messages</code>. So for example if you had a page title message
    you would access it in your page template as:
    </p><div class="literallayout"><p>&lt;h1&gt;&nbsp;<span class="symbol">$</span><code class="varname">messages.title</code>&nbsp;&lt;/h1&gt;</p></div><p>This messages map is loaded from the page class property bundle. For
    example if you had a page class <code class="classname">com.mycorp.page.CustomerList</code>
    you could have an associated property file containing the pages localized
    messages:
    </p><div class="literallayout"><p>/com/mycorp/page/CustomerList.properties</p></div><p>You can also defined a application global page messages properties file:
    </p><div class="literallayout"><p>/click-page.properties</p></div><p>Messages defined in this file will be available to all pages throughout
    your application. Note messages defined in your page class properties file
    will override any messages defined in the application global page properties
    file.
    </p><p>Page messages can also be used to override Control messages, see the
    Controls <a class="link" href="#control-message-properties" title="3.4.&nbsp;Message Properties">Message Properties</a>
    topic for more details.
    </p></div><div class="sect1" title="2.13.&nbsp;Page HEAD Elements"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="page-head-elements"></a>2.13.&nbsp;Page HEAD Elements</h2></div></div></div><p>The Page class provides the method
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getHeadElements()" target="_blank">getHeadElements()</a>
    for contributing HEAD <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/Element.html" target="_blank">elements</a>
    such as <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/JsImport.html" target="_blank">JsImport</a>,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/JsScript.html" target="_blank">JsScript</a>,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/CssImport.html" target="_blank">CssImport</a>
    and <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/CssStyle.html" target="_blank">CssStyle</a>.
    </p><p>Here is an example of adding HEAD elements to the
    <code class="classname">MyPage</code> class:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> MyPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> MyPage() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the JavaScript import "/mypage.js" to the page</span>
        getHeadElements().add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> JsImport(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/mypage.js"</span>));

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add some inline JavaScript content to the page</span>
        getHeadElements().add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> JsScript(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"alert('Welcome to MyPage');"</span>));

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the Css import "/mypage.css" to the page</span>
        getHeadElements().add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> CssImport(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/mypage.css"</span>));

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add some inline Css content to the page</span>
        getHeadElements().add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> CssStyle(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"body { font-family: Verdana; }"</span>));
    }

    ...

} </pre><p>In the example above we added the HEAD elements from the Page constructor,
    however you can add HEAD elements from anywhere in the Page including the
    event handlers <code class="literal">onInit</code>, <code class="literal">onGet</code>,
    <code class="literal">onPost</code>, <code class="literal">onRender</code> etc.
    Please see <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getHeadElements()" target="_blank">getHeadElements()</a>
    for more details.
    </p><p>Below is the <code class="filename">/my-page.htm</code> template:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <code class="varname">$headElements</code>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    ...

    <code class="varname">$jsElements</code>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span> </pre><p>The two variables, <code class="varname">$headElements</code> and
    <code class="varname">$jsElements</code>, are automatically made available to the Page
    template. These variables references the JavaScript and Css HEAD elements
    specified in <code class="classname">MyPage</code>.
    </p><p>The following HTML will be rendered (assuming the application context
    is "/myapp"):
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="symbol">/myapp/mypage.css</span>"&gt;<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/link&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;style</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
      <span class="symbol">body { font-family: Verdana; }</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/style&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    ...

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;script</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/javascript"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">src</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="symbol">/myapp/mypage.js</span>"/&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;script</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/javascript"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
      <span class="symbol">alert('Welcome to MyPage');</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/script&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span> </pre><p>A live demo showing how to add HEAD elements to a Page can be seen
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/general/page-head-demo.htm" target="_blank">here</a>.
    </p></div></div><div class="chapter" title="Chapter&nbsp;3.&nbsp;Controls"><div class="titlepage"><div><div><h2 class="title"><a name="chapter-controls"></a>Chapter&nbsp;3.&nbsp;Controls</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="#control-interface">3.1. Control Interface</a></span></dt><dt><span class="sect1"><a href="#control-listener">3.2. Control Listener</a></span></dt><dt><span class="sect1"><a href="#control-class">3.3. Control Classes</a></span></dt><dt><span class="sect1"><a href="#control-message-properties">3.4. Message Properties</a></span></dt><dd><dl><dt><span class="sect2"><a href="#message-resolution">3.4.1. Message Resolution</a></span></dt><dt><span class="sect2"><a href="#control-properties">3.4.2. Control Properties</a></span></dt><dt><span class="sect2"><a href="#accessing-messages">3.4.3. Accessing Messages</a></span></dt></dl></dd><dt><span class="sect1"><a href="#control-head-elements">3.5. Control HEAD Elements</a></span></dt><dt><span class="sect1"><a href="#container">3.6. Container</a></span></dt><dd><dl><dt><span class="sect2"><a href="#abstractcontainer">3.6.1. AbstractContainer</a></span></dt><dt><span class="sect2"><a href="#abstractcontainerfield">3.6.2. AbstractContainerField</a></span></dt></dl></dd><dt><span class="sect1"><a href="#layout">3.7. Layouts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#template-layout">3.7.1. Template layout</a></span></dt><dt><span class="sect2"><a href="#programmatic-layout">3.7.2. Programmatic layout</a></span></dt></dl></dd><dt><span class="sect1"><a href="#behavior">3.8. Behavior</a></span></dt><dd><dl><dt><span class="sect2"><a href="#behavior-execution">3.8.1. Behavior Execution</a></span></dt><dt><span class="sect2"><a href="#behavior-example">3.8.2. Behavior Example</a></span></dt></dl></dd></dl></div><p>Apache Click provides a rich set of Controls which support client side
  rendering and server side processing. Please see the
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/package-summary.html" target="_blank">Javadoc</a>,
  which provides extensive information and examples of the core Controls.
  </p><p>This chapter covers Control in detail including the Control life cycle,
  Control listeners and localization.

  </p><div class="sect1" title="3.1.&nbsp;Control Interface"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-interface"></a>3.1.&nbsp;Control Interface</h2></div></div></div><p> Controls provide the server side components that process user input,
    and render their display to the user. Controls are equivalent to Visual
    Basic Controls or Delphi Components.
    </p><p>Controls handle the processing of user input in the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onProcess()" target="_blank">onProcess</a>
    method and render their HTML display using the toString() method. The
    execution sequence for a Control being processed and rendered is illustrated
    in the figure below.
    </p><div class="figure"><a name="control-post-sequence-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/controls/control-post-sequence-diagram.png" alt="Post Sequence Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;3.1.&nbsp;Post Sequence Diagram
      </i></p></div><br class="figure-break"><p>In Click all control classes must implement the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html" target="_blank">Control</a> interface.
    The Control interface is depicted in the figure below.
    </p><div class="figure"><a name="control-class-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/controls/control-class-diagram.png" alt="Control Interface Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;3.2.&nbsp;Control Interface Diagram
      </i></p></div><br class="figure-break"><p>Methods on the Control interface include:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#getHeadElements()" target="_blank">getHeadElements()</a>
          - defines the controls HTML header imports.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#getMessages()" target="_blank">getMessages()</a>
          - defines the controls localized messages map.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#getName()" target="_blank">getName()</a> /
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#setName(java.lang.String)" target="_blank">setName()</a>
          &nbsp; - &nbsp; defines the controls name in the Page model or Form fields.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#getParent()" target="_blank">getParent()</a> /
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#setParent(java.lang.Object)" target="_blank">setParent()</a>
          &nbsp; - &nbsp; defines the controls parent.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onDeploy(javax.servlet.ServletContext)" target="_blank">onDeploy()</a>
          - deploy resources on startup.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onInit()" target="_blank">onInit()</a>
          - on initialize event handler.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onProcess()" target="_blank">onProcess()</a>
          - process request event handler.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onDestroy()" target="_blank">onDestroy()</a>
          - on destroy event handler.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#render(org.apache.click.util.HtmlStringBuffer)" target="_blank">render()</a>
          - generate the control's HTML representation.
        </p></li></ul></div></div><div class="sect1" title="3.2.&nbsp;Control Listener"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-listener"></a>3.2.&nbsp;Control Listener</h2></div></div></div><p>Click Controls provide an action listener mechanism similar to a
    <code class="classname">java.awt.ActionListener</code>.
    </p><p>Click supports two styles of action listeners. The first is using the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionListener.html" target="_blank">ActionListener</a>
    interface and
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#setActionListener(org.apache.click.ActionListener)" target="_blank">setActionListener(ActionListener)</a>
    method which provides compile time safety.
    </p><p>The second is to register the action listener via the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#setListener(java.lang.Object, java.lang.String)" target="_blank">setListener(Object, String)</a>
    method where you specify the call back method via its name. This second style
    uses less lines of code, but has no compile time safety.
    </p><p>Examples of these two action listener styles are provided below:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ActionDemo <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> BorderPage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Uses listener style 1</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionLink link = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Uses listener style 2</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionButton button = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionButton();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionDemo() {

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Verbose but provides compile time safety</span>
        link.setActionListener(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionListener() {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onAction(Control source) {
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> onLinkClick(source);
            }
        });

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Succinct but typos will cause runtime errors</span>
        button.setListener(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onButtonClick"</span>);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Event Handlers ---------------------------------------------------------</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onLinkClick(Control source) {
        ..
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onButtonClick() {
        ..
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> true;
    }
}</pre><p>All call back listener methods must return a boolean value. If they
    return true the further processing of other controls and page methods should
    continue. Otherwise if they return false, then any further processing should
    be aborted. By returning false you can effectively exit at this point and
    redirect or forward to another page. This execution logic is illustrated in
    the <a class="link" href="#activity-diagram" title="Figure&nbsp;2.3.&nbsp;Page Execution Activity Diagram">Page Execution Activity Diagram</a>.
    </p><p>Being able to stop further processing and do something else can be very
    handy. For example your Pages onRender() method may perform an expensive database
    operation. By returning false in an event handler you can skip this step and
    render the template or forward to the next page.
    </p></div><div class="sect1" title="3.3.&nbsp;Control Classes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-class"></a>3.3.&nbsp;Control Classes</h2></div></div></div><p>Core control classes are defined in the package
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/package-summary.html" target="_blank">org.apache.click.control</a>.
    This package includes controls for the essential HTML elements.
    </p><p>Extended control classes are provided in the Click Extras package
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/package-summary.html" target="_blank">org.apache.click.extras.control</a>.
    Click Extras classes can contain dependencies to 3rd party frameworks.
    </p><p>A subset of these control classes are depicted in the figure below.
    </p><div class="figure"><a name="control-package-class-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/controls/control-package-class-diagram.png" alt="Package Class Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;3.3.&nbsp;Package Class Diagram
      </i></p></div><br class="figure-break"><p>The key control classes include:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/ActionLink.html" target="_blank">ActionLink</a>
          - provides an anchor link that can invoke action listeners.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Field.html" target="_blank">Field</a>
          - provides the abstract form field control.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html" target="_blank">Form</a>
          - provides a form control for processing, validation and rendering.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Submit.html" target="_blank">Submit</a>
          - provides an input type submit control that can invoke action listeners.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/TextField.html" target="_blank">TextField</a>
          - provides an input type text control that can invoke action listeners.
        </p></li></ul></div><p>The control classes are designed to support subclassing for customized
    behaviour. All control fields have protected visibility and have public
    accessor methods.
    </p><p>You can also aggregate controls to build more complex controls. For
    example the <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/CreditCardField.html" target="_blank">CreditCardField</a>
    uses a <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Select.html" target="_blank">Select</a>
    control to render the different credit card types.
    </p></div><div class="sect1" title="3.4.&nbsp;Message Properties"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-message-properties"></a>3.4.&nbsp;Message Properties</h2></div></div></div><p>Control strings for field validation messages and HTML formatting
    strings are externalized in the properties file. By using these properties
    files you can localize a Click application for your particular language and
    dialect.
    </p><div class="sect2" title="3.4.1.&nbsp;Message Resolution"><div class="titlepage"><div><div><h3 class="title"><a name="message-resolution"></a>3.4.1.&nbsp;Message Resolution</h3></div></div></div><p>Messages are looked up in a particular order enabling taylor specific
      messages, for your controls, individual pages or across your entire
      application. The order in which localized messages are resolved is:
      </p><div class="variablelist"><dl><dt><span class="term"><span class="bold"><strong>Page scope messages</strong></span></span></dt><dd><p>Message lookups are first resolved to the Page classes message
            bundle if it exists. For example a <code class="classname">Login</code> page
            may define the message properties:
            </p><div class="literallayout"><p>/com/mycorp/page/Login.properties</p></div><p>If you want to tailor messages for a particular page this is
            where to place them.
            </p></dd><dt><span class="term"><span class="bold"><strong>Global page scope messages</strong></span></span></dt><dd><p>Next message lookups are resolved to the global pages message
            bundle if it exists.
            </p><div class="literallayout"><p>/click-page.properties</p></div><p>If you want messages to be used across your entire application
            this is where to place them.
            </p></dd><dt><span class="term"><span class="bold"><strong>Control scope messages</strong></span></span></dt><dd><p>Next message lookups are resolved to the Control classes
            message bundle if it exists. For example a
            <code class="classname">CustomTextField</code> control may define the
            message properties:
            </p><div class="literallayout"><p>/com/mycorp/control/CustomTextField.properties</p></div><p>A custom control's messages can be placed here
            (or the global control scope covered next) and overridden by one of the
            above options.
            </p></dd><dt><span class="term"><span class="bold"><strong>Global control scope messages</strong></span></span></dt><dd><p>Finally message lookups are resolved to the global application
            control message bundle if the message has not already been found.
            The global control properties file is:
            </p><div class="literallayout"><p>/click-control.properties</p></div><p>Control messages can be placed here and overridden by one of
            the above options.
            </p></dd></dl></div></div><div class="sect2" title="3.4.2.&nbsp;Control Properties"><div class="titlepage"><div><div><h3 class="title"><a name="control-properties"></a>3.4.2.&nbsp;Control Properties</h3></div></div></div><p>To customize the <code class="filename">click-control.properties</code> simply
      add this file to your classpath and tailor the specific values.
      </p><p>Note when customizing the message properties you must include all
      the properties, not just the ones you want to override.
      </p><div class="literallayout"><p>#&nbsp;Click&nbsp;Control&nbsp;messages<br>
field-maxlength-error={0}&nbsp;must&nbsp;be&nbsp;no&nbsp;longer&nbsp;than&nbsp;{1}&nbsp;characters<br>
field-minlength-error={0}&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;{1}&nbsp;characters<br>
field-required-error=You&nbsp;must&nbsp;enter&nbsp;a&nbsp;value&nbsp;for&nbsp;{0}<br>
<br>
file-required-error=You&nbsp;must&nbsp;enter&nbsp;a&nbsp;filename&nbsp;for&nbsp;{0}<br>
<br>
label-required-prefix=<br>
label-required-suffix=&lt;span&nbsp;class="required"&gt;*&lt;/span&gt;<br>
label-not-required-prefix=<br>
label-not-required-suffix=&amp;nbsp;<br>
<br>
not-checked-error=You&nbsp;must&nbsp;select&nbsp;{0}<br>
<br>
number-maxvalue-error={0}&nbsp;must&nbsp;not&nbsp;be&nbsp;larger&nbsp;than&nbsp;{1}<br>
number-minvalue-error={0}&nbsp;must&nbsp;not&nbsp;be&nbsp;smaller&nbsp;than&nbsp;{1}<br>
<br>
select-error=You&nbsp;must&nbsp;select&nbsp;a&nbsp;value&nbsp;for&nbsp;{0}<br>
<br>
table-first-label=First<br>
table-first-title=Go&nbsp;to&nbsp;first&nbsp;page<br>
table-previous-label=Prev<br>
table-previous-title=Go&nbsp;to&nbsp;previous&nbsp;page<br>
table-next-label=Next<br>
table-next-title=Go&nbsp;to&nbsp;next&nbsp;page<br>
table-last-label=Last<br>
table-last-title=Go&nbsp;to&nbsp;last&nbsp;page<br>
table-goto-title=Go&nbsp;to&nbsp;page<br>
table-page-banner=&lt;span&nbsp;class="pagebanner"&gt;{0}&nbsp;items&nbsp;found,&nbsp;displaying&nbsp;{1}&nbsp;to&nbsp;{2}.&lt;/span&gt;<br>
table-page-banner-nolinks=<br>
&nbsp;&nbsp;&lt;span&nbsp;class="pagebanner-nolinks"&gt;{0}&nbsp;items&nbsp;found,&nbsp;displaying&nbsp;{1}&nbsp;to&nbsp;{2}.&lt;/span&gt;<br>
table-page-links=&lt;span&nbsp;class="pagelinks"&gt;[{0}/{1}]&nbsp;{2}&nbsp;[{3}/{4}]&lt;/span&gt;<br>
table-page-links-nobanner=&lt;span&nbsp;class="pagelinks-nobanner"&gt;[{0}/{1}]&nbsp;{2}&nbsp;[{3}/{4}]&lt;/span&gt;<br>
table-no-rows-found=No&nbsp;records&nbsp;found.<br>
<br>
table-inline-first-image=/click/paging-first.gif<br>
table-inline-first-disabled-image=/click/paging-first-disabled.gif<br>
table-inline-previous-image=/click/paging-prev.gif<br>
table-inline-previous-disabled-image=/click/paging-prev-disabled.gif<br>
table-inline-next-image=/click/paging-next.gif<br>
table-inline-next-disabled-image=/click/paging-next-disabled.gif<br>
table-inline-last-image=/click/paging-last.gif<br>
table-inline-last-disabled-image=/click/paging-last-disabled.gif<br>
table-inline-page-links=Page&nbsp;&nbsp;&nbsp;{0}&nbsp;{1}&nbsp;{2}&nbsp;{3}&nbsp;{4}<br>
<br>
#&nbsp;Message&nbsp;displayed&nbsp;when&nbsp;a&nbsp;error&nbsp;occurs&nbsp;when&nbsp;the&nbsp;application&nbsp;is&nbsp;in&nbsp;"production"&nbsp;mode<br>
production-error-message=<br>
&nbsp;&nbsp;&lt;div&nbsp;id='errorReport'&nbsp;class='errorReport'&gt;The&nbsp;application&nbsp;encountered&nbsp;an&nbsp;unexpected&nbsp;error.<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p></div></div><div class="sect2" title="3.4.3.&nbsp;Accessing Messages"><div class="titlepage"><div><div><h3 class="title"><a name="accessing-messages"></a>3.4.3.&nbsp;Accessing Messages</h3></div></div></div><p>Controls support a hierarchy of resource bundles for displaying
      validation error messages and display messages. These localized messages
      can be accessed through the AbstractControl methods:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#getMessage(java.lang.String)" target="_blank">getMessage(String)</a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#getMessage(java.lang.String,%20java.lang.Object...)" target="_blank">getMessage(String, Object...)</a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#getMessages()" target="_blank">getMessages()</a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Field.html#setErrorMessage(java.lang.String)" target="_blank">setErrorMessage(String)</a>
            - this method is defined on the Field class
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Field.html#setErrorMessage(java.lang.String,%20java.lang.Object)" target="_blank">setErrorMessage(String, Object)</a>
            - this method is defined on the Field class
          </p></li></ul></div><p>These methods use the <code class="literal">Locale</code> of the request to
      lookup the string resource bundle, and use <code class="classname">MessageFormat</code>
      for any string formatting.
      </p></div></div><div class="sect1" title="3.5.&nbsp;Control HEAD Elements"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="control-head-elements"></a>3.5.&nbsp;Control HEAD Elements</h2></div></div></div><p>The Control interface provides the method
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#getHeadElements()" target="_blank">getHeadElements()</a>
    which allows the Control to add Page HEAD
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/Element.html" target="_blank">elements</a>
    such as <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/JsImport.html" target="_blank">JsImport</a>,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/JsScript.html" target="_blank">JsScript</a>,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/CssImport.html" target="_blank">CssImport</a>
    and <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/element/CssStyle.html" target="_blank">CssStyle</a>.
    </p><p>Here is an example of adding HEAD elements to a custom
    <code class="classname">Control</code>:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> MyControl <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> AbstractControl {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> MyControl() {

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
         * Override the default getHeadElements implementation to return
         * MyControl's list of HEAD elements.
         *
         * Note that the variable headElements is defined in AbstractControl.
         *
         * @return list the list of HEAD elements
         */</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> List getHeadElements() {

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Use lazy loading to only add the HEAD elements once and when needed.</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (headElements == null) {

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Get the head elements from the super implementation</span>
                headElements = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>.getHeadElements();

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the JavaScript import "/mycontrol.js" to the control</span>
                headElements.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> JsImport(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/mycontrol.js"</span>));

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the Css import "/mycontrol.css" to the control</span>
                headElements.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> CssImport(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/mycontrol.css"</span>));
            }
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> headElements;
        }
    }

    ...

} </pre><p>In the example above we added the HEAD elements by overriding the
    Control's <code class="methodname">getHeadElements</code> method, however you can
    add HEAD elements from anywhere in the Control including the event handlers
    <code class="literal">onInit</code>, <code class="literal">onGet</code>,
    <code class="literal">onPost</code>, <code class="literal">onRender</code> etc.
    Please see <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getHeadElements()" target="_blank">getHeadElements()</a>
    for more details.
    </p><p><code class="classname">MyControl</code> will add the following HEAD elements
    to the Page HEAD section, together with HEAD elements added by the Page and
    other controls (assume the application context is "/myapp"):
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="symbol">/myapp/mycontrol.css</span>"&gt;<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/link&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

    ...

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;script</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/javascript"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">src</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="symbol">/myapp/mycontrol.js</span>"/&gt;

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span> </pre><p>A live demo showing how to add HEAD elements from a custom Control can
  be seen <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/general/control-head-demo.htm" target="_blank">here</a>.
  </p></div><div class="sect1" title="3.6.&nbsp;Container"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="container"></a>3.6.&nbsp;Container</h2></div></div></div><p><a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Container.html" target="_blank">Container</a>
    is a Control that can contain other Controls, thus forming a hierarchy
    of components. Container enables components to add, remove and retrieve other
    controls. Listed below are example Containers:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html" target="_blank">Form</a>
          - an HTML form which provides default layout of fields and error feedback.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Panel.html" target="_blank">Panel</a>
          - similar to
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html" target="_blank">Page</a>, this
          Container provides its own template and model.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/FieldSet.html" target="_blank">FieldSet</a>
          - draws a legend (border) around its child Controls.
        </p></li></ul></div><p>These Containers are depicted in the figure below.
    </p><div class="figure"><a name="container-package-class-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/controls/container-package-class-diagram.png" alt="Container Class Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;3.4.&nbsp;Container Class Diagram</i></p></div><br class="figure-break"><p>The following classes provides convenient extension points for creating
    custom Containers:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractContainer.html" target="_blank">AbstractContainer</a>
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/AbstractContainerField.html" target="_blank">AbstractContainerField</a>
        </p></li></ul></div><p>Lets cover each of them here.
    </p><div class="sect2" title="3.6.1.&nbsp;AbstractContainer"><div class="titlepage"><div><div><h3 class="title"><a name="abstractcontainer"></a>3.6.1.&nbsp;AbstractContainer</h3></div></div></div><p>Enables easy creation of custom Containers, for example an html
      <span class="emphasis"><em>div</em></span> or <span class="emphasis"><em>span</em></span> element:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Div <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> AbstractContainer {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Div(String name) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>(name);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTag() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return the control's HTML tag.</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"div"</span>;
    }
}</pre><p>Lets try out the newly created <code class="classname">Container</code>
      above: (note the <code class="classname">MockContext</code> used in this test is
      described in the <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../mock-api/overview-summary.html" target="_blank">Mock Test Support</a>
      documentation)
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Test {
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">static</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> main (String args[]) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create mock context in which to test the container.</span>
        MockContext.initContext();

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a div instance called "mydiv"</span>
        String containerName = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"mydiv"</span>;
        Div mydiv = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Div(containerName);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add a control to the container</span>
        mydiv.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"myfield"</span>));

        System.out.println(mydiv);
    }
}</pre><p>Executing the above example results in the following output:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"mydiv"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"mydiv"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"myfield"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"myfield"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">""</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">size</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag"> /&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span></pre></div><div class="sect2" title="3.6.2.&nbsp;AbstractContainerField"><div class="titlepage"><div><div><h3 class="title"><a name="abstractcontainerfield"></a>3.6.2.&nbsp;AbstractContainerField</h3></div></div></div><p>AbstractContainerField extends Field and implements the Container
      interface. This provides a convenient base class in case you run into
      a situation where you need both a Field and Container.
      </p><p>Below is an example of how AbstractContainerField might be used:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> FieldAndContainer <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> AbstractContainerField {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> FieldAndContainer(String name) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>(name);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return the html tag to render</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTag() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"div"</span>;
    }
}</pre><p>To test the new class we use the following snippet:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> Test {
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">static</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> main (String args[]) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create mock context in which to test the container.</span>
        MockContext.initContext();

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a FieldContainer instance called "field_container"</span>
        String containerName = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"field_container"</span>;
        FieldAndContainer fieldAndContainer = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> FieldAndContainer(containerName);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add a couple of fields to the container</span>
        fieldAndContainer.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"myfield"</span>));
        fieldAndContainer.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextArea(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"myarea"</span>));

        System.out.println(fieldAndContainer);
    }
}</pre><p>Executing the snippet produces the output:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"field_container"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"field_container"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"myfield"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"myfield"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">""</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">size</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;textarea</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"myarea"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"myarea"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rows</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"3"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">cols</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/textarea&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span></pre></div></div><div class="sect1" title="3.7.&nbsp;Layouts"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="layout"></a>3.7.&nbsp;Layouts</h2></div></div></div><p>Controls such as <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html" target="_blank">Form</a>
    takes care of layout and error reporting automatically, and for many use
    cases the auto-layout approach is good enough. It is certainly very productive.
    </p><p>However for custom or complex layouts, auto-layout is not always the best
    choice. There are two approaches for creating custom layouts.
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Template approach - use a template engine such as Velocity,
        Freemarker or JSP to declare the layout as HTML markup.
        </p></li><li class="listitem"><p> Programmatic approach - build custom layout components using Java.
        This option is very similar to building components using Swing.
        </p></li></ul></div><div class="sect2" title="3.7.1.&nbsp;Template layout"><div class="titlepage"><div><div><h3 class="title"><a name="template-layout"></a>3.7.1.&nbsp;Template layout</h3></div></div></div><p>The <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html#manual-layout" target="_blank">Template</a>
      approach separates the Page and layout logic. The Page is used to implement
      the presentation logic such as creating controls, registering listeners
      and copying data to domain objects, while the template is used to layout
      the Page controls.
      </p><p>Lets walk through an example using the template approach. Below
      we create an EmployeePage which contains a Form and a bunch of fields
      and submit button.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// EmployeePage.java</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> EmployeePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form form;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create form</span>
        Form form = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"form"</span>);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add a couple of fields to the form</span>
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"firstname"</span>));
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"lastname"</span>));
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> IntegerField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"age"</span>));
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DoubleField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"salary"</span>));

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add a submit button to form</span>
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Submit(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"add"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Add Employee"</span>));

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add form the page</span>
        addControl(form);
    }
}</pre><p>Lets imagine we want to create a layout using the HTML tags,
      &lt;div&gt; and &lt;ol&gt;.
      </p><p>We would then provide the markup for the <code class="varname">employee.htm</code>
      template as shown below, using a template engine such as Velocity:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!-- employee.htm --&gt;</span>
${form.startTag()}
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">style</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"margin: 1em;"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;ol&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"firstname"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Firstname:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
                ${form.fields.firstname}
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"lastname"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Lastname:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
                ${form.fields.lastname}
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"age"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Age:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
                ${form.fields.age}
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"salary"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Salary:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
                ${form.fields.salary}
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/ol&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span>
    ${form.fields.submit}
${form.endTag()}</pre><p>Using CSS the markup above can further be styled and transformed
      into a nice looking form.
      </p><p>There are pros and cons to using the template approach.
      </p><p>One of the advantages is that the layout is explicit and one can
      easily tweak it if needed. For example instead of using divs and ordered
      lists, one can change the template to leverage a table layout.
      </p><p>A disadvantage is added redundancy. In the example above we created
      the fields in Java, and laid them out using markup in the template. If the
      requirements should change to add a new field for example, one will have to
      add the field in the Page as well as the template.
      </p><p>However it is possible to "generify" the layout using template
      engines such as Velocity, Freemarker and JSP.
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Form.html#velocity-macros" target="_blank">Macro.vm</a>
      is an example of a generic and reuable form layout using Velocity.
      </p><p>
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/Panel.html" target="_blank">Panels</a>
      provide another good way to build generic and reusable template based layouts.
      </p><p>Once your generic templates are in place, they can easily be reused
      in your project or even shared across multiple projects.
      </p></div><div class="sect2" title="3.7.2.&nbsp;Programmatic layout"><div class="titlepage"><div><div><h3 class="title"><a name="programmatic-layout"></a>3.7.2.&nbsp;Programmatic layout</h3></div></div></div><p>To combat the redundancy introduced by the Template approach, you can
      take a programmatic approach and use normal Java and some Click classes to
      build custom layouts.
      </p><p>Click extras provides two useful classes in this situation namely,
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/HtmlForm.html" target="_blank">HtmlForm</a>
      and <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/HtmlFieldSet.html" target="_blank">HtmlFieldSet</a>.
      </p><p>Unlike Form and FieldSet which renders its controls using a Table
      layout, HtmlForm and HtmlFieldSet renders its controls in the order they
      were added and does not add any extra markup. HtmlForm will be used in the
      examples below.
      </p><p>To make it easy to compare the two layout approaches we will recreate
      the example from the template layout section, but using the programmatic
      approach.
      </p><p>When creating custom layouts, the HTML construct List &lt;ul&gt; is
      pretty useful. Since Click does not provide this component, we will create
      it as shown below. First we create the HTML list element &lt;ol&gt;, to
      which list item elements &lt;li&gt; can be added:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// HtmlList.java</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> HtmlList <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> AbstractContainer {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTag() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"ol"</span>;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Can only add ListItems: &lt;li&gt; tags</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Control add(Control control) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (!(control <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">instanceof</span> ListItem)) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">throw</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> IllegalArgumentException(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Only list items can be added."</span>);
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>.add(control);
    }
}</pre><p>Next we create the HTML list item element &lt;li&gt;:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// ListItem.java</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ListItem <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> AbstractContainer {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTag() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"li"</span>;
    }
}</pre><p>Another component that will be used in the example is a FieldLabel
      which renders an HTML label element for a target Field.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// FieldLabel.java</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> FieldLabel <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> AbstractControl {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Field target;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> String label;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> FieldLabel(Field target, String label) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>.target = target;
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>.label = label;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTag() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"label"</span>;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Override render to produce an html label for the specified field.</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> render(HtmlStringBuffer buffer) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Open tag: &lt;label</span>
        buffer.elementStart(getTag());

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Set attribute to target field's id</span>
        setAttribute(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"for"</span>, target.getId());

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Render the labels attributes</span>
        appendAttributes(buffer);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Close tag: &lt;label for="firstname"&gt;</span>
        buffer.closeTag();

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add label text: &lt;label for="firstname"&gt;Firstname:</span>
        buffer.append(label);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Close tag: &lt;label for="firstname"&gt;Firstname:&lt;/label&gt;</span>
        buffer.elementEnd(getTag());
    }

}</pre><p>Now the form can be assembled. Continuing with the employee example
      from the <a class="link" href="#template-layout" title="3.7.1.&nbsp;Template layout">template approach</a>, we again
      create an <code class="classname">EmployeePage</code>, but this time an
      <code class="classname">HtmlForm</code> and <code class="classname">HtmlList</code> is used
      to create the custom layout:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// EmployeePage.java</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> EmployeePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// A form instance variable</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> HtmlForm form;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Build the form when the page is initialized</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create an HtmlForm which is ideal for composing manual layouts</span>
        form = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> HtmlForm(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"form"</span>);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a list and add it to the form.</span>
        HtmlList list = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> HtmlList();
        form.add(list);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add firstname field and pass in its name, label and the list to add the field to</span>
        addTextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"firstname"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Firstname:"</span>, list);
        addTextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"lastname"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Lastname:"</span>, list);
        addTextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"age"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Age:"</span>, list);
        addTextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"salary"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Salary:"</span>, list);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add a submit button to form</span>
        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Submit(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"add"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"Add Employee"</span>));

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the form to the page</span>
        addControl(form);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Provide a helper method to add fields to the form</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> addTextField(String nameStr, String labelStr, List list) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a new ListItem &lt;li&gt; and add it to the List</span>
        ListItem item = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ListItem();
        list.add(item);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a textfield with the specified name</span>
        Field field = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(nameStr);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create a field label, which associates the label with the field id.</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// label.toString would output: &lt;label for="firstname"&gt;Firstname:&lt;/name&gt;</span>
        FieldLabel label = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> FieldLabel(field, labelStr);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Next add the label and field to the list item.</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// item.toString would then produce:</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// &lt;li&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">//   &lt;label for="firstname"&gt;Firstname:&lt;/name&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">//   &lt;input type="text" name="firstname" id="form_firstname" value="" size="20"/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// &lt;/li&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">//</span>
        item.add(label);
        item.add(field);
    }
}</pre><p>And lastly the <code class="filename">employee.htm</code> template would only
      need to specify the name of the top level component, in this case
      <code class="varname">form</code>.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!--employee.htm--&gt;</span>
<code class="varname">${form}</code></pre><p>which produces the following markup:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">method</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"post"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">action</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"/myapp/employee.htm"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"hidden"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_name"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_form_name"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;ol&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"firstname"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Firstname:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"firstname"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_firstname"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">""</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">size</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"lastname"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Lastname:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"lastname"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_lastname"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">""</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">size</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"age"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Age:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"age"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_age"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">""</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">size</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;li&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">for</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"salary"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>Salary:<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"salary"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_salary"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">""</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">size</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"20"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/li&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/ol&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"submit"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"add"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">id</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"form_add"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Add Employee"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form&gt;</span></pre><p>Again using a CSS stylesheet, the markup above can be styled and
      transformed into a fancy looking form.
      </p><p>There is a <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/form/contact-details.htm" target="_blank">live demo</a>
      showing the programmatic approach.
      </p><p>The advantage of the programmatic approach is that there is no
      redundancy. Each Field is created and added using normal Java. There is no
      need to specify where the Field must reside in the markup.
      </p><p>If new requirements arrive and more fields added, only the Page needs
      to change. There is no need to change the template as the layout is taken
      care of by CSS and the markup produced by the components.
      </p><p>Disadvantages are that more upfront work is needed to write the
      components and it is more difficult to
      <span class="emphasis"><em>visualize</em></span> what output would be rendered by the
      components.
      </p><p>However once your custom layout components are in place, they can
      easily be reused in your project or even shared across multiple projects.
      </p><p>Whether you use the <a class="link" href="#template-layout" title="3.7.1.&nbsp;Template layout">template</a>
      or <a class="link" href="#programmatic-layout" title="3.7.2.&nbsp;Programmatic layout">programmatic</a> layout approach,
      is up to you. Both work well and have advantages and disadvantages over the
      other.
      </p></div></div><div class="sect1" title="3.8.&nbsp;Behavior"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="behavior"></a>3.8.&nbsp;Behavior</h2></div></div></div>
Behaviors provide the ability to change how Controls behave at runtime.
<p><a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html" target="_blank">Behavior</a>
is an interface that provides <span class="emphasis"><em>interceptor methods</em></span> for certain
<code class="classname">Control</code> life cycle events. These
<span class="emphasis"><em>interceptor methods</em></span> can be implemented to decorate and
enhance the control and its children. This allows for making changes to Controls
such as adding/removing JavaScript and CSS Elements, adding/removing attributes,
etc.
</p><p>Behaviors are added to Controls through the
<a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#addBehavior(org.apache.click.Behavior)" target="_blank">AbstractControl.addBehavior(Behavior)</a>
method, and the same Behavior can be shared by multiple Controls.
</p><p>The <code class="classname">Control</code>, <code class="classname">AbstractControl</code>
    and <code class="classname">Behavior</code>, classes are shown in the figure below.
    </p><div class="figure"><a name="behavior-class-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/controls/behavior-class-diagram.png" alt="Behavior Class Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;3.5.&nbsp;Behavior Class Diagram</i></p></div><br class="figure-break"><p>Control exposes the following Behavior related methods:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#getBehaviors()" target="_blank">getBehaviors()</a>
          - returns the Control's Set of Behaviors
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#hasBehaviors()" target="_blank">hasBehaviors()</a>
          - returns true if the Control has any Behaviors
        </p></li></ul></div><p>AbstractControl contains a <code class="classname">Set</code> that holds the
    <code class="classname">Behaviors</code> added to the <code class="classname">Control</code>.
    It also exposes the following methods for managing <code class="classname">Behaviors</code>:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#addBehavior(org.apache.click.Behavior)" target="_blank">addBehavior(Behavior)</a>
          - adds the given Behavior to the Control's Set of Behaviors
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#removeBehavior(org.apache.click.Behavior)" target="_blank">removeBehavior(Behavior)</a>
          - removes the given Behavior from the Control's Set of Behaviors
        </p></li></ul></div><p>The Behavior interface (<span class="emphasis"><em>interceptor methods</em></span>) is
    covered next:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html#preResponse(org.apache.click.Control)" target="_blank">preResponse(Control)</a>
          - defines an interceptor method that is invoked before the response is written.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html#preRenderHeadElements(org.apache.click.Control)" target="_blank">preRenderHeadElements(Control)</a>
          - defines an interceptor method that is invoked after <code class="methodname">preResponse()</code>
          but before the <code class="classname">Control</code> <code class="methodname">getHeadElements()</code>
          is called. This is a good place to add custom JavaScript or CSS elements
          to Controls.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html#preDestroy(org.apache.click.Control)" target="_blank">preDestroy()</a>
          - defines an interceptor method that is invoked before the
          <code class="classname">Control</code> <code class="methodname">onDestroy()</code>
          event handler. This interceptor method allows the behavior to cleanup
          any resources.
        </p></li></ul></div><div class="sect2" title="3.8.1.&nbsp;Behavior Execution"><div class="titlepage"><div><div><h3 class="title"><a name="behavior-execution"></a>3.8.1.&nbsp;Behavior Execution</h3></div></div></div><p>When a Behavior is added to a Control, the Control is automatically
        registered with the
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ControlRegistry.html" target="_blank">ControlRegistry</a>.
        Registering with the ControlRegistry allows the Click runtime to quickly
        and easily access controls that have Behaviors and process them. Controls
        without behaviors won't be registered and won't be processed.
        </p><p>Click will invoke all the registered Behavior's
        <span class="emphasis"><em>interceptor methods</em></span> at
        the appropriate time during the <code class="classname">Control</code> life
        cycle.
        </p></div><div class="sect2" title="3.8.2.&nbsp;Behavior Example"><div class="titlepage"><div><div><h3 class="title"><a name="behavior-example"></a>3.8.2.&nbsp;Behavior Example</h3></div></div></div><p>Let's look at a simple Behavior example. Say
        we want to put focus on a Field in our Form. Normally we would use the
        following JavaScript snippet somewhere in our page template:
        </p><pre class="programlisting">
        document.getElementById(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'form_nameField'</span>).focus();
</pre><p>If we want this behavior on another page we can copy and paste
this snippet to the other page template and update the field ID. Alternatively
we can create a custom <code class="classname">FocusBehavior</code> that adds the
necessary JavaScript to a target Field:
</p><pre class="programlisting">
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> FocusBehavior <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">implements</span> Behavior {

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> preRenderHeadElements(Control control) {
            String id = control.getId();
            JsScript jsScript = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> JsScript(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"document.getElementById('"</span> + id + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"').focus();"</span>);

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Set script to execute as soon as browser dom is ready. NOTE: The</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// JavaScript logic determining when the DOM is ready is added by</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// the Form control, through the script '/click/control.js'.</span>
            script.setExecuteOnDomReady(true);

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the JavaScript element to the Control</span>
            control.getHeadElements().add(jsScript);
        }

        ...
    } </pre><p>Below is an example using the <code class="classname">FocusBehavior</code>:
        </p><pre class="programlisting">
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> MyPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form form = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"form"</span>);
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> TextField nameField = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> TextField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"nameField"</span>);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> MyPage() {
            addControl(form);
            form.add(nameField);

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Create the custom behavior</span>
            FocusBehavior focus = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> FocusBehavior();

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add the behavior to the field</span>
            nameField.addBehavior(focus);
        }
    } </pre><p>At runtime the <span class="emphasis"><em>nameField</em></span> will be registered with
    the <code class="classname">ControlRegistry</code> when the <code class="classname">FocusBehavior</code>
    is added to the field.
    </p><p>Before the Control's HEAD elements are rendered, Click will invoke the
    <code class="classname">FocusBehavior</code> <span class="emphasis"><em>interceptor method</em></span>,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html#preRenderHeadElements(org.apache.click.Control)" target="_blank">preRenderHeadElements(Control)</a>,
    passing the <span class="emphasis"><em>nameField</em></span> as an argument.
    </p><p>The FocusBehavior <code class="methodname">preRenderHeadElements</code> method
    will add the JavaScript code to the Field HEAD elements which will be rendered
    as part of the server response.
    </p><p>Our JavaScript snippet is executed by the browser as soon as the DOM
    is ready, in other words <span class="emphasis"><em>after</em></span> our nameField has been
    rendered. Focus will be set on the <span class="emphasis"><em>nameField</em></span>.
</p></div></div></div><div class="chapter" title="Chapter&nbsp;4.&nbsp;Ajax"><div class="titlepage"><div><div><h2 class="title"><a name="chapter-ajax"></a>Chapter&nbsp;4.&nbsp;Ajax</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="#ajax-overview">4.1. Ajax Overview</a></span></dt><dt><span class="sect1"><a href="#ajax-behavior">4.2. AjaxBehavior</a></span></dt><dt><span class="sect1"><a href="#ajax-behavior-execution">4.3. AjaxBehavior Execution</a></span></dt><dt><span class="sect1"><a href="#first-ajax-example">4.4. First Ajax Example</a></span></dt><dd><dl><dt><span class="sect2"><a href="#ajax-trace-log">4.4.1. Ajax Trace Log</a></span></dt><dt><span class="sect2"><a href="#ajax-trace-log-no-target-control">4.4.2. Ajax Trace Log - No Ajax Target Control Found</a></span></dt><dt><span class="sect2"><a href="#ajax-trace-log-no-target-ajax-behavior">4.4.3. Ajax Trace Log - No Target AjaxBehavior Found</a></span></dt></dl></dd><dt><span class="sect1"><a href="#ajax-page-action">4.5. Ajax Page Action</a></span></dt><dt><span class="sect1"><a href="#ajax-response-types">4.6. Ajax Response Types</a></span></dt><dt><span class="sect1"><a href="#ajax-error-handling">4.7. Ajax Error Handling</a></span></dt></dl></div><div class="sect1" title="4.1.&nbsp;Ajax Overview"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ajax-overview"></a>4.1.&nbsp;Ajax Overview</h2></div></div></div><p>Ajax is a method of using JavaScript to perform a GET or POST request
and return a result without reloading the whole page.
  </p><p>For an introduction on Ajax please see the following articles:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.w3schools.com/Ajax/default.asp" target="_blank">http://www.w3schools.com/Ajax/default.asp</a></p></li><li class="listitem"><p><a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://en.wikipedia.org/wiki/AJAX" target="_blank">http://en.wikipedia.org/wiki/AJAX</a></p></li></ul></div><p>Ajax is a client-side technology for creating interactive web applications.
  The JavaScript <code class="literal">XMLHttpRequest</code> object is used to perform GET
  and POST requests and the server can send back a response that can be processed
  in the browser.
  </p><p>Click on the other hand is a server-side technology that can handle and
  process incoming Ajax requests and send a response back to the browser.
  </p><p><span class="bold"><strong>Please note:</strong></span> Click is responsible
  for handling server-side requests. It is up to you to develop the client-side
  logic necessary to make the Ajax request, process the server response
  and handle errors. This is easier than it sounds though as there is a wide
  range of free JavaScript libraries and plugins available to help develop
  rich HTML front-ened. Since Click is a stateless framework and Page URLs
  are bookmarkable, it is easy to integrate Click with existing JavaScript
  technologies such as:

    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.jquery.com" target="_blank">jQuery</a>,
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.prototypejs.org/" target="_blank">Prototype</a> and
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://mootools.net/" target="_blank">MooTools</a> to name a few.
  </p><p>It is also possible to write custom
  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ajax/AjaxBehavior.html" target="_blank">AjaxBehaviors</a>
  (covered later) that renders the client-side code necessary to initiate Ajax
  requests and handle Ajax responses and errors. In fact once you become familiar
  Click's Ajax handling, you will likely create custom AjaxBehaviors to
  streamline and encapsulate your client-side code.
  </p><p>In this chapter we'll look at the Ajax support provided by Click. There
  are two basic ways to handle and process Ajax requests:
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="link" href="#ajax-behavior" title="4.2.&nbsp;AjaxBehavior">AjaxBehavior</a> - AjaxBehavior
      is a specialized
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html" target="_blank">Behavior</a>
      that enables Controls to handle and respond to Ajax requests
      </p></li><li class="listitem"><p><a class="link" href="#ajax-page-action" title="4.5.&nbsp;Ajax Page Action">Page Actions</a> - Page Actions
      was covered <a class="link" href="#page-actions" title="2.7.&nbsp;Page Actions">earlier</a> and provides a
      simple way to handle and respond to Ajax requests
      </p></li></ul></div></div><div class="sect1" title="4.2.&nbsp;AjaxBehavior"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ajax-behavior"></a>4.2.&nbsp;AjaxBehavior</h2></div></div></div><p><a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="ajax-behavior" target="_blank">AjaxBehavior</a> is an interface that
    extends Behavior (covered <a class="link" href="#behavior" title="3.8.&nbsp;Behavior">earlier</a>) and
    adds the ability to handle and process incoming Ajax requests.
    </p><p>Click also provides a default AjaxBehavior implementation,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ajax/DefaultAjaxBehavior.html" target="_blank">DefaultAjaxBehavior</a>.
    Using this class you only need to implement the methods you are interested in.
    </p><p>AjaxBehaviors, like Behaviors, are added to controls
    through the <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#addBehavior(org.apache.click.Behavior)" target="_blank">AbstractControl.addBehavior()</a>
    method.
    </p><p>AjaxBehaviors provides an
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ajax/AjaxBehavior.html#onAction(org.apache.click.Control)" target="_blank">onAction</a>
    method (similar to <code class="classname">ActionListener</code>) that is invoked to
    handle Ajax requests. The <code class="methodname">onAction</code>
    method returns an <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html" target="_blank">ActionResult</a>
    containing the data to be rendered to the browser.
    </p><p>The <code class="classname">Control</code>, <code class="classname">Behavior</code>,
    <code class="classname">AjaxBehavior</code> and <code class="classname">ActionResult</code>
    classes are depicted in the figure below.
    </p><div class="figure"><a name="ajax-behavior-class-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/ajax/ajax-class-diagram.png" alt="Ajax Behavior Class Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;4.1.&nbsp;Ajax Behavior Class Diagram</i></p></div><br class="figure-break"><p>The following method is exposed by Control in order to handle Ajax
    requests:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#isAjaxTarget(org.apache.click.Context)" target="_blank">isAjaxTarget(Context)</a>
          - Returns true if the control is the Ajax request <code class="literal">target</code>,
          false otherwise. The <code class="literal">Ajax target control</code> is the Control
          which <code class="methodname">onProcess</code> method will be invoked. Other
          controls won't be processed. The most common way to target a specific
          server side control is to give it an
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/control/AbstractControl.html#setId(java.lang.String)" target="_blank">HTML ID</a>
          attribute, which is then passed as an Ajax request parameter to the server.
          More on this later.
        </p></li></ul></div><p>The Behavior interface has been covered <a class="link" href="#behavior-class-diagram" title="Figure&nbsp;3.5.&nbsp;Behavior Class Diagram">already</a>
    so we'll look at AjaxBehavior next:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Behavior.html#isAjaxTarget(org.apache.click.Context)" target="_blank">isAjaxTarget(Context)</a>
          - determines whether the AjaxBehavior is the request target or not. Click
          will only invoke the AjaxBehavior <code class="methodname">onAction</code> method
          if <code class="methodname">isAjaxTarget</code> returns true. This
          allows for fine grained control over the exection of the <code class="methodname">onAction</code>
          method.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ajax/AjaxBehavior.html#onAction(org.apache.click.Control)" target="_blank">onAction(Control)</a>
          - the AjaxBehavior action method for handling Ajax requests.
        </p></li></ul></div><p>The <code class="methodname">onAction</code> method returns an
    <code class="classname">ActionResult</code> instance, containing the data to be
    rendered to the browser. ActionResult can return any type of response: String,
    byte array or a Velocity (Freemarker) template.
    </p><p>The <code class="methodname">isAjaxTarget</code> method controls whether or
    not the <code class="methodname">onAction</code> method should be invoked.
    <code class="methodname">isAjaxTarget()</code> is typically used to target the
    AjaxBehavior for specific JavaScript events. For example an AjaxBehavior might
    only handle <code class="literal">click</code> or <code class="literal">blur</code> JavaScript events.
    Of course the client-side code initiating the Ajax request should pass
    the JavaScript event to the server.
    </p><p>Lastly the <code class="classname">ActionResult</code> methods are shown below:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html#setContent(java.lang.String)" target="_blank">setContent(String)</a>
          - set the String content to render to the browser
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html#setBytes(byte[])" target="_blank">setBytes(byte[])</a>
          - set the byte array to render to the browser
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html#setBytes(byte[])" target="_blank">setTemplate(String)</a>
          - set the name of the Velocity (or Freemarker) template to render to
          the browser
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html#setModel(java.util.Map)" target="_blank">setModel(Map)</a>
          - set the Velocity (or Freemarker) template model
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ActionResult.html#setContentType(java.lang.String)" target="_blank">setContentType(String)</a>
          - set the ActionResult content type, for example: <code class="literal">text/html</code>,
          <code class="literal">text/xml</code>, <code class="literal">application/json</code> etc.
        </p></li></ul></div></div><div class="sect1" title="4.3.&nbsp;AjaxBehavior Execution"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ajax-behavior-execution"></a>4.3.&nbsp;AjaxBehavior Execution</h2></div></div></div><p>The execution sequence for an <code class="classname">AjaxBehavior</code>
    being processed and rendered is illustrated in the figure below. Note
    that it is similar to a normal HTTP request flow. The main differences are that
    Ajax requests do not have an onGet or onRender event and that only the
    <code class="literal">Ajax target Control</code> is processed.
    </p><div class="figure"><a name="ajax-behavior-sequence-diagram"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/ajax/ajax-request-sequence-diagram.png" alt="AjaxBehavior Sequence Diagram"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;4.2.&nbsp;AjaxBehavior Sequence Diagram</i></p></div><br class="figure-break"><p>Stepping through this Ajax GET request sequence, first a new Page
    instance is created.
    </p><p>Then the <code class="methodname">onSecurityCheck()</code> handler is executed
    to authorize access to the page, and if necessary abort further processing.
    If the request is aborted for an Ajax request, no response is rendered to
    the browser. If you want to render a response you need to write to the
    <code class="classname">HttpServletResponse</code> directly or create and
    render an <code class="classname">ActionResult</code> yourself.
    </p><p>The next method invoked is <code class="methodname">onInit()</code> to initialize,
    create and setup controls and <code class="classname">Behaviors</code>.
    <code class="methodname">onInit</code> is an ideal place to add <code class="classname">Behaviors</code>
    to <code class="classname">Controls</code>. When a Behavior is added to a Control that
    Control is automatically registered with the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ControlRegistry.html" target="_blank">ControlRegistry</a>
    as a potential
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ControlRegistry.html#registerAjaxTarget(org.apache.click.Control)" target="_blank">Ajax target control</a>.
    </p><p>The next step is to find and process the <code class="literal">Ajax target control</code>.
    First the ClickServlet needs to determine which Control is the Ajax target.
    To resolve the target Control the ClickServlet iterates over all the Controls
    registered with the ControlsRegistry and invokes each Control's
    <code class="methodname">isAjaxTarget</code> method. The first control which
    <code class="methodname">isAjaxTarget</code> method returns <span class="emphasis"><em>true</em></span>,
    will be the Ajax target.
    </p><p>The simplest <code class="methodname">isAjaxTarget</code> implementation is
    to return <span class="emphasis"><em>true</em></span> if the Control ID is passed as a request
    parameter. The client-side JavaScript code that initiate the Ajax request,
    must ensure the Control ID is sent as part of the Ajax request. Note, if the
    ClickServlet cannot find a target control, no response is rendered.
    </p><p>If an Ajax target control is found, the ClickServlet will invoke
    that control's <code class="methodname">onProcess</code> method. Other controls are not
    processed.
    </p><p>
    <span class="bold"><strong>Please note:</strong></span> since Click is a stateless framework,
    processing a control for an Ajax request has the same requirements as processing
    a control for a non-Ajax request. In other words, in addition to the Control
    ID (or other identifier), the Ajax request must include all the parameters
    normally expected by the target Control and its children. For example, a
    Field expects it's <code class="literal">name/value</code> parameter while an ActionLink
    expects its <code class="literal">actionLink/name</code> parameter.
    Putting it another way, if for example an ActionLink is clicked and
    we only pass the link's HTML ID parameter, Click will identify the link
    as the Ajax target control and invoke the link's
    <code class="methodname">onProcess</code> method. The
    <code class="methodname">onProcess</code> method is where the link's values are
    bound and if it was clicked it's action event (AjaxBehavior) will be fired.
    An ActionLink is "clicked" if the <code class="literal">actionLink</code> parameter
    has a value matching the link's name. If no <code class="literal">actionLink</code>
    parameter is present, the server doesn't know that the link was clicked
     and won't fire the AjaxBehavior's <code class="methodname">onAction</code> event.
    So for an Ajax request it is still necessary to pass all the parameters
    normally expected by the ActionLink <code class="methodname">onProcess</code> method.
    For ActionLink that means the Ajax request must include it's
    <code class="literal">href</code> parameters while a Form would require all it's
    Field <code class="literal">name/value</code> pairs.
    </p><p>Next, the target control <code class="classname">AjaxBehaviors</code> are
    fired. The ClickServlet iterates over the control AjaxBehaviors and for each
    AjaxBehavior invoke the method: <code class="methodname">isAjaxTarget</code>.
    Each AjaxBehavior which <code class="methodname">isAjaxTarget</code> method returns
    <span class="emphasis"><em>true</em></span>, will have their <code class="methodname">onAction</code>
    method invoked to handle the Ajax request. The AjaxBehavior's
    <code class="methodname">onAction</code> method returns an
    <code class="classname">ActionResult</code> that is rendered to the browser.
    </p><p>Please note: multiple AjaxBehaviors can handle the same Ajax request,
    however only the first <code class="classname">ActionResult</code> returned will be
    rendered to the browser. If an <code class="methodname">onAction</code> method
    returns <code class="literal">null</code>, the <code class="classname">ActionResult</code>
    returned by the next AjaxBehavior's onAction method will be used. If all
    onAction methods returns null, no response is rendered.
    </p><p>Next the ActionResult is rendered to the browser.</p><p>The final step in this sequence is invoking each control's onDestroy()
    method and lastly invoke the Page onDestroy() method.</p></div><div class="sect1" title="4.4.&nbsp;First Ajax Example"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="first-ajax-example"></a>4.4.&nbsp;First Ajax Example</h2></div></div></div><p>In this first example we demonstrate how to handle Ajax requests with a
    <span class="symbol">DefaultAjaxBehavior</span>. DefaultAjaxBehavior is the default
    implementation of the <code class="classname">AjaxBehavior</code> interface. Below is
    the Page class, <code class="classname">AjaxBehaviorPage.java</code>, showing a
    <span class="symbol">DefaultAjaxBehavior</span> added to an ActionLink, called
    <span class="emphasis"><em>link</em></span> with an HTML ID of <code class="varname">link-id</code>.
    The <span class="symbol">DefaultAjaxBehavior</span> <code class="varname">onAction</code>
    method will be invoked to handle the Ajax request. The <code class="varname">onAction</code>
    method returns an <span class="token">ActionResult</span> that is rendered to the browser.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> AjaxBehaviorPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> BorderPage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">static</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">final</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">long</span> serialVersionUID = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="lit">1L</span>;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> ActionLink link = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"link"</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"here"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> AjaxBehaviorPage() {
        link.setId(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"link-id"</span>); <a class="co" name="co-link-id" href="#ca-link-id"><img src="images/callouts/1.gif" alt="1" border="0"></a>

        addControl(link);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Add a DefaultAjaxBehavior to the link. The DefaultAjaxBehavior will be invoked when the</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// link is clicked.</span>
        link.addBehavior(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> <span class="symbol">DefaultAjaxBehavior()</span> { <a class="co" name="co-ajax-behavior" href="#ca-ajax-behavior"><img src="images/callouts/2.gif" alt="2" border="0"></a>

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pun">@Override</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span class="token">ActionResult</span> <code class="varname">onAction</code>(Control source) { <a class="co" name="co-ajax-behavior-method" href="#ca-ajax-behavior-method"><img src="images/callouts/3.gif" alt="3" border="0"></a>

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Formatted date instance that will be added to the</span>
                String now = format.currentDate(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"MMM, yyyy dd HH:MM:ss"</span>);

                String msg = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"AjaxBehavior &lt;tt&gt;onAction()&lt;/tt&gt; method invoked at: "</span> + now;

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return an action result containing the message</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> <span class="token">ActionResult</span>(msg, ActionResult.HTML); <a class="co" name="co-ajax-action-result" href="#ca-ajax-action-result"><img src="images/callouts/4.gif" alt="4" border="0"></a>
            }
        });
    }
} </pre><div class="calloutlist"><table border="0" summary="Callout list"><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-link-id"></a><a href="#co-link-id"><img src="images/callouts/1.gif" alt="1" border="0"></a> </td><td valign="top" align="left"><p>We assign to ActionLink the HTML ID: <code class="varname">link-id</code>.
        The ID will be used to identify the ActionLink as the
        <code class="literal">Ajax target control</code>. The client-side JavaScript code
        is expected to send this ID as an Ajax request parameter.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-behavior"></a><a href="#co-ajax-behavior"><img src="images/callouts/2.gif" alt="2" border="0"></a> </td><td valign="top" align="left"><p>Next we add the <span class="symbol">DefaultAjaxBehavior</span> to the ActionLink.
        Adding a Behavior to a control will also register that control with the
        <a class="external" href="../../click-api/org/apache/click/ControlRegistry.html" target="_blank">ControlRegistry</a>
        as a potential <code class="literal">Ajax target control</code>.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-behavior-method"></a><a href="#co-ajax-behavior-method"><img src="images/callouts/3.gif" alt="3" border="0"></a> </td><td valign="top" align="left"><p>We also implement the <span class="symbol">DefaultAjaxBehavior</span>
        <code class="varname">onAction</code> method in order to handle the Ajax request.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-action-result"></a><a href="#co-ajax-action-result"><img src="images/callouts/4.gif" alt="4" border="0"></a> </td><td valign="top" align="left"><p>Finally we return an <span class="token">ActionResult</span> containing some
        HTML content that is rendered to the browser.
        </p></td></tr></table></div><p>Below we show the Page template <code class="literal">ajax-behavior.htm</code>,
    containing the client-side JavaScript code that will initiate the Ajax request.
    </p><p><span class="bold"><strong>Note:</strong></span> the example below uses the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.jquery.com" target="_blank">jQuery</a> library, but any other
    library can be used. Also see the online Click examples for more Ajax demos.
    </p><pre class="programlisting">&lt;!-- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// $link is a Velocity reference that will render an ActionLink at runtime. --&gt;</span>
Click $link to make an Ajax request to the server.

&lt;div id=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"result"</span>&gt;
    &lt;!-- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Ajax response will be set here --&gt;</span>
&lt;/div&gt;

&lt;!-- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// JavaScript code below --&gt;</span>

&lt;!-- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Import the jQuery library --&gt;</span>
&lt;script type=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"text/javascript"</span> src=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"$context/js/jquery.js"</span>&gt;&lt;/script&gt;

&lt;!-- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// The client-side JavaScript for initiating an Ajax request --&gt;</span>
&lt;script type=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"text/javascript"</span>&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// This example uses jQuery for making Ajax requests:</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Register a function that is invoked as soon as the entire DOM has been loaded</span>
    jQuery(document).ready(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">function</span>() { <a class="co" name="co-ajax-jq-function" href="#ca-ajax-jq-function"><img src="images/callouts/1.gif" alt="1" border="0"></a>

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Register a 'click' handler that makes an Ajax request</span>
        jQuery(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"#link-id"</span>).click(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">function</span>(event){
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Make ajax request</span>
            makeRequest();

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Prevent the default browser behavior of navigating to the link</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
        })
    })

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">function</span> makeRequest() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Get a reference to the link</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">var</span> link = jQuery(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'#link-id'</span>);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// In order for Click to identify the Ajax target, we pass the link ID</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// attribute as request parameters</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">var</span> extraData = link.attr(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'id'</span>) + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'=1'</span>; <a class="co" name="co-ajax-link-id" href="#ca-ajax-link-id"><img src="images/callouts/2.gif" alt="2" border="0"></a>

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// The Ajax URL is set to the link 'href' URL which contains all the link default parameters,</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// including it's name/value pair: 'actionLink=link'</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">var</span> url = link.attr(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'href'</span>); <a class="co" name="co-ajax-jq-href" href="#ca-ajax-jq-href"><img src="images/callouts/3.gif" alt="3" border="0"></a>

        jQuery.get(url, extraData, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">function</span>(data) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// 'data' is the response returned by the server</span>

            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Find the div element with the id "result", and set its content to the server response</span>
            jQuery(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"#result"</span>).html(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"&lt;p&gt;"</span> + data + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"&lt;/p&gt;"</span>); <a class="co" name="co-ajax-jq-response" href="#ca-ajax-jq-response"><img src="images/callouts/4.gif" alt="4" border="0"></a>
        });
    }
&lt;/script&gt; </pre><div class="calloutlist"><table border="0" summary="Callout list"><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-jq-function"></a><a href="#co-ajax-jq-function"><img src="images/callouts/1.gif" alt="1" border="0"></a> </td><td valign="top" align="left"><p>We start off with a jQuery <a class="external" href="http://api.jquery.com/ready/" target="_blank">ready</a>
        function that is executed as soon as the browser DOM has been loaded.
        This ensures that the function body is executed <code class="literal">before</code>
        the page images are downloaded, which results in a more responsive UI.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-link-id"></a><a href="#co-ajax-link-id"><img src="images/callouts/2.gif" alt="2" border="0"></a> </td><td valign="top" align="left"><p>This is an important step. We need to pass the link's <code class="varname">HTML ID</code>
        attribute as request parameters in order for the server to identify <code class="literal">which</code>
        server-side control is the <code class="literal">Ajax target</code>. We use the jQuery
        <code class="literal">attr</code> function to lookup the link's <code class="varname">HTML ID</code>
        attribute. Click doesn't actually use the <code class="literal">value</code> of the
        parameter, it is enough that the <code class="literal">name</code> is present.
        In this example we pass a value of <code class="varname">1</code>, but any
        other value could be used, or even left out.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-jq-href"></a><a href="#co-ajax-jq-href"><img src="images/callouts/3.gif" alt="3" border="0"></a> </td><td valign="top" align="left"><p>This is another important step. In addition to the ActionLink HTML ID
        pararameter, we also need to send the link's <code class="varname">href</code>
        parameters, otherwise the  ActionLink <code class="methodname">onProcess</code>
        method won't fire the <code class="classname">AjaxBehavior</code>
        <code class="methodname">onAction</code> event. An easy way to achieve this to
        set the Ajax <code class="varname">URL</code> to the ActionLink
        <code class="varname">href</code> value.
        </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-ajax-jq-response"></a><a href="#co-ajax-jq-response"><img src="images/callouts/4.gif" alt="4" border="0"></a> </td><td valign="top" align="left"><p>Finally we the jQuery
        <a class="external" href="http://api.jquery.com/html/#html2" target="_blank">html</a> function
        to update the <span class="emphasis"><em>div</em></span> content with the server response.
        </p></td></tr></table></div><div class="sect2" title="4.4.1.&nbsp;Ajax Trace Log"><div class="titlepage"><div><div><h3 class="title"><a name="ajax-trace-log"></a>4.4.1.&nbsp;Ajax Trace Log</h3></div></div></div><p>Looking at the output log we see the following trace:
      </p><div class="literallayout"><p>[Click]&nbsp;[debug]&nbsp;GET&nbsp;http://localhost:8080/mycorp/ajax/ajax-behavior.htm<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">is&nbsp;Ajax&nbsp;request</span>:&nbsp;<code class="varname">true</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;param:&nbsp;<code class="varname">actionLink=link</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;param:&nbsp;<code class="varname">link-id=1</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.&lt;&lt;init&gt;&gt;<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onSecurityCheck()&nbsp;:&nbsp;true<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="token">the&nbsp;following&nbsp;controls&nbsp;have&nbsp;been&nbsp;registered&nbsp;as&nbsp;potential&nbsp;Ajax&nbsp;targets:</span><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionLink:&nbsp;name='link'<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.<span class="symbol">isAjaxTarget()</span>&nbsp;:&nbsp;<code class="varname">true</code>&nbsp;(Ajax&nbsp;target&nbsp;control&nbsp;found)<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.<span class="symbol">onProcess()</span>&nbsp;:&nbsp;<code class="varname">true</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="token">processing&nbsp;AjaxBehaviors&nbsp;for&nbsp;control:&nbsp;'link'&nbsp;ActionLink</span><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.1.<span class="symbol">isRequestTarget()</span>&nbsp;:&nbsp;<code class="varname">true</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.1.<span class="symbol">onAction()</span>&nbsp;:&nbsp;<code class="varname">ActionResult</code>&nbsp;(ActionResult&nbsp;will&nbsp;be&nbsp;rendered)<br>
[Click]&nbsp;[info&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;<span class="token">renderActionResult</span>&nbsp;(text/html)&nbsp;-&nbsp;1&nbsp;ms<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onDestroy()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onDestroy()<br>
[Click]&nbsp;[info&nbsp;]&nbsp;handleRequest:&nbsp;&nbsp;/ajax/ajax-behavior.htm&nbsp;-&nbsp;25&nbsp;ms</p></div><p>First thing we notice is that the request is recognized as an
      <span class="symbol">Ajax request</span>.
      </p><p>We can also see from the log that the Ajax request passed the parameters,
      <code class="varname">link-id=1</code> and <code class="varname">actionLink=link</code> to the server.
      <code class="varname">link-id</code> is the ActionLink HTML ID attribute that will be used
      to identify the Control as the <code class="literal">Ajax request target</code>.
      </p><p>Next, the log prints which controls have been registered as <code class="literal">potential
      Ajax targets</code>. In our example we added an AjaxBehavior to the ActionLink
      so the ActionLink is registered as an Ajax target.
      </p><p>Next, the ActionLink#<span class="symbol">isAjaxTarget</span> was invoked and because
      it returned <code class="varname">true</code>, ActionLink will be used as the
      <code class="literal">Ajax target control.</code>
      </p><p>Having found the <code class="literal">Ajax target</code>, the ActionLink
      <span class="symbol">onProcess</span> is called.
      </p><p>Next, the log shows it found the <code class="literal">target AjaxBehavior</code>
      by invoking the AjaxBehavior#<span class="symbol">isRequestTarget</span> method, which
      returned <code class="varname">true</code>.
      </p><p>The AjaxBehavior#<span class="symbol">onAction</span> is invoked which returns an
      <code class="varname">ActionResult</code>.
      </p><p>Finally, the <code class="varname">ActionResult</code> is rendered to the browser.
      </p></div><div class="sect2" title="4.4.2.&nbsp;Ajax Trace Log - No Ajax Target Control Found"><div class="titlepage"><div><div><h3 class="title"><a name="ajax-trace-log-no-target-control"></a>4.4.2.&nbsp;Ajax Trace Log - No Ajax Target Control Found</h3></div></div></div><p>Below we show a log trace where no <code class="literal">Ajax target control</code>
      is found. The most common reason this can occur is if the JavaScript code
      that initiates the Ajax request does not send the necessary request parameters
      to identify the <code class="literal">Ajax target control</code>. Another problem is
      if no Control is registered ith the <code class="classname">ControlRegistry</code>,
      thus there is no potential <code class="literal">Ajax target control</code>. This can
      occur if no Behavior is added to a Control.
      </p><div class="literallayout"><p>[Click]&nbsp;[debug]&nbsp;GET&nbsp;http://localhost:8080/mycorp/ajax/ajax-behavior.htm<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">is&nbsp;Ajax&nbsp;request</span>:&nbsp;<code class="varname">true</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;param:&nbsp;<code class="varname">actionLink=link</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.&lt;&lt;init&gt;&gt;<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onSecurityCheck()&nbsp;:&nbsp;true<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="token">the&nbsp;following&nbsp;controls&nbsp;have&nbsp;been&nbsp;registered&nbsp;as&nbsp;potential&nbsp;Ajax&nbsp;targets:</span><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionLink:&nbsp;name='link'<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">*no*</span>&nbsp;target&nbsp;control&nbsp;was&nbsp;found&nbsp;for&nbsp;the&nbsp;Ajax&nbsp;request<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onDestroy()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onDestroy()<br>
[Click]&nbsp;[info&nbsp;]&nbsp;handleRequest:&nbsp;&nbsp;/ajax/ajax-behavior.htm&nbsp;-&nbsp;87&nbsp;ms</p></div><p>Notice from the log that the only request parameters sent is
      <code class="varname">actionLink=link</code>.
      </p><p>Next, the log prints which controls have been registered as <code class="literal">potential
      Ajax targets</code>. In our example we added an AjaxBehavior to the
      ActionLink so the ActionLink is registered as an Ajax target.
      </p><p>Finally, we see that <span class="symbol">*no*</span> Ajax target control was found.
      This is because the ActionLink ID attribute, <code class="varname">link-id</code>,
      does not match the incoming request parameter, <code class="varname">actionLink=link</code>,
      hence the ActionLink was not identified as the <code class="literal">Ajax request target</code>
      and no response is rendered.
      </p></div><div class="sect2" title="4.4.3.&nbsp;Ajax Trace Log - No Target AjaxBehavior Found"><div class="titlepage"><div><div><h3 class="title"><a name="ajax-trace-log-no-target-ajax-behavior"></a>4.4.3.&nbsp;Ajax Trace Log - No Target AjaxBehavior Found</h3></div></div></div><p>Below we show a log trace where no <code class="literal">target AjaxBehavior</code>
      is found. This can occur if no <code class="classname">AjaxBehavior's</code>
      <span class="symbol">isRequestTarget</span> returns true.
      </p><div class="literallayout"><p>[Click]&nbsp;[debug]&nbsp;GET&nbsp;http://localhost:9999/mycorp/ajax/ajax-behavior.htm<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">is&nbsp;Ajax&nbsp;request</span>:&nbsp;<code class="varname">true</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;param:&nbsp;<code class="varname">actionLink=link</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;param:&nbsp;<code class="varname">link-id=1</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.&lt;&lt;init&gt;&gt;<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onSecurityCheck()&nbsp;:&nbsp;true<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;following&nbsp;controls&nbsp;have&nbsp;been&nbsp;registered&nbsp;as&nbsp;potential&nbsp;Ajax&nbsp;targets:<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActionLink:&nbsp;name='link'<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.isAjaxTarget()&nbsp;:&nbsp;true&nbsp;(Ajax&nbsp;target&nbsp;control&nbsp;found)<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onProcess()&nbsp;:&nbsp;true<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="token">processing&nbsp;AjaxBehaviors&nbsp;for&nbsp;control:&nbsp;'link'&nbsp;ActionLink</span><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.1.<span class="symbol">isRequestTarget()</span>&nbsp;:&nbsp;<code class="varname">false</code><br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">*no*</span>&nbsp;target&nbsp;AjaxBehavior&nbsp;found&nbsp;for&nbsp;<code class="varname">'link'&nbsp;ActionLink</code>&nbsp;-&nbsp;invoking&nbsp;AjaxBehavior.isRequestTarget()&nbsp;returned&nbsp;false&nbsp;for&nbsp;all&nbsp;AjaxBehaviors<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;'link'&nbsp;ActionLink.onDestroy()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;AjaxBehaviorPage.onDestroy()<br>
[Click]&nbsp;[info&nbsp;]&nbsp;handleRequest:&nbsp;&nbsp;/ajax/ajax-behavior.htm&nbsp;-&nbsp;80&nbsp;ms<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p></div><p>We can see from the log that the Ajax request sent the parameters,
      <code class="varname">link-id=1</code> and <code class="varname">actionLink=link</code> to the server.
      </p><p>Next we notice that the AjaxBehavior <span class="symbol">isRequestTarget()</span>
      returned <code class="varname">false</code>.
      </p><p>Finally we see that <span class="symbol">*no*</span> target AjaxBehavior was found
      for the <code class="literal">Ajax target control</code>, <code class="varname">'link' ActionLink</code>.
      </p></div></div><div class="sect1" title="4.5.&nbsp;Ajax Page Action"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ajax-page-action"></a>4.5.&nbsp;Ajax Page Action</h2></div></div></div><p>Page Actions are <span class="emphasis"><em>page methods</em></span> that can be invoked
    directly from the browser. So instead of handling the Ajax request with a
    Control, the request is handled with a <span class="emphasis"><em>page method</em></span>.
    </p><p>Similar to the AjaxBehavior <code class="methodname">onAction</code> method,
    <span class="emphasis"><em>page methods</em></span> returns an <code class="classname">ActionResult</code>
    containing the data to render to the browser.
    </p><p>Page Actions have been covered earlier. Please click
    <a class="link" href="#page-actions" title="2.7.&nbsp;Page Actions">here</a> for a detailed overview.
    </p><p>Using a Page Action for handling an Ajax request is no different from
    the normal HTTP version. To invoke a Page Action, specify the parameter
    <code class="varname">"pageAction"</code> and the name of the page method eg:
    <span class="symbol">"onLinkClicked"</span>.
    </p><p>Here is an example using the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.jquery.com" target="_blank">jQuery</a> JavaScript library to make
    an Ajax request to a Page Action:
    </p><pre class="programlisting">jQuery(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'#some-link-id'</span>).click(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">function</span>() {

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// The ViewCustomerPage url</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">var</span> url = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'$context/view-customers.htm'</span>;

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Specify the pageAction parameter and page method to invoke: 'onLinkClicked'</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">var</span> extraData = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">'pageAction=</span><span class="symbol">onLinkClicked</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">';
</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Perform the Ajax request</span>
  jQuery.get(url, extraData, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">function</span>(response) {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Update the target element with the server response</span>
    jQuery(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"#target"</span>).html(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"&lt;p&gt;"</span> + response + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"&lt;/p&gt;"</span>);
  });

}); </pre><p>The JavaScript snippet above will send a request to the
  <code class="classname">ViewCustomerPage</code> method <span class="symbol">"onLinkClicked"</span>,
  which returns an <span class="token">ActionResult</span> instance:
  </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ViewCustomerPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    ...

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span class="token">ActionResult</span> <span class="symbol">onLinkClicked()</span> {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Formatted date instance that will be returned to the browser</span>
        String now = format.currentDate(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"MMM, yyyy dd HH:MM:ss"</span>);

        String msg = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"PageAction method &lt;tt&gt;onLinkClicked()&lt;/tt&gt; invoked at: "</span> + now;

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return an action result containing the message</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> <span class="token">ActionResult</span>(msg, ActionResult.HTML);
    }
} </pre><p>The <span class="token">ActionResult</span> contains the data that is rendered to the
    client browser. In the example above, the action result is an HTML snippet
    containing todays date.
    </p></div><div class="sect1" title="4.6.&nbsp;Ajax Response Types"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ajax-response-types"></a>4.6.&nbsp;Ajax Response Types</h2></div></div></div><p>The most common server response types are:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>HTML</p></li><li class="listitem"><p>XML</p></li><li class="listitem"><p>JSON</p></li></ul></div><p>Click Controls render themselves as XHTML markup so can be used in
    either XML or HTML responses.
    </p><p>Here is an example showing how to return different types of responses:</p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> HelloWorldPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    ...

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        Behavior htmlBehavior = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DefaultAjaxBehavior() {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionResult onAction() {
                String html = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"&lt;h1&gt;Hello world&lt;/h1&gt;"</span>;

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return an HTML snippet</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionResult(html, ActionResult.HTML);
            }
        };
        htmlLink.addBehavior(htmlBehavior);

        ...

        Behavior xmlBehavior = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DefaultAjaxBehavior() {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionResult onAction() {
                String xml = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"&lt;payload&gt;Hello world&lt;/payload&gt;"</span>;

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return an XML snippet</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionResult(xml, ActionResult.XML);
            }
        };
        xmlLink.addBehavior(xmlBehavior);

        ...

        Behavior jsonBehavior = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> DefaultAjaxBehavior() {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionResult onAction() {
                String json = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"{\"value\": \"Hello world\"}"</span>;

                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Return an JSON snippet</span>
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionResult(json, ActionResult.JSON);
            }
        };
        jsonLink.addBehavior(jsonBehavior);
    }
} </pre></div><div class="sect1" title="4.7.&nbsp;Ajax Error Handling"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ajax-error-handling"></a>4.7.&nbsp;Ajax Error Handling</h2></div></div></div><p>If an exception occurs while processing an Ajax request and the application
    is in <code class="literal">development</code> mode, the exception
    <code class="literal">stackTrace</code> is returned to the browser.
    </p><p>If an exception occurs while processing an Ajax request and the application
    is in <code class="literal">production</code> mode, a simple error message is returned.
    </p></div></div><div class="chapter" title="Chapter&nbsp;5.&nbsp;Configuration"><div class="titlepage"><div><div><h2 class="title"><a name="chapter-configuration"></a>Chapter&nbsp;5.&nbsp;Configuration</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="#servlet-configuration">5.1. Servlet Configuration</a></span></dt><dd><dl><dt><span class="sect2"><a href="#servlet-mapping">5.1.1. Servlet Mapping</a></span></dt><dt><span class="sect2"><a href="#load-on-startup">5.1.2. Load On Startup</a></span></dt><dt><span class="sect2"><a href="#type-converter-class">5.1.3. Type Converter Class</a></span></dt><dt><span class="sect2"><a href="#config-service-class">5.1.4. Config Service Class</a></span></dt></dl></dd><dt><span class="sect1"><a href="#application-configuration">5.2. Application Configuration</a></span></dt><dd><dl><dt><span class="sect2"><a href="#click-app">5.2.1. Click App</a></span></dt><dt><span class="sect2"><a href="#application-pages">5.2.2. Pages</a></span></dt><dd><dl><dt><span class="sect3"><a href="#application-multiple-packages">5.2.2.1. Multiple Pages Packages</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-page">5.2.3. Page</a></span></dt><dd><dl><dt><span class="sect3"><a href="#application-automapping">5.2.3.1. Page Automapping</a></span></dt><dt><span class="sect3"><a href="#application-excludes">5.2.3.2. Automapping Excludes</a></span></dt><dt><span class="sect3"><a href="#application-autobinding">5.2.3.3. Page Autobinding</a></span></dt><dt><span class="sect3"><a href="#application-autobinding-annotation">5.2.3.4. Page Autobinding - Using Annotations</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-headers">5.2.4. Headers</a></span></dt><dd><dl><dt><span class="sect3"><a href="#browser-caching">5.2.4.1. Browser Caching</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-format">5.2.5. Format</a></span></dt><dt><span class="sect2"><a href="#application-mode">5.2.6. Mode</a></span></dt><dd><dl><dt><span class="sect3"><a href="#page-auto-loading">5.2.6.1. Page Auto Loading</a></span></dt><dt><span class="sect3"><a href="#click-logging">5.2.6.2. Click and Velocity Logging</a></span></dt></dl></dd><dt><span class="sect2"><a href="#application-controls">5.2.7. Controls</a></span></dt></dl></dd><dt><span class="sect1"><a href="#auto-deployed-files">5.3. Auto Deployed Files</a></span></dt><dd><dl><dt><span class="sect2"><a href="#deploying-restricted-env">5.3.1. Deploying resources in a restricted environment</a></span></dt><dt><span class="sect2"><a href="#deploying-custom-resources">5.3.2. Deploying Custom Resources</a></span></dt></dl></dd></dl></div><p>This section discusses how to setup and configure an Apache Click web
  application.
  </p><p>The Click configuration files include:
  </p><div class="informaltable"><table style="border: none;"><colgroup><col><col></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; ">
            <span class="inlinemediaobject"><img src="images/configuration/config-files.png"></span>
          </td><td style="">
            <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> WEB-INF/
                  <a class="link" href="#application-configuration" title="5.2.&nbsp;Application Configuration">click.xml</a>
                    &nbsp; - &nbsp; Application Configuration (
                  <span class="bold"><strong>required</strong></span>)
                </p></li><li class="listitem"><p> WEB-INF/
                  <a class="link" href="#servlet-configuration" title="5.1.&nbsp;Servlet Configuration">web.xml</a>
                    &nbsp; - &nbsp; Servlet Configuration (
                  <span class="bold"><strong>required</strong></span>)
                </p></li></ul></div>
          </td></tr></tbody></table></div><div class="sect1" title="5.1.&nbsp;Servlet Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="servlet-configuration"></a>5.1.&nbsp;Servlet Configuration</h2></div></div></div><p>For a Click web application to function the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ClickServlet.html" target="_blank">ClickServlet</a>
    must be configured in the web application's <code class="filename">/WEB-INF/web.xml</code>
    file. A basic web application which maps all <code class="literal">*.htm</code> requests
    to a ClickServlet is provided below.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-app&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-class&gt;</span>org.apache.click.ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-class&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;load-on-startup&gt;</span>0<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/load-on-startup&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-mapping&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span>*.htm<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-mapping&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-app&gt;</span></pre><div class="sect2" title="5.1.1.&nbsp;Servlet Mapping"><div class="titlepage"><div><div><h3 class="title"><a name="servlet-mapping"></a>5.1.1.&nbsp;Servlet Mapping</h3></div></div></div><p>By convention all Click page templates should have an .htm extension,
      and the ClickServlet should be mapped to process all *.htm URL requests.
      With this convention you have all the static HTML pages use an .html extension
      and they will not be processed as Click pages.
      </p></div><div class="sect2" title="5.1.2.&nbsp;Load On Startup"><div class="titlepage"><div><div><h3 class="title"><a name="load-on-startup"></a>5.1.2.&nbsp;Load On Startup</h3></div></div></div><p>Note you should always set <code class="literal">load-on-startup</code> element
      to be 0 so the servlet is initialized when the server is started. This will
      prevent any delay for the first client which uses the application.
      </p><p>The <code class="classname">ClickServlet</code> performs as much work as possible
      at startup to improve performance later on. The Click start up and caching
      strategy is configured with the Click application mode element in the
      "<code class="filename">click.xml</code>" config file, covered next.
      </p></div><div class="sect2" title="5.1.3.&nbsp;Type Converter Class"><div class="titlepage"><div><div><h3 class="title"><a name="type-converter-class"></a>5.1.3.&nbsp;Type Converter Class</h3></div></div></div><p>The ClickServlet uses the OGNL library for type coercion when binding
      request parameters to bindable variables. The default type converter class
      used is <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="click-api/org/apache/click/util/RequestTypeConverter.html" target="_blank">RequestTypeConverter</a>.
      To specify your own type converter configure a <code class="literal">type-converter-class</code>
      init parameter with the ClickServlet. For example:
      </p><pre class="programlisting">
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-class&gt;</span>org.apache.click.ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-class&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;load-on-startup&gt;</span>0<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/load-on-startup&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;init-param&gt;</span>
	    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;param-name&gt;</span>type-converter-class<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/param-name&gt;</span>
	    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;param-value&gt;</span>com.mycorp.util.CustomTypeConverter<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/param-value&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/init-param&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet&gt;</span></pre></div><div class="sect2" title="5.1.4.&nbsp;Config Service Class"><div class="titlepage"><div><div><h3 class="title"><a name="config-service-class"></a>5.1.4.&nbsp;Config Service Class</h3></div></div></div><p>Click uses a single application configuration service which is
      instantiated by the ClickServlet at startup. This service defines the
      application configuration and is used by the ClickServlet to map requests
      to pages amongst other things.
      </p><p>Once the ConfigService has been initialized it is stored in the
      ServletContext using the key  <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="click-api/org/apache/click/service/ConfigService.html" target="_blank">ConfigService</a>
      The default ConfigService is <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="click-api/org/apache/click/service/XmlConfigService.html" target="_blank">XmlConfigService</a>,
      which configuration is discussed in detail in the next section.
 	    </p><p>To use an alternative configuration service specify a
      <code class="literal">config-service-class</code> context parameter. For example:
 	    </p><pre class="programlisting">
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-app</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">xmlns</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"http://java.sun.com/xml/ns/j2ee"</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">xmlns:xsi</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"http://www.w3.org/2001/XMLSchema-instance"</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">xsi:schemaLocation</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">version</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"2.4"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>

 ...

     <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;context-param&gt;</span>
         <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;param-name&gt;</span>config-service-class<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/param-name&gt;</span>
          <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;param-value&gt;</span>com.mycorp.service.CustomConfigSerivce<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/param-value&gt;</span>
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/context-param&gt;</span>

  ...

 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-app&gt;</span></pre></div></div><div class="sect1" title="5.2.&nbsp;Application Configuration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="application-configuration"></a>5.2.&nbsp;Application Configuration</h2></div></div></div><p> The heart of a Click application is the <code class="filename">click.xml</code>
    configuration file. This file specifies the application pages, headers, the
    format object and the applications mode.
    </p><p>By default the ClickServlet will attempt to load the application
    configuration file using the path: &nbsp; <code class="filename">/WEB-INF/click.xml</code>
    </p><p>If this file is not found under the <code class="literal">WEB-INF</code> directory,
    then ClickServlet will attempt to load it from the classpath as
    <code class="filename">/click.xml</code>.
    </p><p>See <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-dtd.html" target="_blank">Click DTD</a> for the click-app
    XML definition.
    </p><p>A complete Click configuration example is available
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-dtd-example.html" target="_blank">here</a> which can be used as a quick
    reference when configuring Click.
    </p><p>A basic Click app config file is provided below:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!-- Specify the Java package where Page classes can be found --&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;mode</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"profile"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>An advanced config file would look like this:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">charset</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"UTF-8"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">locale</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"de"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!-- To aid Click's automapping, specify the Java package where Page classes can be found --&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.banking.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!-- We have to manually define the mapping between the Home page class and index.htm template
  because this page doesn't follow the automatic mapping convention of naming the page class and
  template the same--&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"index.htm"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.banking.page.Home"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!-- Specify a second Java package where Page classes can be found --&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.common.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;format</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.util.Format"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;mode</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"profile"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;log-service</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"org.apache.click.extras.service.Log4JLogService"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>The take away point is that there is not much to configure, even for
    advanced uses.
    </p><div class="sect2" title="5.2.1.&nbsp;Click App"><div class="titlepage"><div><div><h3 class="title"><a name="click-app"></a>5.2.1.&nbsp;Click App</h3></div></div></div><p>The root <span class="symbol">click-app</span> element defines two application
      localization attributes <code class="varname">charset</code> and <code class="varname">locale</code>.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">click-app</span>&nbsp;(pages*,&nbsp;headers?,&nbsp;format?,&nbsp;mode?,&nbsp;controls?,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file-upload-service?,&nbsp;log-service?,&nbsp;messages-map-service?,&nbsp;resource-service?,&nbsp;template-service?,&nbsp;page-interceptor*)&gt;<br>
&nbsp;&nbsp;&lt;!ATTLIST&nbsp;click-app&nbsp;<code class="varname">charset</code>&nbsp;CDATA&nbsp;#IMPLIED&gt;<br>
&nbsp;&nbsp;&lt;!ATTLIST&nbsp;click-app&nbsp;<code class="varname">locale</code>&nbsp;CDATA&nbsp;#IMPLIED&gt;</p></div><p>The <code class="varname">charset</code> attribute defines the character encoding
      set for:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Velocity templates</p></li><li class="listitem"><p>HttpServletRequest character encoding</p></li><li class="listitem"><p>Page Content-Type charset, see Page
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getContentType()" target="_blank">getContentType()</a>
          </p></li></ul></div><p>The <code class="varname">locale</code> attribute defines the default application
      Locale. If this value is defined it will override Locale returned by the request.
      Please see the Context
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Context.html#getLocale()" target="_blank">getLocale()</a>
      for details. For example the following configuration sets the application
      character set to UTF-8 and the default Locale as German (de):
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">charset</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"UTF-8"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">locale</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"de"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
  ..
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre></div><div class="sect2" title="5.2.2.&nbsp;Pages"><div class="titlepage"><div><div><h3 class="title"><a name="application-pages"></a>5.2.2.&nbsp;Pages</h3></div></div></div><p>The first child element of the click-app is the mandatory
      <code class="literal">pages</code> element which defines the list of Click pages.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<code class="varname">pages</code>&nbsp;(<span class="symbol">page</span>*)&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;pages&nbsp;<code class="varname">package</code>&nbsp;CDATA&nbsp;#IMPLIED&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;pages&nbsp;<code class="varname">automapping</code>&nbsp;(true|false)&nbsp;"true"&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;pages&nbsp;<code class="varname">autobinding</code>&nbsp;(default|annotation|none)&nbsp;"default"&gt;</p></div><p>The pages element can specify a base <code class="varname">package</code>
      that Click should use for mapping page templates to page classes.
      </p><p>The pages element also defines the <code class="varname">automapping</code> and
      <code class="varname">autobinding</code> attributes which is discussed in the
      <a class="link" href="#application-automapping" title="5.2.3.1.&nbsp;Page Automapping">Page Automapping</a> and
      <a class="link" href="#application-autobinding" title="5.2.3.3.&nbsp;Page Autobinding">Page Autobinding</a> sections
      respectively.
      </p><div class="sect3" title="5.2.2.1.&nbsp;Multiple Pages Packages"><div class="titlepage"><div><div><h4 class="title"><a name="application-multiple-packages"></a>5.2.2.1.&nbsp;Multiple Pages Packages</h4></div></div></div><p>Click can support multiple pages elements to enable the automapping
        of multiple packages.
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.banking.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.common.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>With multiple pages elements, pages are loaded in the order of the page
            elements, with manual page elements being loaded before automapped pages.
            Once a page template has been mapped to a Page class it will not be replaced
            by a subsequent potential match. So pages elements at the top take priority
            over lower pages elements.
        </p></div></div><div class="sect2" title="5.2.3.&nbsp;Page"><div class="titlepage"><div><div><h3 class="title"><a name="application-page"></a>5.2.3.&nbsp;Page</h3></div></div></div><p>The page element defines the Click application pages.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">page</span>(<code class="varname">header</code>*)&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;page&nbsp;<code class="varname">path</code>&nbsp;CDATA&nbsp;#REQUIRED&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;page&nbsp;<code class="varname">classname</code>&nbsp;CDATA&nbsp;#REQUIRED&gt;</p></div><p>Each page <code class="varname">path</code> must be unique, as the Click
      application maps HTTP requests to the page paths.
      </p><p>The Click application will create a new Page instance for
      the given request using the configured page <code class="varname">classname</code>.
      All pages must subclass
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html" target="_blank">Page</a> and provide
      a public no arguments constructor, so they can be instantiated.
      </p><p>Pages can also define <code class="varname">header</code> values which are
      discussed in the next topic.
      </p><p>When the Click application starts up it will check all the page
      definitions. If there is a critical configuration error the ClickSerlvet
      will log an <code class="literal">ERROR</code> message and throw an
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/UnavailableException.html" target="_blank">UnavailableException</a>.
      If this occurs the click application will be permanently unavailable until
      the error is fixed and the web app is restarted.
      </p><div class="sect3" title="5.2.3.1.&nbsp;Page Automapping"><div class="titlepage"><div><div><h4 class="title"><a name="application-automapping"></a>5.2.3.1.&nbsp;Page Automapping</h4></div></div></div><p> Page automapping will automatically configure application pages
        using a simple set of rules. This enables you to greatly streamline your
        configuration file as you only need to define pages which don't fit
        the automapping rules.
        </p><p>Automapping will attempt to associate each page template (*.htm)
        and JSP file in the web application (excluding those under WEB-INF) to a
        Page class. Automapped pages are loaded after the manually defined pages
        are loaded, and manually defined pages takes preference.
        When automapping is enabled the page mappings will be logged if Click is
        running in debug or trace mode.
        </p><p>For example, given the following page path to class mapping:
        </p><div class="literallayout"><p>index.htm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span class="token">com.mycorp.page.Home</span><br>
search.htm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span class="token">com.mycorp.page.Search</span><br>
contacts/contacts.htm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span class="token">com.mycorp.page.contacts.Contacts</span><br>
security/login.htm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span class="token">com.mycorp.page.security.Login</span><br>
security/logout.htm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;<span class="token">com.mycorp.page.security.Logout</span><br>
security/change-password.htm&nbsp;&nbsp;=&gt;&nbsp;<span class="token">com.mycorp.page.security.ChangePassword</span></p></div><p>The above mapping could be configured manually by setting the
        <span class="symbol">automapping</span> attribute to <code class="literal">false</code>,
        for example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">automapping</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"false"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"index.htm"</span>                    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page.Home</span>"/&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"search.htm"</span>                   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page.Search</span>"/&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"contacts/contacts.htm"</span>        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page.contacts.Contacts</span>"/&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"security/login.htm"</span>           <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page.security.Login</span>"/&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"security/logout.htm"</span>          <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page.security.Logout</span>"/&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"security/change-password.htm"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page.security.ChangePassword</span>"/&gt;
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>For an application with many pages, it is cumbersome to manually map
        each page template to its associated class. This is where
        <span class="symbol">automapping</span> comes in.
        </p><p>By setting <span class="symbol">automapping</span> to <code class="literal">true</code>,
        Click will automatically map page templates to page classes. To map a
        template to a page class, Click converts the template path to the Page
        classname. In the example above, Click will convert the template
        <span class="token">search.htm</span> to the class <span class="token">Search</span> by
        capitilizing the template name and removing the <code class="literal">.htm</code>
        extension. Of course this is not enough to map the template to the class.
        what is missing is the class package, <span class="token">com.mycorp.page</span>.
        To help Click map the page, you can set the base <code class="literal">package</code>
        attribute as shown in the next example.
        </p><p>Below is the full configuration to automatically map the templates
        to pages (except for index.htm which doesn't automatically map to Home
        page and has to be mapped manually):
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><span class="token">com.mycorp.page</span>" <span class="symbol">automapping</span>="true"&gt;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"index.htm"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page.Home"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>Note: <span class="symbol">automapping</span> is <code class="literal">true</code> by
        default, so it could be omitted.
        </p><p>If a page template is placed in a <code class="literal">sub folder</code>
        of the root web folder, it's associated page class must be placed in an
        equivalently named <code class="literal">sub package</code> of the base package in
        order for the page to be mapped automatically. In the mapping above the
        page template <span class="token">security/change-password.htm</span> is located in
        the <span class="token">security</span> folder under the web root. In order for Click
        to correctly map the page template to it's class, the class must be
        located in the <span class="token">security</span> package of the
        base package <span class="token">com.mycorp.page</span>. The absolute page classname
        is thus: <span class="token">com.mycorp.page.security.ChangePassword</span>.
        </p><p>The page template name to classname convention is:
        </p><div class="literallayout"><p>change-password.htm&nbsp;&nbsp;=&gt;&nbsp;&nbsp;<span class="token">ChangePassword</span><br>
change_password.htm&nbsp;&nbsp;=&gt;&nbsp;&nbsp;<span class="token">ChangePassword</span><br>
changePassword.htm&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;<span class="token">ChangePassword</span><br>
ChangePassword.htm&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;<span class="token">ChangePassword</span></p></div><p>During automapping, if a page class cannot be found, Click will
        add the 'Page' suffix to the classname (if not already present) and
        attempt to map the page template to this modified classname. For example:
        </p><div class="literallayout"><p>customer.htm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;<span class="token">CustomerPage</span><br>
change-password.htm&nbsp;&nbsp;=&gt;&nbsp;&nbsp;<span class="token">ChangePasswordPage</span></p></div></div><div class="sect3" title="5.2.3.2.&nbsp;Automapping Excludes"><div class="titlepage"><div><div><h4 class="title"><a name="application-excludes"></a>5.2.3.2.&nbsp;Automapping Excludes</h4></div></div></div><p>With Page automapping there can be resources where you don't want
        automapping applied. For example when using a JavaScript library with lots
        of <code class="literal">.htm</code> files, you don't want automapping to try and
        find Page class for each of these files. In these situations you can use
        the pages <span class="symbol">excludes</span> element.
        </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">excludes</span>&nbsp;(#PCDATA)&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;excludes&nbsp;<code class="varname">pattern</code>&nbsp;CDATA&nbsp;#REQUIRED&gt;</p></div><p>For example if our application uses the TinyMCE JavaScript library
        we could configure our pages automapping to exclude all <code class="literal">.htm</code>
        files under the <code class="literal">/tiny_mce</code> directory.
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span class="symbol">&lt;excludes</span> pattern="<code class="varname">/tiny_mce/*</code>"/&gt;
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>The excludes pattern can specify multiple directories or files using a
          comma separated notation. For example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span class="symbol">&lt;excludes</span> pattern="<code class="varname">/dhtml/*, /tiny_mce/*, banner.htm, about.htm</code>"/&gt;
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>HTM files excluded from Page automapping are handled by an internal
        Page class with caching headers enabled.
        </p></div><div class="sect3" title="5.2.3.3.&nbsp;Page Autobinding"><div class="titlepage"><div><div><h4 class="title"><a name="application-autobinding"></a>5.2.3.3.&nbsp;Page Autobinding</h4></div></div></div><p>Autobinding is a feature that allows certain page variables to be
        handled in a special way by the ClickServlet. The autobinding attribute
        can be configured with one of the following values:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> <code class="varname">default</code>: <code class="literal">bindable</code>
            variables include both <code class="varname">public</code> page variables
            and variables annotated with the
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/Bindable.html" target="_blank">@Bindable</a>
            annotation
            </p></li><li class="listitem"><p> <code class="varname">annotation</code>: <code class="literal">bindable</code>
            variables are variables annotated with the
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/Bindable.html" target="_blank">@Bindable</a>
            annotation
            </p></li><li class="listitem"><p> <code class="varname">none</code>: disables the autobinding feature
            </p></li></ul></div><p>
        </p><p>By default all pages have autobinding enabled in
        <code class="varname">default</code> mode.
        </p><p><span class="bold"><strong>Please note:</strong></span> we recommend using
        autobinding only for binding request parameters, not for Controls. It
        generally leads to code that is difficult to maintain. In a future release
        we will replace autobinding with a simpler implementation.
        </p><p>With autobinding the ClickServlet will
        automatically:
        </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> add all <code class="literal">bindable</code> controls to the page,
            after the page constructor has been invoked
            </p></li><li class="listitem"><p> if a <code class="literal">bindable</code> control name is not defined,
            the control name will be set to the value of its variable name (note,
            if the control name is already defined its name will not be changed)
            </p></li><li class="listitem"><p> bind all request parameters to <code class="literal">bindable</code>
            page variables, after the page constructor has been invoked. See
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/ClickServlet.html#processPageRequestParams(org.apache.click.Page)" target="_blank">ClickServlet.processPageRequestParams(Page)</a>
            for more details
            </p></li><li class="listitem"><p> add all <code class="literal">bindable</code> page variables to the page
            model (this step occurs just before the page is rendered)</p></li></ul></div><p>For example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> EmployeePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String employeeDescription;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Form does not have a name defined</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Form employeeForm = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Table defines its own name</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Table employeeTable = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Table(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"table"</span>);

}</pre><p>Note in the example above that the <code class="varname">employeeDescription</code>
        variable and the <code class="varname">employeeForm</code> and <code class="varname">employeeTable</code>
        controls are not added to the page. Also note that Form name is not
        defined.
        </p><p>When autobinding is enabled, ClickServlet will create a new Page
        and add the bindable variables and controls to the page. Following the
        example above the <code class="varname">employeeDescription</code>,
        <code class="varname">employeeForm</code> and <code class="varname">employeeTable</code> will
        be added to the page, which is equivalent to the following statements:
        <code class="methodname">addModel("employeeDescription", employeeDescription)</code>,
        <code class="methodname">addControl(employeeForm)</code> and
        <code class="methodname">addControl(employeeTable)</code>.
        </p><p>Furthermore, controls that do not have a name defined will
        have their name set to their instance variable name. In this
        case the Form name will be set to <code class="varname">employeeForm</code> while
        the Table name won't be altered since it already has a name defined.
        </p><p>The above example is a shorthand way of writing the following:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> EmployeePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> String employeeDescription;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form employeeForm = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Table employeeTable = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Table(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"table"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        employeeForm.setName(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"employeeForm"</span>);
        addControl(employeeForm);

        addControl(myTable);
    }
}</pre><p>Note that we did not show where employeeDescription is added
        to the page model. The reason for that is because autobinding handles non
        controls slightly differently. Non control variables are added to the
        model just before the page response is written. This allows the value of
        the variable to be set anywhere in the page. For example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> EmployeePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> String employeeDescription;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form employeeForm = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Table employeeTable = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Table(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"table"</span>);

    ...

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onSaveClick {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (employeeForm.isValid()) {
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// employeeDescription is added to the page model just before the</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// response is written</span>
            employeeDescription = employee.getDescription();
        }
    }
} </pre><p><code class="varname">employeeDescription</code> will be added to the page
        model and can be referenced in the page template as
        <span class="symbol">$employeeDescription</span>.
        </p><p>Autobinding can be turned off by setting the <span class="symbol">autobinding</span>
        attribute to <code class="varname">none</code> as shown below:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span> <span class="symbol">autobinding</span>="<code class="varname">none</code>"/&gt;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre></div><div class="sect3" title="5.2.3.4.&nbsp;Page Autobinding - Using Annotations"><div class="titlepage"><div><div><h4 class="title"><a name="application-autobinding-annotation"></a>5.2.3.4.&nbsp;Page Autobinding - Using Annotations</h4></div></div></div><p>Click provides the
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/Bindable.html" target="_blank">Bindable</a>
        annotation which enables autobinding of Page variables The Bindable
        annotation can bind <code class="varname">private</code>, <code class="varname">protected</code>
        and <code class="varname">public</code> Page variables.
        </p><p>By default, Click's autobinding feature operates on both
        <span class="symbol">public</span> and <span class="symbol">@Bindable</span> variables.
        To instruct Click to operate only on <span class="symbol">@Bindable</span>
        annotated variables, you can set the <span class="symbol">autobinding</span>
        attribute to <code class="varname">annotation</code>, for example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span> <span class="symbol">autobinding</span>="<code class="varname">annotation</code>"/&gt;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>Click won't autobind <code class="literal">public</code> variables anymore.
        </p><p>Below is an example using the <span class="symbol">@Bindable</span>
        annotation:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> EmployeePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span class="symbol">@Bindable</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Form employeeForm = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form();

    <span class="symbol">@Bindable</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Table myTable = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Table();

}</pre></div></div><div class="sect2" title="5.2.4.&nbsp;Headers"><div class="titlepage"><div><div><h3 class="title"><a name="application-headers"></a>5.2.4.&nbsp;Headers</h3></div></div></div><p>The optional <code class="literal">headers</code> element defines a list of
      <code class="literal">header</code> elements which are applied to all pages.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<code class="varname">headers</code>&nbsp;(<span class="symbol">header</span>*)&gt;</p></div><p>The <span class="symbol">header</span> element defines header name and value
      pairs which are applied to the
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletResponse.html" target="_blank">HttpServletResponse</a>.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">header</span>&nbsp;(#PCDATA)&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;header&nbsp;<code class="varname">name</code>&nbsp;CDATA&nbsp;#REQUIRED&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;header&nbsp;<code class="varname">value</code>&nbsp;CDATA&nbsp;#REQUIRED&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;header&nbsp;<code class="varname">type</code>&nbsp;(String|Integer|Date)&nbsp;"String"&gt;</p></div><p>Page headers are set after the Page has been constructed and before
      <code class="methodname">onInit()</code> is called. Pages can then modify their
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#headers" target="_blank">headers</a>
      property using the
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#setHeader(java.lang.String,%20java.lang.Object)" target="_blank">setHeader()</a>
      method.
      </p><div class="sect3" title="5.2.4.1.&nbsp;Browser Caching"><div class="titlepage"><div><div><h4 class="title"><a name="browser-caching"></a>5.2.4.1.&nbsp;Browser Caching</h4></div></div></div><p>Headers are typically used to switch off browser caching. By
        default Click will use the following no caching header values if you don't
        define a <code class="literal">headers</code> element in your application:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages&gt;</span>
     ..
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;headers&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Pragma"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"no-cache"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Cache-Control"</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"no-store, no-cache, must-revalidate, post-check=0, pre-check=0"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Expires"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"1"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Date"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/headers&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>Alternatively you can define your headers individually in pages or
        for all application pages by setting header values. For example, to
        switch off caching in the <code class="literal">Login</code> page, set the
        following page cache control headers:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"login.htm"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page.Login"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Pragma"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"no-cache"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Expires"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"1"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Date"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/page&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span></pre><p>Note: the value for a Date type should be a long number value.
        </p><p>If you wanted to enable caching for a particular page you could set
        the following page cache control header. This will mark the page as cachable
        for a period of 1 hour after which it should be reloaded.
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"home.htm"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page.Home"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Cache-Control"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"max-age=3600, public, must-revalidate"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/page&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span></pre><p>To apply header values globally define header values in the headers
        element. For example:
        </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages&gt;</span>
     ..
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;headers&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Pragma"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"no-cache"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Cache-Control"</span>
               <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"no-store, no-cache, must-revalidate, post-check=0, pre-check=0"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;header</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Expires"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">value</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"1"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Date"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/headers&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre></div></div><div class="sect2" title="5.2.5.&nbsp;Format"><div class="titlepage"><div><div><h3 class="title"><a name="application-format"></a>5.2.5.&nbsp;Format</h3></div></div></div><p>The optional <code class="literal">format</code> element defines the Format
      object classname which is applied to all pages.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">format</span>&nbsp;(#PCDATA)&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ATTLIST&nbsp;format&nbsp;<code class="varname">classname</code>&nbsp;CDATA&nbsp;"org.apache.click.util.Format"&gt;</p></div><p>By default all Click pages are configured with a
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/Format.html" target="_blank">org.apache.click.util.Format</a>
      object. The format object is made available in the Velocity page templates
      using the name <code class="varname">$format</code>.
      </p><p>To specify a custom format class configure a <code class="literal">format</code>
      element in the click-app descriptor. For example:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  ..
  <span class="symbol">&lt;format</span> classname="<code class="varname">com.mycorp.util.CustomFormat</code>"/&gt;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre></div><div class="sect2" title="5.2.6.&nbsp;Mode"><div class="titlepage"><div><div><h3 class="title"><a name="application-mode"></a>5.2.6.&nbsp;Mode</h3></div></div></div><p>The optional <code class="literal">mode</code> element defines the application
      logging and caching mode.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">mode</span>&nbsp;(#PCDATA)&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ATTLIST&nbsp;mode&nbsp;value&nbsp;(<code class="varname">production|profile|development|debug|trace</code>)&nbsp;"development"&gt;</p></div><p>By default Click applications run in <code class="literal">development</code> mode,
      which switches off page template caching, and the logging level is set to
      <code class="literal">INFO</code>.
      </p><p>To change the default application mode configure a mode element in the
      click-app descriptor. For example to specify <code class="literal">production</code>
      mode you would add the following mode element:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  ..
  <span class="symbol">&lt;mode</span> value="<code class="varname">production</code>"&gt;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>The application mode configuration can be overridden by setting the
      system property <code class="literal">"click.mode"</code>. This can be use in the scenario
      of debugging a problem on a production system, where you change the mode to
      <code class="literal">trace</code> by setting the following system property and
      restarting the application.
      </p><div class="literallayout"><p>-Dclick.mode=trace</p></div><p>The Click Application modes and their settings for Page auto loading,
      template caching and logging levels are:
      </p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col><col><col><col><col></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                <p>
                  Application mode
                </p>
              </th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                <p>
                  Page auto loading
                </p>
              </th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                <p>
                  Template caching
                </p>
              </th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
                <p>
                  Click log level
                </p>
              </th><th style="border-bottom: 0.5pt solid ; ">
                <p>
                  Velocity log level
                </p>
              </th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>
                  <span class="bold"><strong>production</strong></span>
                </p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>No</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>Yes</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>WARN</p>
              </td><td style="border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>ERROR</p>
              </td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>
                  <span class="bold"><strong>profile</strong></span>
                </p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>No</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>Yes</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>INFO</p>
              </td><td style="border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>ERROR</p>
              </td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>
                  <span class="bold"><strong>development</strong></span>
                </p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>Yes</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>No</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>INFO</p>
              </td><td style="border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>ERROR</p>
              </td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>
                  <span class="bold"><strong>debug</strong></span>
                </p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>Yes</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>No</p>
              </td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>DEBUG</p>
              </td><td style="border-bottom: 0.5pt solid ; " align="center" valign="middle">
                <p>ERROR</p>
              </td></tr><tr><td style="border-right: 0.5pt solid ; " align="center" valign="middle">
                <p>
                  <span class="bold"><strong>trace</strong></span>
                </p>
              </td><td style="border-right: 0.5pt solid ; " align="center" valign="middle">
                <p>Yes</p>
              </td><td style="border-right: 0.5pt solid ; " align="center" valign="middle">
                <p>No</p>
              </td><td style="border-right: 0.5pt solid ; " align="center" valign="middle">
                <p>TRACE</p>
              </td><td style="" align="center" valign="middle">
                <p>WARN</p>
              </td></tr></tbody></table></div><div class="sect3" title="5.2.6.1.&nbsp;Page Auto Loading"><div class="titlepage"><div><div><h4 class="title"><a name="page-auto-loading"></a>5.2.6.1.&nbsp;Page Auto Loading</h4></div></div></div><p>When Page Auto Loading is enabled any new page templates and classes
        will be automatically loaded at runtime. These pages are loaded using the
        <a class="link" href="#application-automapping" title="5.2.3.1.&nbsp;Page Automapping">Page Automapping</a> rules.
        </p><p>Page auto loading is a very handy feature for rapid development as
        you do not have to restart you application server to pick up new pages.
        </p></div><div class="sect3" title="5.2.6.2.&nbsp;Click and Velocity Logging"><div class="titlepage"><div><div><h4 class="title"><a name="click-logging"></a>5.2.6.2.&nbsp;Click and Velocity Logging</h4></div></div></div><p>The Click and Velocity runtimes use
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/LogService.html" target="_blank">LogService</a>
        for logging messages. The default LogService implementation is
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/ConsoleLogService.html" target="_blank">ConsoleLogService</a>
        which will send messages to the console [System.out]. For example the
        following logging output is for a HomePage request when the application
        mode is <code class="literal">trace</code>:
        </p><div class="literallayout"><p>[Click]&nbsp;[debug]&nbsp;GET&nbsp;http://localhost:8080/quickstart/home.htm<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;HomePage.&lt;&lt;init&gt;&gt;<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;HomePage.onSecurityCheck()&nbsp;:&nbsp;true<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;HomePage.onInit()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;HomePage.onGet()<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;HomePage.onRender()<br>
[Click]&nbsp;[info&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;renderTemplate:&nbsp;/home.htm&nbsp;-&nbsp;6&nbsp;ms<br>
[Click]&nbsp;[trace]&nbsp;&nbsp;&nbsp;&nbsp;invoked:&nbsp;HomePage.onDestroy()<br>
[Click]&nbsp;[info&nbsp;]&nbsp;handleRequest:&nbsp;&nbsp;/home.htm&nbsp;-&nbsp;24&nbsp;ms</p></div><p>Any unhandled <code class="literal">Throwable</code> errors are logged by the
        ClickServlet.
        </p><p>Note that Click Extras also provide log adaptors for
        <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/service/Log4JLogService.html" target="_blank">Log4J</a>
        and the <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/service/JdkLogService.html" target="_blank">JDK Logging API</a>.
        </p><p>When an application is not in <code class="literal">production</code> mode the
        error page displays detailed debugging information. When the application
        mode is <code class="literal">production</code> no debug information is displayed to
        prevent sensitive information being revealed. This behaviour can be changed
        by modifying the deployed <code class="filename">click/error.htm</code> page template.
        </p></div></div><div class="sect2" title="5.2.7.&nbsp;Controls"><div class="titlepage"><div><div><h3 class="title"><a name="application-controls"></a>5.2.7.&nbsp;Controls</h3></div></div></div><p>The optional <code class="literal">controls</code> element defines a list of
      <code class="literal">control</code> elements which will be deployed on application
      startup.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<code class="varname">controls</code>&nbsp;(<span class="symbol">control</span>*)&gt;</p></div><p>The <span class="symbol">control</span> registers
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html" target="_blank">Control</a> classes
      which will have their <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onDeploy(javax.servlet.ServletContext)" target="_blank">onDeploy()</a>
      method invoked when the click application starts.
      </p><div class="literallayout"><p>&lt;!ELEMENT&nbsp;<span class="symbol">control</span>&nbsp;(#PCDATA)&gt;<br>
&nbsp;&nbsp;&nbsp;&lt;!ATTLIST&nbsp;control&nbsp;<code class="varname">classname</code>&nbsp;CDATA&nbsp;#REQUIRED&gt;</p></div><p>For example to have a <code class="classname">CustomField</code> control
      deploy its resources on application startup, you would add the following
      elements to your <code class="filename">click.xml</code> file:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
   ..

   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;controls&gt;</span>
     <span class="symbol">&lt;control</span> classname="<code class="varname">com.mycorp.control.CustomField</code>"/&gt;
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/controls&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre></div></div><div class="sect1" title="5.3.&nbsp;Auto Deployed Files"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="auto-deployed-files"></a>5.3.&nbsp;Auto Deployed Files</h2></div></div></div><p>To make pre-configured resources (templates, stylesheets, etc.)
    available to web applications, Click automatically deploys configured
    classpath resources to the <code class="varname">/click</code> directory at startup
    (if not already present).
    </p><p>You can modify these support files and Click will
    <span class="bold"><strong>not</strong></span> overwrite them. These files include:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> click/error.htm &nbsp; - &nbsp; the Page
          <a class="link" href="#page-error-handling" title="2.10.&nbsp;Error Handling">Error Handling</a> template
        </p></li><li class="listitem"><p> click/control.css &nbsp; - &nbsp; the Controls cascading stylesheet</p></li><li class="listitem"><p> click/control.js &nbsp; - &nbsp; the Controls JavaScript library</p></li><li class="listitem"><p> click/not-found.htm &nbsp; - &nbsp; the
          <a class="link" href="#page-not-found" title="2.11.&nbsp;Page Not Found">Page Not Found</a> template
        </p></li></ul></div><p>For example to customize the control styles you can place a customized
    copy (or even a brand new version) of <code class="filename">control.css</code> under
    the <code class="varname">/click</code> folder in your web project:
    </p><div class="literallayout"><p>/webapp/click/control.css</p></div><p>When Click starts up it will <span class="bold"><strong>not</strong></span>
    override your copy of <code class="filename">control.css</code> with its own default
    version.
    </p><p>Different controls might deploy different stylesheet, javascript or image
    files, however the above principle still applies. By placing a customized copy
    of the stylesheet, javascript or image under the <code class="varname">/click</code> folder,
    you will override the default resource.
    </p><p>Be aware that some of the more complex controls (checklist, colorpicker,
    tree), deploys resources to subfolders under <code class="varname">/click</code>, for
    example <code class="literal">/click/checklist/*</code>.
    </p><p>A control's Javadoc will normally indicate what resources are deployed
    for that control.
    </p><div class="sect2" title="5.3.1.&nbsp;Deploying resources in a restricted environment"><div class="titlepage"><div><div><h3 class="title"><a name="deploying-restricted-env"></a>5.3.1.&nbsp;Deploying resources in a restricted environment</h3></div></div></div><p>Some environments place restrictions on the file system and
      Click won't be able to deploy its resources. WebLogic and
      Google App Engine are examples of such environments. (Note that WebLogic has
      a property to allow access to the file system. From the Admin Console go
      to the <span class="emphasis"><em>Server node &gt; Web Applications</em></span>
      tab and check the <span class="emphasis"><em>Archived Real Path Enabled</em></span> parameter.)
      </p><p>If Click cannot deploy its resources because of limited file system
      access or permissions, warning messages will be logged.
      </p><p><span class="bold"><strong>Note: </strong></span>if your application is
      running on a <span class="emphasis"><em>Servlet 3.0</em></span> compliant server, there is
      no need to deploy resources. Servlet 3.0 specifies that if the server
      cannot find a resource in the root directory of the webapp, it will look
      for the resource under <span class="emphasis"><em>'META-INF/resources'</em></span>, and if
      found, serve it up. Click is Servlet 3.0 compliant and packages its
      resources under <span class="emphasis"><em>'META-INF/resources'</em></span>.
      </p><p>Click provides a number of options to make resources available
      in restricted environments which is covered below:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The first option (which will work in all environments) is to deploy
          the resources at build time. Click ships with an Ant Task
          called DeployTask that deploys Click static resources to a web
          application. With this option Click's static resources can be copied
          to the root directory of your webapp, where you can customize the
          resources further if needed. The DeployTask can easily be incorporated
          into your build script.
          </p><p>Currently the DeployTask is part of the <code class="filename">click-dev-tools-xxx.jar</code>
          that can be found in your Click distribution under the <span class="emphasis"><em>lib</em></span>
          folder.
          </p><p>Here is a basic example:
          </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;target</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"deploy"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">description</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Deploy static resources"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;taskdef</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"deploy"</span>
             <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"org.apache.click.tools.deploy.DeployTask"</span>
             <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classpath</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"&lt;click-distribution&gt;/lib/click-dev-tasks-1.1.jar"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span> <a class="co" name="co-click-distribution" href="#ca-click-distribution"><img src="images/callouts/1.gif" alt="1" border="0"></a>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;deploy</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">dir</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"&lt;webapp-root&gt;/WEB-INF"</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">todir</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"&lt;webapp-root&gt;"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span> <a class="co" name="co-webapp-root" href="#ca-webapp-root"><img src="images/callouts/2.gif" alt="2" border="0"></a>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/target&gt;</span> </pre><div class="calloutlist"><table border="0" summary="Callout list"><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-click-distribution"></a><a href="#co-click-distribution"><img src="images/callouts/1.gif" alt="1" border="0"></a> </td><td valign="top" align="left"><p><code class="literal">&lt;click-distribution&gt;</code> is the location
              where Click is installed on your machine, for example:
              <code class="literal">C:\software\click-2.1.0\</code>.
              </p></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td valign="top" align="left"><a name="ca-webapp-root"></a><a href="#co-webapp-root"><img src="images/callouts/2.gif" alt="2" border="0"></a> </td><td valign="top" align="left"><p><code class="literal">&lt;webapp-root&gt;</code> is the root directory
              of your webapp, for example: <code class="literal">C:\dev\my-webapp\</code>.
              </p></td></tr></table></div><p>We use the <span class="emphasis"><em>&lt;deploy&gt;</em></span> Ant Task and specify
          the attributes <code class="varname">dir</code> and <code class="varname">todir</code>.
          </p><p><code class="varname">dir</code> specifies the <span class="emphasis"><em>source</em></span>
          directory to scan for JARs and folders containing static resources,
          while <code class="varname">todir</code> specifies the <span class="emphasis"><em>target</em></span>
          directory where the resources should be copied to.
          </p><p><code class="varname">dir</code> should point to your web application's
          <span class="emphasis"><em>WEB-INF</em></span> folder, since that is where Click's JARs
          will be located. <code class="varname">todir</code> should point to your web
          application's root directory, since that is where Click's resources
          will be served from.
          </p><p>The DeployTask also supports nested
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://ant.apache.org/manual/CoreTypes/fileset.html" target="_blank">FileSets</a>
          if you need to deploy resources from multiple source locations. For
          example:</p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;target</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"deploy"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">description</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Deploy static resources"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;taskdef</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"deploy"</span>
             <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"org.apache.click.tools.deploy.DeployTask"</span>
             <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classpath</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"&lt;click-distribution&gt;/lib/click-dev-tasks-1.1.jar"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;deploy</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">todir</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"${dir.webapp}"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;fileset</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">dir</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"&lt;webapp-root&gt;/WEB-INF"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;include</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"**/classes"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;include</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"**/*.jar"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/fileset&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;fileset</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">dir</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"/some/folder/with/jars"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;include</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"lib-with-resources.jar"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;include</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"another-lib-with-resources.jar"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/fileset&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/deploy&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/target&gt;</span> </pre><p>The DeployTask also generates an HTML report in the same folder
          where the build script is executed from. The report will indicate
          which resources was deployed successfully and which resources
          in your webapp root directory is outdated. (An outdated resource means
          that the resource in the <span class="emphasis"><em>click-xxx.jar</em></span> differs
          from the resource currently present in your webapp root directory.
          This can happen when upgrading to a new version of Click)
          </p></li><li class="listitem"><p>Another option is to add a mapping in <span class="emphasis"><em>web.xml</em></span>
          to inform ClickServlet to serve static resources. This feature is made
          available through the
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/ResourceService.html" target="_blank">ResourceService</a>
          interface and its default implementation,
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/ClickResourceService.html" target="_blank">ClickResourceService</a>.
          Below is an example:
          </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-class&gt;</span>org.apache.click.ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-class&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;load-on-startup&gt;</span>0<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/load-on-startup&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-mapping&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span>*.htm<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-mapping&gt;</span>

 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">&lt;!-- Inform ClickServlet to serve static resources contained under the /click/*
       directory directly from Click's JAR files. --&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-mapping&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;servlet-name&gt;</span>ClickServlet<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-name&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span>/click/*<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/servlet-mapping&gt;</span></pre><p>With this setup, ClickServlet will serve all static
          <code class="varname">/click/*</code> resources directly from Click's JAR files.
          </p><p>One restriction of ClickResourceService is it only serves
          resources from the <span class="emphasis"><em>/click/*</em></span> folder. So if you use
          third-party Click libraries that serve their resources from a different
          folder e.g. <span class="emphasis"><em>/clickclick/*</em></span>, this option won't work
          out-of-the-box.
          </p><p>Also note that with this option Click's resources are served
          directly from the JAR files, you won't be able to customize the resources,
          if for example you want change the default styling through CSS.
          </p></li><li class="listitem"><p>Another option is to manually deploy the resources. Click
          resources are packaged in JARs under the directory
          <span class="emphasis"><em>META-INF/resources</em></span>. You can use your IDE
          to navigate into the JARs and copy all the resources from
          <span class="emphasis"><em>META-INF/resources</em></span> to your webapp root directory.
          </p><p>For example, to deploy the resources from
          <span class="emphasis"><em>click-core.jar</em></span>, copy the <span class="emphasis"><em>/click</em></span>
          folder and its contents to your web application root folder.
          </p></li><li class="listitem"><p>And finally you can access Click's resources by deploying your
          application on a development machine where there are no file system
          restrictions and the WAR/EAR can be unpacked. You can then copy the
          deployed resources to your webapp root directory.
          </p></li></ul></div></div><div class="sect2" title="5.3.2.&nbsp;Deploying Custom Resources"><div class="titlepage"><div><div><h3 class="title"><a name="deploying-custom-resources"></a>5.3.2.&nbsp;Deploying Custom Resources</h3></div></div></div><p> Click supports two ways of deploying pre-configured resources
      (templates, stylesheets, JavaScript etc.) from a Jar to a web application.
      (This assumes that the environment Click is running in supports having
      write access to the file system and that the WAR is unpacked.)
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p> Through a Control's
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Control.html#onDeploy(javax.servlet.ServletContext)" target="_blank">onDeploy()</a>
          event handler. See the <a class="link" href="#application-controls" title="5.2.7.&nbsp;Controls">Controls</a>
          section above.
          </p></li><li class="listitem"><p>By packaging the resources (stylesheets, JavaScript, Images etc.)
          into a special folder called <span class="emphasis"><em>'META-INF/resources'</em></span>.
          </p></li></ol></div><p>As option #1 was already discussed above in section
      <a class="link" href="#application-controls" title="5.2.7.&nbsp;Controls">Controls</a>, lets look at option #2.
      </p><p>When Click starts up, it scans each Jar and folder on the classpath
      for specially marked entries starting with 'META-INF/resources/'. (Please
      note that even though Click will scan the entire classpath it is strongly
      recommended to host your Jar files under your WAR lib folder e.g. WEB-INF/lib.
      Sharing Jars on the classpath can lead to class loading issues.)
      </p><p>Click will then copy all files found under 'META-INF/resources/' to
      the root directory of the webapp.
      </p><p>
      For example, given a Jar file with the following entries:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>META-INF/resources/mycorp/edit_customer.js</p></li><li class="listitem"><p>META-INF/resources/mycorp/edit_customer.css</p></li><li class="listitem"><p>mycorp/pages/EditCustomerPage.class</p></li></ul></div><p>Click will copy the files <span class="emphasis"><em>'/mycorp/edit_customer.js'</em></span>
      and <span class="emphasis"><em>'/mycorp/edit_customer.css'</em></span> to the web application
      folder.
      </p><p>Thus if the web application is called 'webapp', the files will be
      deployed as <span class="emphasis"><em>'webapp/mycorp/edit_customer.js'</em></span> and
      <span class="emphasis"><em>'webapp/mycorp/edit_customer.css'</em></span>.
      </p><p>Option #2 is the recommended approach for deploying your own
      resources since it makes the managing and maintenance of resources much
      easier.
      </p></div></div></div><div class="chapter" title="Chapter&nbsp;6.&nbsp;Best Practices"><div class="titlepage"><div><div><h2 class="title"><a name="chapter-best-practices"></a>Chapter&nbsp;6.&nbsp;Best Practices</h2></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="#security">6.1. Security</a></span></dt><dd><dl><dt><span class="sect2"><a href="#declarative-security">6.1.1. Declarative Security</a></span></dt><dt><span class="sect2"><a href="#alternatve-security-solutions">6.1.2. Alternative Security solutions</a></span></dt><dt><span class="sect2"><a href="#resources">6.1.3. Resources</a></span></dt></dl></dd><dt><span class="sect1"><a href="#packages-classes">6.2. Packages and Classes</a></span></dt><dd><dl><dt><span class="sect2"><a href="#page-classes">6.2.1. Page Classes</a></span></dt></dl></dd><dt><span class="sect1"><a href="#automapping">6.3. Page Auto Mapping</a></span></dt><dt><span class="sect1"><a href="#navigation">6.4. Navigation</a></span></dt><dt><span class="sect1"><a href="#templating">6.5. Templating</a></span></dt><dt><span class="sect1"><a href="#menus">6.6. Menus</a></span></dt><dt><span class="sect1"><a href="#logging">6.7. Logging</a></span></dt><dt><span class="sect1"><a href="#error-handling">6.8. Error Handling</a></span></dt><dt><span class="sect1"><a href="#performance">6.9. Performance</a></span></dt></dl></div><p>This chapter discusses Best Practices for designing and building Apache
  Click applications.
  </p><div class="sect1" title="6.1.&nbsp;Security"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="security"></a>6.1.&nbsp;Security</h2></div></div></div><p>For application security it is highly recommended that you use the
    declarative JEE Servlet path role based security model. While Click pages
    provide an <code class="methodname">onSecurityCheck()</code> method for rolling your own
    programmatic security model, the declarative JEE model provides numerous
    advantages.
    </p><p>These advantages include:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Its an industry standard pattern making development and maintenance
          easier.
        </p></li><li class="listitem"><p> Application servers generally provide numerous ways of integration
          with an organisations security infrastructure, including LDAP directories
          and relational databases.
        </p></li><li class="listitem"><p> Servlet security model support users bookmarking pages. When users
          go to access these pages later, the container will automatically authenticate
          them before allowing them to access the resource.
        </p></li><li class="listitem"><p> Using this security model you can keep your Page code free of
          security concerns. This makes you code more reusable, or at least easier
          to write.
        </p></li></ul></div><p>If your application has very fine grained or complex security requirements
    you may need to combine both the JEE declarative security model and a
    programmatic security model to meet your needs. In these cases its
    recommended you use declarative security for course grained access and
    programmatic security for finner grained access control.
    </p><div class="sect2" title="6.1.1.&nbsp;Declarative Security"><div class="titlepage"><div><div><h3 class="title"><a name="declarative-security"></a>6.1.1.&nbsp;Declarative Security</h3></div></div></div><p> The declarative JEE Servlet security model requires users to be
      authenticated and in the right roles before they can access secure resources.
      Relative to many of the JEE specifications the Servlet security model is
      surprisingly simple.
      </p><p>
      For example to secure admin pages, you add a security
      constraint in your <code class="filename">web.xml</code> file. This requires users
      to be in the <code class="varname">admin</code> role before they can access to any
      resources under the <span class="symbol">admin</span> directory:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;security-constraint&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-resource-collection&gt;</span>
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-resource-name&gt;</span>admin<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-resource-name&gt;</span>
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span><span class="symbol">/admin/*</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-resource-collection&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;auth-constraint&gt;</span>
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><code class="varname">admin</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/auth-constraint&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/security-constraint&gt;</span></pre><p>The application user roles are defined in the <code class="filename">web.xml</code>
      file as <code class="literal">security-role</code> elements:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;security-role&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><code class="varname">admin</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/security-role&gt;</span></pre><p>The Servlet security model supports three different authentication method:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            <code class="literal">BASIC</code>  - only recommended for internal
              applications where security is not important. This is the easiest
              authentication method, which simply displays a dialog box to users
              requiring them to authenticate before accessing secure resources.
              The BASIC method is relatively insecure as the username and password
              are posted to the server as a Base64 encoded string.
          </p></li><li class="listitem"><p>
            <code class="literal">DIGEST</code>  - recommended for internal applications
              with a moderate level of security. As with BASIC authentication,
              this method simply displays a dialog box to users requiring them to
              authenticate before accessing secure resources. Not all application
              servers support DIGEST authentication, with only more recent
              versions of Apache Tomcat supporting this method.
          </p></li><li class="listitem"><p>
            <code class="literal">FORM</code>  - recommended applications for where
              you need a customised login page. For applications requiring a high
              level of security it is recommended that you use the FORM method
              over HTTPS.
          </p></li></ul></div><p>The authentication method is specified in the &lt;login-method&gt; element.
      For example to use the BASIC authentication method you would specify:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;login-config&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;auth-method&gt;</span><code class="varname">BASIC</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/auth-method&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;realm-name&gt;</span>Admin Realm<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/realm-name&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/login-config&gt;</span></pre><p>To use the FORM method you also need to specify the path to the login
      page and the login error page:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;login-config&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;auth-method&gt;</span><code class="varname">FORM</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/auth-method&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;realm-name&gt;</span>Secure Realm<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/realm-name&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form-login-config&gt;</span>
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form-login-page&gt;</span><span class="symbol">/login.htm</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form-login-page&gt;</span>
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form-error-page&gt;</span><span class="symbol">/login.htm?auth-error=true</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form-error-page&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form-login-config&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/login-config&gt;</span></pre><p>In your Click <code class="filename">login.htm</code> page you need to include a
      special <code class="varname">j_security_check</code> form which includes the input
      fields <code class="varname">j_username</code> and <code class="varname">j_password</code>.
      For example:
      </p><pre class="programlisting"><span class="command"><strong>#if</strong></span> ($request.getParameter("<span class="symbol">auth-error</span>"))
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;div</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">style</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"margin-bottom:1em;margin-top:1em;color:red;"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
  Invalid User Name or Password, please try again.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;br/&gt;</span>
  Please ensure Caps Lock is off.
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/div&gt;</span>
<span class="command"><strong>#end</strong></span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">method</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"POST"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">action</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><code class="varname">j_security_check</code>" name="form"&gt;
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;table</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">border</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"0"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">style</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"margin-left:0.25em;"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;tr&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;td&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label&gt;</span>User Name<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;font</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">color</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"red"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>*<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/font&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/td&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;td&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><code class="varname">j_username</code>" maxlength="20" style="width:150px;"/&gt;<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/td&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;td&gt;</span>&amp;nbsp;<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/td&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/tr&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;tr&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;td&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;label&gt;</span>User Password<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/label&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;font</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">color</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"red"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>*<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/font&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/td&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;td&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"password"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">name</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"</span><code class="varname">j_password</code>" maxlength="20" style="width:150px;"/&gt;<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/td&gt;</span>
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;td&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;input</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"image"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">src</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"$context/images/login.png"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">title</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Click to Login"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/td&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/tr&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/table&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;script</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/javascript"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span>
  document.form.j_username.focus();
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/script&gt;</span></pre><p>When using FORM based authentication do <span class="bold"><strong>NOT</strong></span>
      put application logic in a Click Login Page class, as the role of this page
      is to simply render the login form. If you attempt to put navigation logic
      in your Login Page class, the JEE Container may simply ignore it or throw
      errors.
      </p><p>Putting this all together below is a <code class="filename">web.xml</code>
      snippet which features security constraints for pages under the admin
      path and the user path. This configuration uses the FORM method for
      authentication, and will also redirect unauthorized (403) requests to the
      <code class="filename">/not-authorized.htm</code> page.
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-app&gt;</span>

    ..

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;error-page&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;error-code&gt;</span>403<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/error-code&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;location&gt;</span><code class="varname">/not-authorized.htm</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/location&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/error-page&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;security-constraint&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-resource-collection&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-resource-name&gt;</span>admin<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-resource-name&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span><code class="varname">/admin/*</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-resource-collection&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;auth-constraint&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><span class="symbol">admin</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/auth-constraint&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/security-constraint&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;security-constraint&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-resource-collection&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;web-resource-name&gt;</span>user<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-resource-name&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;url-pattern&gt;</span><code class="varname">/user/*</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/url-pattern&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-resource-collection&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;auth-constraint&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><span class="symbol">admin</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><span class="symbol">user</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/auth-constraint&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/security-constraint&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;login-config&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;auth-method&gt;</span><code class="varname">FORM</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/auth-method&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;realm-name&gt;</span>Secure Zone<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/realm-name&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form-login-config&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form-login-page&gt;</span><code class="varname">/login.htm</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form-login-page&gt;</span>
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;form-error-page&gt;</span><code class="varname">/login.htm?auth-error=true</code><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form-error-page&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/form-login-config&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/login-config&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;security-role&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><span class="symbol">admin</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/security-role&gt;</span>

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;security-role&gt;</span>
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;role-name&gt;</span><span class="symbol">user</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/role-name&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/security-role&gt;</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/web-app&gt;</span></pre></div><div class="sect2" title="6.1.2.&nbsp;Alternative Security solutions"><div class="titlepage"><div><div><h3 class="title"><a name="alternatve-security-solutions"></a>6.1.2.&nbsp;Alternative Security solutions</h3></div></div></div><p> There are also alternative security solutions that provide extra
      features not available in JEE, such as RememberMe functionality, better
      resource mapping and <code class="literal">Post Logon Page</code> support.
      (<code class="literal">Post Logon Page</code> support allows one to specify a default
      URL where the user will be forwarded after successful login. This feature
      allows one to embed a login form in all non-secure pages and after successful
      authentication the user will be forwarded to their home page.)
      </p><p>Below are some of the alternative security solutions available:
      </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://static.springframework.org/spring-security/site/index.html" target="_blank">Spring Security</a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://securityfilter.sourceforge.net/" target="_blank">SecurityFilter</a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://incubator.apache.org/shiro/" target="_blank">Apache Shiro</a>
          </p></li></ul></div></div><div class="sect2" title="6.1.3.&nbsp;Resources"><div class="titlepage"><div><div><h3 class="title"><a name="resources"></a>6.1.3.&nbsp;Resources</h3></div></div></div><p>For more information on using security see the resources below:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.scribd.com/doc/34531398/Form-Based-Authentication" target="_blank">
                  Form Based Authentication
            </a>  by Louis E. Mauget
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/download.html" target="_blank">Servlet Specification</a>
              by Sun Microsystems
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://en.wikipedia.org/wiki/Basic_authentication_scheme" target="_blank">
                    Basic authentication scheme
            </a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://en.wikipedia.org/wiki/Digest_access_authentication" target="_blank">
                    Digest authentication scheme
            </a>
          </p></li><li class="listitem"><p>
            <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://en.wikipedia.org/wiki/Https" target="_blank">Https URI scheme</a>
          </p></li></ul></div></div></div><div class="sect1" title="6.2.&nbsp;Packages and Classes"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="packages-classes"></a>6.2.&nbsp;Packages and Classes</h2></div></div></div><p> An excellent way to design your project package structure is to
    classify packages initially by technology. So in a Click application all
    of our pages would be contained under a <span class="package">page</span> package.
    This also works very well with the Page automapping feature.
    </p><p>
    All the projects domain entity classes would be contained under a
    <span class="package">entity</span> package, and service classes would be contained
    under a <span class="package">service</span> directory. Note alternative names for the
    <span class="package">entity</span> package include domain or model. We also typically
    have a <span class="package">util</span> package for any stray classes which don't quite
    fit into the other packages.
    </p><p>In Java, package names are singular by convention, so we have a util
    package rather than a utils package.
    </p><p>An example project structure for a MyCorp web application is illustrated
    below:
    </p><div class="figure"><a name="example-project-structure"></a><div class="figure-contents"><span class="inlinemediaobject"><img src="images/best-practices/packages-classes.png" alt="Example project structure"></span></div><p xmlns:fo="http://www.w3.org/1999/XSL/Format" class="title"><i>Figure&nbsp;6.1.&nbsp;Example project structure</i></p></div><br class="figure-break"><p>In this example application we use declarative role and path based security.
    All the pages in the <span class="package">admin</span> package and directory require the
    <code class="literal">"admin"</code> role to be access, while all the pages in the
    <span class="package">user</span> package and directory require the <code class="literal">"user"</code>
    role to be accessed.
    </p><div class="sect2" title="6.2.1.&nbsp;Page Classes"><div class="titlepage"><div><div><h3 class="title"><a name="page-classes"></a>6.2.1.&nbsp;Page Classes</h3></div></div></div><p>A best practice when developing application Page classes is to
      place common methods in a base page class. This is typically used for
      providing access methods to application services and logger objects.
      </p><p>For example the BasePage below provides access to Spring configured
      service objects and a Log4J logger object:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> BasePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">implements</span> ApplicationContextAware {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/** The Spring application context. */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> ApplicationContext applicationContext;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/** The page Logger instance. */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Logger logger;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Return the Spring configured Customer service.
     *
     * @return the Spring configured Customer service
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> CustomerService getCustomerService() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> (CustomerService) getBean(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"customerService"</span>);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Return the Spring configured User service.
     *
     * @return the Spring configured User service
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> UserService getUserService() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> (UserService) getBean(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"userService"</span>);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Return the page Logger instance.
     *
     * @return the page Logger instance
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Logger getLogger() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (logger == null) {
            logger = Logger.getLogger(getClass());
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> logger;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see ApplicationContextAware#setApplicationContext(ApplicationContext)
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> setApplicationContext(ApplicationContext applicationContext)  {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>.applicationContext = applicationContext;
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * Return the configured Spring Bean for the given name.
     *
     * @param beanName the configured name of the Java Bean
     * @return the configured Spring Bean for the given name
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Object getBean(String beanName) {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> applicationContext.getBean(beanName);
    }

}</pre><p>Applications typically use a border template and have a
      <code class="classname">BorderPage</code> which extends <code class="classname">BasePage</code>
      and defines the template. For example:
      </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> BorderPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> BasePage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/** The root Menu item. */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Menu rootMenu = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Menu();

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">/**
     * @see Page#getTemplate()
     */</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> String getTemplate() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/border-template.htm"</span>;
    }
}</pre><p>Most application pages subclass <code class="classname">BorderPage</code>, except
      AJAX pages which have no need for a HTML border template and typically extend
      <code class="classname">BasePage</code>. The <code class="classname">BorderPage</code> class
      should not include common logic, other than that required for rendering the
      border template. Common page logic should be defined in the
      <code class="classname">BasePage</code> class.
      </p><p>To prevent these base Page classes being auto mapped, and becoming
      directly acessible web pages, ensure that there are no page templates which
      could match their class name. For example the <code class="classname">BorderPage</code>
      class above will not be auto mapped to <code class="filename">border-template.htm</code>.
      </p></div></div><div class="sect1" title="6.3.&nbsp;Page Auto Mapping"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="automapping"></a>6.3.&nbsp;Page Auto Mapping</h2></div></div></div><p>You should use the Click page automapping configuration feature.
    See the <a class="link" href="#application-automapping" title="5.2.3.1.&nbsp;Page Automapping">Page Automapping</a>
    topic for details.
    </p><p>Automapping will save you from having to manually configure URL path to
    Page class mappings in your <code class="filename">click.xml</code> file. If you follow
    this convention it is very easy to maintain and refactor applications.
    </p><p>You can also quickly determine what the corresponding Page class is for a
    page HTML template and visa versa, and if you use the ClickIDE Eclipse plugin
    you can switch between a page's class and template by pressing Ctrl+Alt+S.
    </p><p>An example <code class="filename">click.xml</code> automapping configuration is
    provided below (automapping is enabled by default):
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;click-app&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.dashboard.page"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/click-app&gt;</span></pre><p>To see how the page templates are mapped to Page classes set the application
    <a class="link" href="#application-mode" title="5.2.6.&nbsp;Mode">mode</a> to
    <code class="literal">debug</code> and at startup the mappings will be listed out. An
    example Click startup listing is provided below:
    </p><div class="literallayout"><p>[Click]&nbsp;[debug]&nbsp;automapped&nbsp;pages:<br>
[Click]&nbsp;[debug]&nbsp;/category-tree.htm&nbsp;-&gt;&nbsp;com.mycorp.dashboard.page.CategoryTree<br>
[Click]&nbsp;[debug]&nbsp;/process-list.htm&nbsp;-&gt;&nbsp;com.mycorp.dashboard.page.ProcessList<br>
[Click]&nbsp;[debug]&nbsp;/user-list.htm&nbsp;-&gt;&nbsp;com.mycorp.dashboard.page.UserList</p></div></div><div class="sect1" title="6.4.&nbsp;Navigation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="navigation"></a>6.4.&nbsp;Navigation</h2></div></div></div><p> When navigating between Pages using forwards and redirects, you should
    refer to the target page using the Page class rather than using path. This
    provides you compile time checking and will save you from having to update
    path strings in Java code if you move pages about.
    </p><p>To forward to another page using the Page class:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerListPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionLink customerLink = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>,<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onCustomerClick"</span>);

    ..

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onCustomerClick() {
        Integer id = customerLink.getValueInteger();
        Customer customer = getCustomerService().getCustomer(id);

        CustomerDetailPage customerDetailPage = (CustomerDetailPage)
            getContext().createPage(CustomerDetailPage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);

        customerDetailPage.setCustomer(customer);
        setForward(customerDetailPage);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
    }
}</pre><p>To redirect to another page using the Page class you can obtain the pages
    path from the <code class="classname">Context</code>. In the example below we are passing
    through the customer id as a request parameter to the target page.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerListPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> ActionLink customerLink = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> ActionLink(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">this</span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"onCustomerClick"</span>);

    ..

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onCustomerClick() {
        String id = customerLink.getValueInteger();

        String path = getContext().getPagePath(CustomerDetailPage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);
        setRedirect(path + <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"?id="</span> + id);

        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
    }
}</pre><p>A quick way of redirecting to another page is to simply refer to the target
    class. The example below logs a user out, by invalidating their session, and
    then redirects them to the application home page.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">boolean</span> onLogoutClick() {
    getContext().getSession().invalidate();

    setRedirect(HomePage.<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> false;
}</pre></div><div class="sect1" title="6.5.&nbsp;Templating"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="templating"></a>6.5.&nbsp;Templating</h2></div></div></div><p>Use Page templating it is highly recommended. Page templates provide
    numerous advantages including:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>greatly reduce the amount of HTML you need to maintain</p></li><li class="listitem"><p>ensure you have a common look and feel across your application</p></li><li class="listitem"><p>make global application changes very easy</p></li></ul></div><p>To see how to use templates see the
    <a class="link" href="#page-templating" title="2.6.&nbsp;Page Templating">Page Templating</a> topic. Also see the
    Click <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../examples.html" target="_blank">Examples</a> use of page templating.
    </p></div><div class="sect1" title="6.6.&nbsp;Menus"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="menus"></a>6.6.&nbsp;Menus</h2></div></div></div><p> For many applications using the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/Menu.html" target="_blank">Menu</a>
    control to centralize application navigation is very useful. Menus are
    defined in a <code class="filename">WEB-INF/menu.xml</code> file which is very easy to
    change.
    </p><p>A menu is typically defined in the a page border template so they are
    available through out the application. The Menu control does not support HTML
    rendering, so you need to define a Velocity macro to programmatically render
    the menu. You would call the macro in your border template with code like this:
    </p><div class="literallayout"><p><span class="symbol">#</span><code class="varname">writeMenu</code>(<span class="symbol">$</span>rootMenu)</p></div><p>An advantage of using a macro to render your menu is that you can reuse
    the code across different applications, and to modify an applications menu you
    simply need to edit the <code class="filename">WEB-INF/menu.xml</code> file. A good
    place to define your macros is in the webroot <code class="filename">/macro.vm</code>
    file as it is automatically included by Click.
    </p><p>Using macros you can create dynamic menu behaviour such as only rendering
    menu items a user is authorized to access with
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/control/Menu.html#isUserInRoles()" target="_blank">isUserInRoles()</a>.
    </p><div class="literallayout"><p><span class="command"><strong>#if</strong></span>&nbsp;(<span class="symbol">$</span>menu.isUserInRoles())<br>
&nbsp;&nbsp;&nbsp;..<br>
<span class="command"><strong>#end</strong></span></p></div><p>You can also use JavaScript to add dynamic behaviour such as drop down menus,
      for example see the Menu page in Click
      <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../examples.html" target="_blank">Examples</a>.
    </p></div><div class="sect1" title="6.7.&nbsp;Logging"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="logging"></a>6.7.&nbsp;Logging</h2></div></div></div><p> 
    For application logging you should use one of the well established 
    logging libraries such as Java Util Logging (JUL) or Log4J.
    </p><p>
    The library you use will largely depend upon the application server you are targeting.
    For Apache Tomcat or RedHat JBoss the  
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://logging.apache.org/log4j/" target="_blank">Log4j</a> library is a good 
    choice. While for the IBM WebSphere or Oracle WebLogic application servers Java Util
    Logging is better choice as this library is better supported.
    </p><p>
    If you have to target multiple application servers you should consider using the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.slf4j.org/" target="_blank">SLF4J</a> library which uses compile time bindings
    to an underlying logging implementation. 
    </p><p>
    As a general principle you should
    probably avoid <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://jakarta.apache.org/commons/logging/" target="_blank">Commons Logging</a> 
    because of the class loading issues associated with it. If you are using
    Commons Logging please make sure you have the latest version.
    </p><p>
    It is a best place to define a logger method in a common base page, for example:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> BasePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">protected</span> Logger logger;

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> Logger getLogger() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (logger == null) {
            logger = Logger.getLogger(getClass());
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> logger;
    }
}</pre><p>Using this pattern all your application bases should extend
    <code class="classname">BasePage</code> so they can use the
    <code class="methodname">getLogger()</code> method.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerListPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> BasePage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onGet() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">try</span> {
            ..
        } <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">catch</span> (Exception e) {
            getLogger().error(e);
        }
    }
}</pre><p>If you have some very heavy debug statement you should possibly use an
    <code class="methodname">isDebugEnabled</code> switch so it is not invoked if debug is
    not required.
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> CustomerListPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> BasePage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onGet() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (getLogger().isDebugEnabled()) {
            String msg = ..

            getLogger().debug(msg);
        }

        ..
    }
}</pre><p>
    Please note the Click logging facility is not designed for application use,
    and is for Click internal use only. When Click is running in
    <code class="literal">production</code> mode it will not produce any logging output.
    By default Click logs to the console using
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/service/ConsoleLogService.html" target="_blank">ConsoleLogService</a>. 
    </p><p>
    If you need to configure Click to log to an alternative destination please configure a LogService such as
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/service/JdkLogService.html" target="_blank">JdkLogService</a>,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/service/Log4JLogService.html" target="_blank">Log4JLogService</a> or
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/service/Slf4jLogService.html" target="_blank">Slf4jLogService</a>.
    </p></div><div class="sect1" title="6.8.&nbsp;Error Handling"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="error-handling"></a>6.8.&nbsp;Error Handling</h2></div></div></div><p> In Click unhandled errors are directed to the
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/ErrorPage.html" target="_blank">ErrorPage</a>
    for display. If applications require additional error handling they can create
    and register a custom error page in <code class="filename">WEB-INF/click.xml</code>.
    For example:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;pages</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">package</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">autobinding</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"annotation"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;page</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">path</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"click/error.htm"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">classname</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"com.mycorp.page.ErrorPage"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/pages&gt;</span></pre><p>Generally applications handle transactional errors using service layer code
    or via a servlet
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/Filter.html" target="_blank">Filter</a>
    and would not need to include error handling logic in an error page.
    </p><p>Potential uses for a custom error page include custom logging. For example
    if an application requires unhandled errors to be logged to an application
    log (rather than System.out) then a custom
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/util/ErrorPage.html" target="_blank">ErrorPage</a>
    could be configured. An example <code class="classname">ErrorPage</code> error logging
    page is provided below:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">package</span> com.mycorp.page.ErrorPage;
..

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> ErrorPage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> org.apache.click.util.ErrorPage {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onDestroy() {
        Logger.getLogger(getClass()).error(getError());
    }
}</pre></div><div class="sect1" title="6.9.&nbsp;Performance"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance"></a>6.9.&nbsp;Performance</h2></div></div></div><p>Yahoo published a list of
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://developer.yahoo.com/performance/rules.html" target="_blank">best practices</a>
    for improving web application performance.
    </p><p>Click Framework provides a
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../extras-api/org/apache/click/extras/filter/PerformanceFilter.html" target="_blank">PerformanceFilter</a>
    which caters for some of these rules. However not all rules can be easily automated.
    </p><p>This section outlines how to apply some important rules which are not
    covered by the PerformanceFilter namely,
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://developer.yahoo.com/performance/rules.html#num_http" target="_blank">Minimize HTTP Requests (by combining files)</a>
    and <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://developer.yahoo.com/performance/rules.html#minify" target="_blank">Minify JavaScript and CSS</a>.
    </p><p>The Rule, <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://developer.yahoo.com/performance/rules.html#num_http" target="_blank">Minimize HTTP Requests</a>,
    also mentions <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://alistapart.com/articles/sprites" target="_blank">CSS Sprites</a>,
    a method for combining multiple images into a single master image. CSS Sprites
    can boost performance when your application has many images, however it is
    harder to create and maintain. Note that CSS Sprites is not covered here.
    </p><p>It is worth pointing out that its not necessary to optimize
    every page in your application. Instead concentrate on popular pages, for
    example a web site's <span class="emphasis"><em>Home Page</em></span> would be a good
    candidate.
    </p><p>There are a couple of tools that are useful in applying the rules
    "Minimize HTTP Requests" and "Minify JavaScript and CSS":
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://developer.yahoo.com/yui/compressor/" target="_blank">YUICompressor</a>
            - minifies and compresses JavaScript and CSS files so less bytes have to
            be transferred across the wire.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://code.google.com/p/javaflight-code/" target="_blank">Ant Task for YUICompressor</a>
            - an Ant task that uses YUICompressor to compress JavaScript and CSS files.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.crockford.com/javascript/jsmin.html" target="_blank">JSMin</a>
            - similar to YUICompressor but only minifies (remove whitespace and newlines)
            JavaScript files and does no compression at all. An advantage of JSMin
            over YUICompressor is that its faster and can be used at runtime to minify
            JavaScript, while YUICompressor is most often used at build time.
        </p></li></ul></div><p>Below are some articles outlining how to use YUICompressor and Ant to
    concatenate and compress JavaScript and CSS files:
    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://www.julienlecomte.net/blog/2007/09/16/" target="_blank">Article</a>
            explaining how to use Ant and YUICompressor for compression.
        </p></li><li class="listitem"><p>
          <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://javaflight.blogspot.com/2008/01/introducing-yui-compressor-ant-task.html" target="_blank">Article</a>
            outlining how to use a special YUICompressor Ant Task for compression.
        </p></li></ul></div><p>Using one of the approaches above you can concatenate and compress all
    JavaScript and CSS for your Pages into two separate files, for example
    <code class="filename">home-page.css</code>
    and <code class="filename">home-page.js</code>. Note that the two files must include
    all the JavaScript and CSS that is generated by the Page and its Controls.
    Then you can instruct Click to <span class="emphasis"><em>only</em></span> include the two
    compressed files, home-page.css and home-page.js.
    </p><p>The Click Page class exposes the property
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#setIncludeControlHeadElements(boolean)" target="_blank">includeControlHeadElements</a>
    that indicates whether Controls have their CSS and JavaScript resources
    included or not.
    </p><p>To optimize Page loading one can override
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#getHeadElements()" target="_blank">Page.getHeadElements()</a>,
    and import the JavaScript and CSS files and then set the property
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="../../click-api/org/apache/click/Page.html#setIncludeControlHeadElements(boolean)" target="_blank">includeControlHeadElements</a>
    to <code class="literal">false</code>, indicating that Controls won't contribute
    their own JavaScript and CSS resources.
    </p><p>Here is an example:</p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">class</span> HomePage <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">extends</span> Page {

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">private</span> Form form = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> Form(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"form"</span>);

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">void</span> onInit() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="com">// Indicate that Controls should not import their head elements</span>
        setIncludeControlHeadElements(false);

        form.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> EmailField(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"email"</span>);
        addControl(form);
    }

    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">public</span> List getHeadElements() {
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">if</span> (headElements == null) {
            headElements = <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">super</span>.getHeadElements();

            headElements.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> CssImport(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/assets/css/home-page.css"</span>));
            headElements.add(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">new</span> JsImport(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="str">"/assets/js/home-page.js"</span>));
        }
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="kwd">return</span> headElements;
    }
}</pre><p>Using the following <code class="filename">border-template.htm</code>:
    </p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;title&gt;</span>Click Examples<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/title&gt;</span>
    ${headElements}
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

  ...

  ${jsElements}
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>the rendered HTML will include one CSS and one JavaScript import:</p><pre class="programlisting"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;html&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;head&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;title&gt;</span>Click Examples<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/title&gt;</span>
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;link</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">rel</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"stylesheet"</span>
          <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">href</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"/click-examples/assets/css/home-page.css"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">title</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"Style"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">/&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/head&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;body&gt;</span>

  ...

  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;script</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">type</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"text/javascript"</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="atn">src</span>=<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="pln">"/click-examples/assets/js/home-page.js"</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&gt;</span><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/script&gt;</span>
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/body&gt;</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="tag">&lt;/html&gt;</span></pre><p>A live demo is available
    <a xmlns:fo="http://www.w3.org/1999/XSL/Format" class="external" href="http://click.avoka.com/click-examples/general/page-imports-example.htm" target="_blank">here</a>
    </p></div></div></div></body></html>